(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function e_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tg={exports:{}},Tu={},Ng={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kl=Symbol.for("react.element"),t_=Symbol.for("react.portal"),r_=Symbol.for("react.fragment"),n_=Symbol.for("react.strict_mode"),a_=Symbol.for("react.profiler"),s_=Symbol.for("react.provider"),i_=Symbol.for("react.context"),o_=Symbol.for("react.forward_ref"),l_=Symbol.for("react.suspense"),c_=Symbol.for("react.memo"),u_=Symbol.for("react.lazy"),Np=Symbol.iterator;function f_(e){return e===null||typeof e!="object"?null:(e=Np&&e[Np]||e["@@iterator"],typeof e=="function"?e:null)}var Cg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ag=Object.assign,jg={};function Pi(e,t,r){this.props=e,this.context=t,this.refs=jg,this.updater=r||Cg}Pi.prototype.isReactComponent={};Pi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Pi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Fg(){}Fg.prototype=Pi.prototype;function bd(e,t,r){this.props=e,this.context=t,this.refs=jg,this.updater=r||Cg}var Td=bd.prototype=new Fg;Td.constructor=bd;Ag(Td,Pi.prototype);Td.isPureReactComponent=!0;var Cp=Array.isArray,Rg=Object.prototype.hasOwnProperty,Nd={current:null},Og={key:!0,ref:!0,__self:!0,__source:!0};function Pg(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Rg.call(t,n)&&!Og.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:kl,type:e,key:s,ref:i,props:a,_owner:Nd.current}}function d_(e,t){return{$$typeof:kl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Cd(e){return typeof e=="object"&&e!==null&&e.$$typeof===kl}function h_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Ap=/\/+/g;function o0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?h_(""+e.key):t.toString(36)}function Sc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case kl:case t_:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+o0(i,0):n,Cp(a)?(r="",e!=null&&(r=e.replace(Ap,"$&/")+"/"),Sc(a,t,r,"",function(u){return u})):a!=null&&(Cd(a)&&(a=d_(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(Ap,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Cp(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+o0(s,o);i+=Sc(s,t,r,l,a)}else if(l=f_(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+o0(s,o++),i+=Sc(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function zl(e,t,r){if(e==null)return e;var n=[],a=0;return Sc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function p_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var pr={current:null},Ec={transition:null},m_={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:Ec,ReactCurrentOwner:Nd};function Ig(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:zl,forEach:function(e,t,r){zl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zl(e,function(){t++}),t},toArray:function(e){return zl(e,function(t){return t})||[]},only:function(e){if(!Cd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Be.Component=Pi;Be.Fragment=r_;Be.Profiler=a_;Be.PureComponent=bd;Be.StrictMode=n_;Be.Suspense=l_;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m_;Be.act=Ig;Be.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ag({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Nd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Rg.call(t,l)&&!Og.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:kl,type:e.type,key:a,ref:s,props:n,_owner:i}};Be.createContext=function(e){return e={$$typeof:i_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:s_,_context:e},e.Consumer=e};Be.createElement=Pg;Be.createFactory=function(e){var t=Pg.bind(null,e);return t.type=e,t};Be.createRef=function(){return{current:null}};Be.forwardRef=function(e){return{$$typeof:o_,render:e}};Be.isValidElement=Cd;Be.lazy=function(e){return{$$typeof:u_,_payload:{_status:-1,_result:e},_init:p_}};Be.memo=function(e,t){return{$$typeof:c_,type:e,compare:t===void 0?null:t}};Be.startTransition=function(e){var t=Ec.transition;Ec.transition={};try{e()}finally{Ec.transition=t}};Be.unstable_act=Ig;Be.useCallback=function(e,t){return pr.current.useCallback(e,t)};Be.useContext=function(e){return pr.current.useContext(e)};Be.useDebugValue=function(){};Be.useDeferredValue=function(e){return pr.current.useDeferredValue(e)};Be.useEffect=function(e,t){return pr.current.useEffect(e,t)};Be.useId=function(){return pr.current.useId()};Be.useImperativeHandle=function(e,t,r){return pr.current.useImperativeHandle(e,t,r)};Be.useInsertionEffect=function(e,t){return pr.current.useInsertionEffect(e,t)};Be.useLayoutEffect=function(e,t){return pr.current.useLayoutEffect(e,t)};Be.useMemo=function(e,t){return pr.current.useMemo(e,t)};Be.useReducer=function(e,t,r){return pr.current.useReducer(e,t,r)};Be.useRef=function(e){return pr.current.useRef(e)};Be.useState=function(e){return pr.current.useState(e)};Be.useSyncExternalStore=function(e,t,r){return pr.current.useSyncExternalStore(e,t,r)};Be.useTransition=function(){return pr.current.useTransition()};Be.version="18.3.1";Ng.exports=Be;var N=Ng.exports;const x_=e_(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g_=N,v_=Symbol.for("react.element"),y_=Symbol.for("react.fragment"),w_=Object.prototype.hasOwnProperty,__=g_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k_={key:!0,ref:!0,__self:!0,__source:!0};function Dg(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)w_.call(t,n)&&!k_.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:v_,type:e,key:s,ref:i,props:a,_owner:__.current}}Tu.Fragment=y_;Tu.jsx=Dg;Tu.jsxs=Dg;Tg.exports=Tu;var c=Tg.exports,sf={},Lg={exports:{}},Ur={},Mg={exports:{}},Bg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,B){var ae=G.length;G.push(B);e:for(;0<ae;){var de=ae-1>>>1,R=G[de];if(0<a(R,B))G[de]=B,G[ae]=R,ae=de;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var B=G[0],ae=G.pop();if(ae!==B){G[0]=ae;e:for(var de=0,R=G.length,z=R>>>1;de<z;){var O=2*(de+1)-1,P=G[O],K=O+1,re=G[K];if(0>a(P,ae))K<R&&0>a(re,P)?(G[de]=re,G[K]=ae,de=K):(G[de]=P,G[O]=ae,de=O);else if(K<R&&0>a(re,ae))G[de]=re,G[K]=ae,de=K;else break e}}return B}function a(G,B){var ae=G.sortIndex-B.sortIndex;return ae!==0?ae:G.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],f=1,d=null,h=3,x=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(G){for(var B=r(u);B!==null;){if(B.callback===null)n(u);else if(B.startTime<=G)n(u),B.sortIndex=B.expirationTime,t(l,B);else break;B=r(u)}}function _(G){if(m=!1,v(G),!g)if(r(l)!==null)g=!0,Z(k);else{var B=r(u);B!==null&&ee(_,B.startTime-G)}}function k(G,B){g=!1,m&&(m=!1,y(C),C=-1),x=!0;var ae=h;try{for(v(B),d=r(l);d!==null&&(!(d.expirationTime>B)||G&&!H());){var de=d.callback;if(typeof de=="function"){d.callback=null,h=d.priorityLevel;var R=de(d.expirationTime<=B);B=e.unstable_now(),typeof R=="function"?d.callback=R:d===r(l)&&n(l),v(B)}else n(l);d=r(l)}if(d!==null)var z=!0;else{var O=r(u);O!==null&&ee(_,O.startTime-B),z=!1}return z}finally{d=null,h=ae,x=!1}}var E=!1,S=null,C=-1,A=5,U=-1;function H(){return!(e.unstable_now()-U<A)}function b(){if(S!==null){var G=e.unstable_now();U=G;var B=!0;try{B=S(!0,G)}finally{B?V():(E=!1,S=null)}}else E=!1}var V;if(typeof w=="function")V=function(){w(b)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,W=J.port2;J.port1.onmessage=b,V=function(){W.postMessage(null)}}else V=function(){p(b,0)};function Z(G){S=G,E||(E=!0,V())}function ee(G,B){C=p(function(){G(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){g||x||(g=!0,Z(k))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(G){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var ae=h;h=B;try{return G()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,B){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=h;h=G;try{return B()}finally{h=ae}},e.unstable_scheduleCallback=function(G,B,ae){var de=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?de+ae:de):ae=de,G){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ae+R,G={id:f++,callback:B,priorityLevel:G,startTime:ae,expirationTime:R,sortIndex:-1},ae>de?(G.sortIndex=ae,t(u,G),r(l)===null&&G===r(u)&&(m?(y(C),C=-1):m=!0,ee(_,ae-de))):(G.sortIndex=R,t(l,G),g||x||(g=!0,Z(k))),G},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(G){var B=h;return function(){var ae=h;h=B;try{return G.apply(this,arguments)}finally{h=ae}}}})(Bg);Mg.exports=Bg;var S_=Mg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E_=N,Lr=S_;function fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ug=new Set,Lo={};function Ns(e,t){ki(e,t),ki(e+"Capture",t)}function ki(e,t){for(Lo[e]=t,e=0;e<t.length;e++)Ug.add(t[e])}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),of=Object.prototype.hasOwnProperty,b_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jp={},Fp={};function T_(e){return of.call(Fp,e)?!0:of.call(jp,e)?!1:b_.test(e)?Fp[e]=!0:(jp[e]=!0,!1)}function N_(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function C_(e,t,r,n){if(t===null||typeof t>"u"||N_(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xt[e]=new mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xt[t]=new mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xt[e]=new mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xt[e]=new mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xt[e]=new mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xt[e]=new mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xt[e]=new mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xt[e]=new mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xt[e]=new mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ad=/[\-:]([a-z])/g;function jd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ad,jd);Xt[t]=new mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ad,jd);Xt[t]=new mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ad,jd);Xt[t]=new mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xt[e]=new mr(e,1,!1,e.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xt[e]=new mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Fd(e,t,r,n){var a=Xt.hasOwnProperty(t)?Xt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(C_(t,r,a,n)&&(r=null),n||a===null?T_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var sa=E_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wl=Symbol.for("react.element"),Js=Symbol.for("react.portal"),Qs=Symbol.for("react.fragment"),Rd=Symbol.for("react.strict_mode"),lf=Symbol.for("react.profiler"),$g=Symbol.for("react.provider"),zg=Symbol.for("react.context"),Od=Symbol.for("react.forward_ref"),cf=Symbol.for("react.suspense"),uf=Symbol.for("react.suspense_list"),Pd=Symbol.for("react.memo"),ma=Symbol.for("react.lazy"),Wg=Symbol.for("react.offscreen"),Rp=Symbol.iterator;function Yi(e){return e===null||typeof e!="object"?null:(e=Rp&&e[Rp]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Object.assign,l0;function co(e){if(l0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);l0=t&&t[1]||""}return`
`+l0+e}var c0=!1;function u0(e,t){if(!e||c0)return"";c0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{c0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?co(e):""}function A_(e){switch(e.tag){case 5:return co(e.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return e=u0(e.type,!1),e;case 11:return e=u0(e.type.render,!1),e;case 1:return e=u0(e.type,!0),e;default:return""}}function ff(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qs:return"Fragment";case Js:return"Portal";case lf:return"Profiler";case Rd:return"StrictMode";case cf:return"Suspense";case uf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zg:return(e.displayName||"Context")+".Consumer";case $g:return(e._context.displayName||"Context")+".Provider";case Od:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Pd:return t=e.displayName||null,t!==null?t:ff(e.type)||"Memo";case ma:t=e._payload,e=e._init;try{return ff(e(t))}catch{}}return null}function j_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ff(t);case 8:return t===Rd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function F_(e){var t=Hg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hl(e){e._valueTracker||(e._valueTracker=F_(e))}function Vg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Hg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Lc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function df(e,t){var r=t.checked;return ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Op(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Gg(e,t){t=t.checked,t!=null&&Fd(e,"checked",t,!1)}function hf(e,t){Gg(e,t);var r=Pa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?pf(e,t.type,r):t.hasOwnProperty("defaultValue")&&pf(e,t.type,Pa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Pp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function pf(e,t,r){(t!=="number"||Lc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uo=Array.isArray;function fi(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pa(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function mf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(fe(91));return ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ip(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(fe(92));if(uo(r)){if(1<r.length)throw Error(fe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pa(r)}}function Kg(e,t){var r=Pa(t.value),n=Pa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Dp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vl,qg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vl=Vl||document.createElement("div"),Vl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},R_=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(e){R_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vo[t]=vo[e]})});function Yg(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vo.hasOwnProperty(e)&&vo[e]?(""+t).trim():t+"px"}function Jg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Yg(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var O_=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gf(e,t){if(t){if(O_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(fe(62))}}function vf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yf=null;function Id(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wf=null,di=null,hi=null;function Lp(e){if(e=bl(e)){if(typeof wf!="function")throw Error(fe(280));var t=e.stateNode;t&&(t=Fu(t),wf(e.stateNode,e.type,t))}}function Qg(e){di?hi?hi.push(e):hi=[e]:di=e}function Zg(){if(di){var e=di,t=hi;if(hi=di=null,Lp(e),t)for(e=0;e<t.length;e++)Lp(t[e])}}function e1(e,t){return e(t)}function t1(){}var f0=!1;function r1(e,t,r){if(f0)return e(t,r);f0=!0;try{return e1(e,t,r)}finally{f0=!1,(di!==null||hi!==null)&&(t1(),Zg())}}function Bo(e,t){var r=e.stateNode;if(r===null)return null;var n=Fu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(fe(231,t,typeof r));return r}var _f=!1;if(Qn)try{var Ji={};Object.defineProperty(Ji,"passive",{get:function(){_f=!0}}),window.addEventListener("test",Ji,Ji),window.removeEventListener("test",Ji,Ji)}catch{_f=!1}function P_(e,t,r,n,a,s,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var yo=!1,Mc=null,Bc=!1,kf=null,I_={onError:function(e){yo=!0,Mc=e}};function D_(e,t,r,n,a,s,i,o,l){yo=!1,Mc=null,P_.apply(I_,arguments)}function L_(e,t,r,n,a,s,i,o,l){if(D_.apply(this,arguments),yo){if(yo){var u=Mc;yo=!1,Mc=null}else throw Error(fe(198));Bc||(Bc=!0,kf=u)}}function Cs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function n1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Mp(e){if(Cs(e)!==e)throw Error(fe(188))}function M_(e){var t=e.alternate;if(!t){if(t=Cs(e),t===null)throw Error(fe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Mp(a),e;if(s===n)return Mp(a),t;s=s.sibling}throw Error(fe(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(fe(189))}}if(r.alternate!==n)throw Error(fe(190))}if(r.tag!==3)throw Error(fe(188));return r.stateNode.current===r?e:t}function a1(e){return e=M_(e),e!==null?s1(e):null}function s1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=s1(e);if(t!==null)return t;e=e.sibling}return null}var i1=Lr.unstable_scheduleCallback,Bp=Lr.unstable_cancelCallback,B_=Lr.unstable_shouldYield,U_=Lr.unstable_requestPaint,_t=Lr.unstable_now,$_=Lr.unstable_getCurrentPriorityLevel,Dd=Lr.unstable_ImmediatePriority,o1=Lr.unstable_UserBlockingPriority,Uc=Lr.unstable_NormalPriority,z_=Lr.unstable_LowPriority,l1=Lr.unstable_IdlePriority,Nu=null,jn=null;function W_(e){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(Nu,e,void 0,(e.current.flags&128)===128)}catch{}}var xn=Math.clz32?Math.clz32:G_,H_=Math.log,V_=Math.LN2;function G_(e){return e>>>=0,e===0?32:31-(H_(e)/V_|0)|0}var Gl=64,Kl=4194304;function fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $c(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=fo(o):(s&=i,s!==0&&(n=fo(s)))}else i=r&~a,i!==0?n=fo(i):s!==0&&(n=fo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-xn(t),a=1<<r,n|=e[r],t&=~a;return n}function K_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-xn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=K_(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Sf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function c1(){var e=Gl;return Gl<<=1,!(Gl&4194240)&&(Gl=64),e}function d0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Sl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-xn(t),e[t]=r}function q_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-xn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Ld(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-xn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Xe=0;function u1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var f1,Md,d1,h1,p1,Ef=!1,Xl=[],Ta=null,Na=null,Ca=null,Uo=new Map,$o=new Map,va=[],Y_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Up(e,t){switch(e){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":Uo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$o.delete(t.pointerId)}}function Qi(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=bl(t),t!==null&&Md(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function J_(e,t,r,n,a){switch(t){case"focusin":return Ta=Qi(Ta,e,t,r,n,a),!0;case"dragenter":return Na=Qi(Na,e,t,r,n,a),!0;case"mouseover":return Ca=Qi(Ca,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Uo.set(s,Qi(Uo.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,$o.set(s,Qi($o.get(s)||null,e,t,r,n,a)),!0}return!1}function m1(e){var t=ss(e.target);if(t!==null){var r=Cs(t);if(r!==null){if(t=r.tag,t===13){if(t=n1(r),t!==null){e.blockedOn=t,p1(e.priority,function(){d1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=bf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);yf=n,r.target.dispatchEvent(n),yf=null}else return t=bl(r),t!==null&&Md(t),e.blockedOn=r,!1;t.shift()}return!0}function $p(e,t,r){bc(e)&&r.delete(t)}function Q_(){Ef=!1,Ta!==null&&bc(Ta)&&(Ta=null),Na!==null&&bc(Na)&&(Na=null),Ca!==null&&bc(Ca)&&(Ca=null),Uo.forEach($p),$o.forEach($p)}function Zi(e,t){e.blockedOn===t&&(e.blockedOn=null,Ef||(Ef=!0,Lr.unstable_scheduleCallback(Lr.unstable_NormalPriority,Q_)))}function zo(e){function t(a){return Zi(a,e)}if(0<Xl.length){Zi(Xl[0],e);for(var r=1;r<Xl.length;r++){var n=Xl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ta!==null&&Zi(Ta,e),Na!==null&&Zi(Na,e),Ca!==null&&Zi(Ca,e),Uo.forEach(t),$o.forEach(t),r=0;r<va.length;r++)n=va[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<va.length&&(r=va[0],r.blockedOn===null);)m1(r),r.blockedOn===null&&va.shift()}var pi=sa.ReactCurrentBatchConfig,zc=!0;function Z_(e,t,r,n){var a=Xe,s=pi.transition;pi.transition=null;try{Xe=1,Bd(e,t,r,n)}finally{Xe=a,pi.transition=s}}function ek(e,t,r,n){var a=Xe,s=pi.transition;pi.transition=null;try{Xe=4,Bd(e,t,r,n)}finally{Xe=a,pi.transition=s}}function Bd(e,t,r,n){if(zc){var a=bf(e,t,r,n);if(a===null)k0(e,t,n,Wc,r),Up(e,n);else if(J_(a,e,t,r,n))n.stopPropagation();else if(Up(e,n),t&4&&-1<Y_.indexOf(e)){for(;a!==null;){var s=bl(a);if(s!==null&&f1(s),s=bf(e,t,r,n),s===null&&k0(e,t,n,Wc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else k0(e,t,n,null,r)}}var Wc=null;function bf(e,t,r,n){if(Wc=null,e=Id(n),e=ss(e),e!==null)if(t=Cs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=n1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wc=e,null}function x1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($_()){case Dd:return 1;case o1:return 4;case Uc:case z_:return 16;case l1:return 536870912;default:return 16}default:return 16}}var _a=null,Ud=null,Tc=null;function g1(){if(Tc)return Tc;var e,t=Ud,r=t.length,n,a="value"in _a?_a.value:_a.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Tc=a.slice(e,1<n?1-n:void 0)}function Nc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ql(){return!0}function zp(){return!1}function $r(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ql:zp,this.isPropagationStopped=zp,this}return ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),t}var Ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$d=$r(Ii),El=ht({},Ii,{view:0,detail:0}),tk=$r(El),h0,p0,eo,Cu=ht({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==eo&&(eo&&e.type==="mousemove"?(h0=e.screenX-eo.screenX,p0=e.screenY-eo.screenY):p0=h0=0,eo=e),h0)},movementY:function(e){return"movementY"in e?e.movementY:p0}}),Wp=$r(Cu),rk=ht({},Cu,{dataTransfer:0}),nk=$r(rk),ak=ht({},El,{relatedTarget:0}),m0=$r(ak),sk=ht({},Ii,{animationName:0,elapsedTime:0,pseudoElement:0}),ik=$r(sk),ok=ht({},Ii,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lk=$r(ok),ck=ht({},Ii,{data:0}),Hp=$r(ck),uk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dk[e])?!!t[e]:!1}function zd(){return hk}var pk=ht({},El,{key:function(e){if(e.key){var t=uk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fk[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?Nc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),mk=$r(pk),xk=ht({},Cu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vp=$r(xk),gk=ht({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),vk=$r(gk),yk=ht({},Ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),wk=$r(yk),_k=ht({},Cu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kk=$r(_k),Sk=[9,13,27,32],Wd=Qn&&"CompositionEvent"in window,wo=null;Qn&&"documentMode"in document&&(wo=document.documentMode);var Ek=Qn&&"TextEvent"in window&&!wo,v1=Qn&&(!Wd||wo&&8<wo&&11>=wo),Gp=" ",Kp=!1;function y1(e,t){switch(e){case"keyup":return Sk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zs=!1;function bk(e,t){switch(e){case"compositionend":return w1(t);case"keypress":return t.which!==32?null:(Kp=!0,Gp);case"textInput":return e=t.data,e===Gp&&Kp?null:e;default:return null}}function Tk(e,t){if(Zs)return e==="compositionend"||!Wd&&y1(e,t)?(e=g1(),Tc=Ud=_a=null,Zs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return v1&&t.locale!=="ko"?null:t.data;default:return null}}var Nk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Nk[e.type]:t==="textarea"}function _1(e,t,r,n){Qg(n),t=Hc(t,"onChange"),0<t.length&&(r=new $d("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var _o=null,Wo=null;function Ck(e){R1(e,0)}function Au(e){var t=ri(e);if(Vg(t))return e}function Ak(e,t){if(e==="change")return t}var k1=!1;if(Qn){var x0;if(Qn){var g0="oninput"in document;if(!g0){var qp=document.createElement("div");qp.setAttribute("oninput","return;"),g0=typeof qp.oninput=="function"}x0=g0}else x0=!1;k1=x0&&(!document.documentMode||9<document.documentMode)}function Yp(){_o&&(_o.detachEvent("onpropertychange",S1),Wo=_o=null)}function S1(e){if(e.propertyName==="value"&&Au(Wo)){var t=[];_1(t,Wo,e,Id(e)),r1(Ck,t)}}function jk(e,t,r){e==="focusin"?(Yp(),_o=t,Wo=r,_o.attachEvent("onpropertychange",S1)):e==="focusout"&&Yp()}function Fk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Au(Wo)}function Rk(e,t){if(e==="click")return Au(t)}function Ok(e,t){if(e==="input"||e==="change")return Au(t)}function Pk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wn=typeof Object.is=="function"?Object.is:Pk;function Ho(e,t){if(wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!of.call(t,a)||!wn(e[a],t[a]))return!1}return!0}function Jp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qp(e,t){var r=Jp(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Jp(r)}}function E1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?E1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function b1(){for(var e=window,t=Lc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Lc(e.document)}return t}function Hd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ik(e){var t=b1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&E1(r.ownerDocument.documentElement,r)){if(n!==null&&Hd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Qp(r,s);var i=Qp(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dk=Qn&&"documentMode"in document&&11>=document.documentMode,ei=null,Tf=null,ko=null,Nf=!1;function Zp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nf||ei==null||ei!==Lc(n)||(n=ei,"selectionStart"in n&&Hd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ko&&Ho(ko,n)||(ko=n,n=Hc(Tf,"onSelect"),0<n.length&&(t=new $d("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ei)))}function Yl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ti={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},v0={},T1={};Qn&&(T1=document.createElement("div").style,"AnimationEvent"in window||(delete ti.animationend.animation,delete ti.animationiteration.animation,delete ti.animationstart.animation),"TransitionEvent"in window||delete ti.transitionend.transition);function ju(e){if(v0[e])return v0[e];if(!ti[e])return e;var t=ti[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in T1)return v0[e]=t[r];return e}var N1=ju("animationend"),C1=ju("animationiteration"),A1=ju("animationstart"),j1=ju("transitionend"),F1=new Map,em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $a(e,t){F1.set(e,t),Ns(t,[e])}for(var y0=0;y0<em.length;y0++){var w0=em[y0],Lk=w0.toLowerCase(),Mk=w0[0].toUpperCase()+w0.slice(1);$a(Lk,"on"+Mk)}$a(N1,"onAnimationEnd");$a(C1,"onAnimationIteration");$a(A1,"onAnimationStart");$a("dblclick","onDoubleClick");$a("focusin","onFocus");$a("focusout","onBlur");$a(j1,"onTransitionEnd");ki("onMouseEnter",["mouseout","mouseover"]);ki("onMouseLeave",["mouseout","mouseover"]);ki("onPointerEnter",["pointerout","pointerover"]);ki("onPointerLeave",["pointerout","pointerover"]);Ns("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ns("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ns("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ns("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ns("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ns("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bk=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function tm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,L_(n,t,void 0,e),e.currentTarget=null}function R1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;tm(a,o,u),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;tm(a,o,u),s=l}}}if(Bc)throw e=kf,Bc=!1,kf=null,e}function Qe(e,t){var r=t[Rf];r===void 0&&(r=t[Rf]=new Set);var n=e+"__bubble";r.has(n)||(O1(t,e,2,!1),r.add(n))}function _0(e,t,r){var n=0;t&&(n|=4),O1(r,e,n,t)}var Jl="_reactListening"+Math.random().toString(36).slice(2);function Vo(e){if(!e[Jl]){e[Jl]=!0,Ug.forEach(function(r){r!=="selectionchange"&&(Bk.has(r)||_0(r,!1,e),_0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jl]||(t[Jl]=!0,_0("selectionchange",!1,t))}}function O1(e,t,r,n){switch(x1(t)){case 1:var a=Z_;break;case 4:a=ek;break;default:a=Bd}r=a.bind(null,t,r,e),a=void 0,!_f||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function k0(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ss(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}r1(function(){var u=s,f=Id(r),d=[];e:{var h=F1.get(e);if(h!==void 0){var x=$d,g=e;switch(e){case"keypress":if(Nc(r)===0)break e;case"keydown":case"keyup":x=mk;break;case"focusin":g="focus",x=m0;break;case"focusout":g="blur",x=m0;break;case"beforeblur":case"afterblur":x=m0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Wp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=nk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=vk;break;case N1:case C1:case A1:x=ik;break;case j1:x=wk;break;case"scroll":x=tk;break;case"wheel":x=kk;break;case"copy":case"cut":case"paste":x=lk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Vp}var m=(t&4)!==0,p=!m&&e==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var w=u,v;w!==null;){v=w;var _=v.stateNode;if(v.tag===5&&_!==null&&(v=_,y!==null&&(_=Bo(w,y),_!=null&&m.push(Go(w,_,v)))),p)break;w=w.return}0<m.length&&(h=new x(h,g,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",h&&r!==yf&&(g=r.relatedTarget||r.fromElement)&&(ss(g)||g[Zn]))break e;if((x||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,x?(g=r.relatedTarget||r.toElement,x=u,g=g?ss(g):null,g!==null&&(p=Cs(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(x=null,g=u),x!==g)){if(m=Wp,_="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=Vp,_="onPointerLeave",y="onPointerEnter",w="pointer"),p=x==null?h:ri(x),v=g==null?h:ri(g),h=new m(_,w+"leave",x,r,f),h.target=p,h.relatedTarget=v,_=null,ss(f)===u&&(m=new m(y,w+"enter",g,r,f),m.target=v,m.relatedTarget=p,_=m),p=_,x&&g)t:{for(m=x,y=g,w=0,v=m;v;v=Ls(v))w++;for(v=0,_=y;_;_=Ls(_))v++;for(;0<w-v;)m=Ls(m),w--;for(;0<v-w;)y=Ls(y),v--;for(;w--;){if(m===y||y!==null&&m===y.alternate)break t;m=Ls(m),y=Ls(y)}m=null}else m=null;x!==null&&rm(d,h,x,m,!1),g!==null&&p!==null&&rm(d,p,g,m,!0)}}e:{if(h=u?ri(u):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var k=Ak;else if(Xp(h))if(k1)k=Ok;else{k=Fk;var E=jk}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=Rk);if(k&&(k=k(e,u))){_1(d,k,r,f);break e}E&&E(e,h,u),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&pf(h,"number",h.value)}switch(E=u?ri(u):window,e){case"focusin":(Xp(E)||E.contentEditable==="true")&&(ei=E,Tf=u,ko=null);break;case"focusout":ko=Tf=ei=null;break;case"mousedown":Nf=!0;break;case"contextmenu":case"mouseup":case"dragend":Nf=!1,Zp(d,r,f);break;case"selectionchange":if(Dk)break;case"keydown":case"keyup":Zp(d,r,f)}var S;if(Wd)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Zs?y1(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(v1&&r.locale!=="ko"&&(Zs||C!=="onCompositionStart"?C==="onCompositionEnd"&&Zs&&(S=g1()):(_a=f,Ud="value"in _a?_a.value:_a.textContent,Zs=!0)),E=Hc(u,C),0<E.length&&(C=new Hp(C,e,null,r,f),d.push({event:C,listeners:E}),S?C.data=S:(S=w1(r),S!==null&&(C.data=S)))),(S=Ek?bk(e,r):Tk(e,r))&&(u=Hc(u,"onBeforeInput"),0<u.length&&(f=new Hp("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=S))}R1(d,t)})}function Go(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Bo(e,r),s!=null&&n.unshift(Go(e,s,a)),s=Bo(e,t),s!=null&&n.push(Go(e,s,a))),e=e.return}return n}function Ls(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rm(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,a?(l=Bo(r,s),l!=null&&i.unshift(Go(r,l,o))):a||(l=Bo(r,s),l!=null&&i.push(Go(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Uk=/\r\n?/g,$k=/\u0000|\uFFFD/g;function nm(e){return(typeof e=="string"?e:""+e).replace(Uk,`
`).replace($k,"")}function Ql(e,t,r){if(t=nm(t),nm(e)!==t&&r)throw Error(fe(425))}function Vc(){}var Cf=null,Af=null;function jf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,zk=typeof clearTimeout=="function"?clearTimeout:void 0,am=typeof Promise=="function"?Promise:void 0,Wk=typeof queueMicrotask=="function"?queueMicrotask:typeof am<"u"?function(e){return am.resolve(null).then(e).catch(Hk)}:Ff;function Hk(e){setTimeout(function(){throw e})}function S0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),zo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);zo(t)}function Aa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Di=Math.random().toString(36).slice(2),Cn="__reactFiber$"+Di,Ko="__reactProps$"+Di,Zn="__reactContainer$"+Di,Rf="__reactEvents$"+Di,Vk="__reactListeners$"+Di,Gk="__reactHandles$"+Di;function ss(e){var t=e[Cn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Zn]||r[Cn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=sm(e);e!==null;){if(r=e[Cn])return r;e=sm(e)}return t}e=r,r=e.parentNode}return null}function bl(e){return e=e[Cn]||e[Zn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ri(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(fe(33))}function Fu(e){return e[Ko]||null}var Of=[],ni=-1;function za(e){return{current:e}}function et(e){0>ni||(e.current=Of[ni],Of[ni]=null,ni--)}function Je(e,t){ni++,Of[ni]=e.current,e.current=t}var Ia={},sr=za(Ia),wr=za(!1),xs=Ia;function Si(e,t){var r=e.type.contextTypes;if(!r)return Ia;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function _r(e){return e=e.childContextTypes,e!=null}function Gc(){et(wr),et(sr)}function im(e,t,r){if(sr.current!==Ia)throw Error(fe(168));Je(sr,t),Je(wr,r)}function P1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(fe(108,j_(e)||"Unknown",a));return ht({},r,n)}function Kc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ia,xs=sr.current,Je(sr,e),Je(wr,wr.current),!0}function om(e,t,r){var n=e.stateNode;if(!n)throw Error(fe(169));r?(e=P1(e,t,xs),n.__reactInternalMemoizedMergedChildContext=e,et(wr),et(sr),Je(sr,e)):et(wr),Je(wr,r)}var Hn=null,Ru=!1,E0=!1;function I1(e){Hn===null?Hn=[e]:Hn.push(e)}function Kk(e){Ru=!0,I1(e)}function Wa(){if(!E0&&Hn!==null){E0=!0;var e=0,t=Xe;try{var r=Hn;for(Xe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Hn=null,Ru=!1}catch(a){throw Hn!==null&&(Hn=Hn.slice(e+1)),i1(Dd,Wa),a}finally{Xe=t,E0=!1}}return null}var ai=[],si=0,Xc=null,qc=0,Yr=[],Jr=0,gs=null,Vn=1,Gn="";function Qa(e,t){ai[si++]=qc,ai[si++]=Xc,Xc=e,qc=t}function D1(e,t,r){Yr[Jr++]=Vn,Yr[Jr++]=Gn,Yr[Jr++]=gs,gs=e;var n=Vn;e=Gn;var a=32-xn(n)-1;n&=~(1<<a),r+=1;var s=32-xn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Vn=1<<32-xn(t)+a|r<<a|n,Gn=s+e}else Vn=1<<s|r<<a|n,Gn=e}function Vd(e){e.return!==null&&(Qa(e,1),D1(e,1,0))}function Gd(e){for(;e===Xc;)Xc=ai[--si],ai[si]=null,qc=ai[--si],ai[si]=null;for(;e===gs;)gs=Yr[--Jr],Yr[Jr]=null,Gn=Yr[--Jr],Yr[Jr]=null,Vn=Yr[--Jr],Yr[Jr]=null}var Dr=null,Ir=null,at=!1,hn=null;function L1(e,t){var r=Qr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function lm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dr=e,Ir=Aa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dr=e,Ir=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=gs!==null?{id:Vn,overflow:Gn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Dr=e,Ir=null,!0):!1;default:return!1}}function Pf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function If(e){if(at){var t=Ir;if(t){var r=t;if(!lm(e,t)){if(Pf(e))throw Error(fe(418));t=Aa(r.nextSibling);var n=Dr;t&&lm(e,t)?L1(n,r):(e.flags=e.flags&-4097|2,at=!1,Dr=e)}}else{if(Pf(e))throw Error(fe(418));e.flags=e.flags&-4097|2,at=!1,Dr=e}}}function cm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dr=e}function Zl(e){if(e!==Dr)return!1;if(!at)return cm(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jf(e.type,e.memoizedProps)),t&&(t=Ir)){if(Pf(e))throw M1(),Error(fe(418));for(;t;)L1(e,t),t=Aa(t.nextSibling)}if(cm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ir=Aa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ir=null}}else Ir=Dr?Aa(e.stateNode.nextSibling):null;return!0}function M1(){for(var e=Ir;e;)e=Aa(e.nextSibling)}function Ei(){Ir=Dr=null,at=!1}function Kd(e){hn===null?hn=[e]:hn.push(e)}var Xk=sa.ReactCurrentBatchConfig;function to(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(fe(309));var n=r.stateNode}if(!n)throw Error(fe(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(fe(284));if(!r._owner)throw Error(fe(290,e))}return e}function ec(e,t){throw e=Object.prototype.toString.call(t),Error(fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function um(e){var t=e._init;return t(e._payload)}function B1(e){function t(y,w){if(e){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function a(y,w){return y=Oa(y,w),y.index=0,y.sibling=null,y}function s(y,w,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,v,_){return w===null||w.tag!==6?(w=F0(v,y.mode,_),w.return=y,w):(w=a(w,v),w.return=y,w)}function l(y,w,v,_){var k=v.type;return k===Qs?f(y,w,v.props.children,_,v.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ma&&um(k)===w.type)?(_=a(w,v.props),_.ref=to(y,w,v),_.return=y,_):(_=Pc(v.type,v.key,v.props,null,y.mode,_),_.ref=to(y,w,v),_.return=y,_)}function u(y,w,v,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=R0(v,y.mode,_),w.return=y,w):(w=a(w,v.children||[]),w.return=y,w)}function f(y,w,v,_,k){return w===null||w.tag!==7?(w=fs(v,y.mode,_,k),w.return=y,w):(w=a(w,v),w.return=y,w)}function d(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=F0(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wl:return v=Pc(w.type,w.key,w.props,null,y.mode,v),v.ref=to(y,null,w),v.return=y,v;case Js:return w=R0(w,y.mode,v),w.return=y,w;case ma:var _=w._init;return d(y,_(w._payload),v)}if(uo(w)||Yi(w))return w=fs(w,y.mode,v,null),w.return=y,w;ec(y,w)}return null}function h(y,w,v,_){var k=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:o(y,w,""+v,_);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Wl:return v.key===k?l(y,w,v,_):null;case Js:return v.key===k?u(y,w,v,_):null;case ma:return k=v._init,h(y,w,k(v._payload),_)}if(uo(v)||Yi(v))return k!==null?null:f(y,w,v,_,null);ec(y,v)}return null}function x(y,w,v,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(v)||null,o(w,y,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Wl:return y=y.get(_.key===null?v:_.key)||null,l(w,y,_,k);case Js:return y=y.get(_.key===null?v:_.key)||null,u(w,y,_,k);case ma:var E=_._init;return x(y,w,v,E(_._payload),k)}if(uo(_)||Yi(_))return y=y.get(v)||null,f(w,y,_,k,null);ec(w,_)}return null}function g(y,w,v,_){for(var k=null,E=null,S=w,C=w=0,A=null;S!==null&&C<v.length;C++){S.index>C?(A=S,S=null):A=S.sibling;var U=h(y,S,v[C],_);if(U===null){S===null&&(S=A);break}e&&S&&U.alternate===null&&t(y,S),w=s(U,w,C),E===null?k=U:E.sibling=U,E=U,S=A}if(C===v.length)return r(y,S),at&&Qa(y,C),k;if(S===null){for(;C<v.length;C++)S=d(y,v[C],_),S!==null&&(w=s(S,w,C),E===null?k=S:E.sibling=S,E=S);return at&&Qa(y,C),k}for(S=n(y,S);C<v.length;C++)A=x(S,y,C,v[C],_),A!==null&&(e&&A.alternate!==null&&S.delete(A.key===null?C:A.key),w=s(A,w,C),E===null?k=A:E.sibling=A,E=A);return e&&S.forEach(function(H){return t(y,H)}),at&&Qa(y,C),k}function m(y,w,v,_){var k=Yi(v);if(typeof k!="function")throw Error(fe(150));if(v=k.call(v),v==null)throw Error(fe(151));for(var E=k=null,S=w,C=w=0,A=null,U=v.next();S!==null&&!U.done;C++,U=v.next()){S.index>C?(A=S,S=null):A=S.sibling;var H=h(y,S,U.value,_);if(H===null){S===null&&(S=A);break}e&&S&&H.alternate===null&&t(y,S),w=s(H,w,C),E===null?k=H:E.sibling=H,E=H,S=A}if(U.done)return r(y,S),at&&Qa(y,C),k;if(S===null){for(;!U.done;C++,U=v.next())U=d(y,U.value,_),U!==null&&(w=s(U,w,C),E===null?k=U:E.sibling=U,E=U);return at&&Qa(y,C),k}for(S=n(y,S);!U.done;C++,U=v.next())U=x(S,y,C,U.value,_),U!==null&&(e&&U.alternate!==null&&S.delete(U.key===null?C:U.key),w=s(U,w,C),E===null?k=U:E.sibling=U,E=U);return e&&S.forEach(function(b){return t(y,b)}),at&&Qa(y,C),k}function p(y,w,v,_){if(typeof v=="object"&&v!==null&&v.type===Qs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Wl:e:{for(var k=v.key,E=w;E!==null;){if(E.key===k){if(k=v.type,k===Qs){if(E.tag===7){r(y,E.sibling),w=a(E,v.props.children),w.return=y,y=w;break e}}else if(E.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ma&&um(k)===E.type){r(y,E.sibling),w=a(E,v.props),w.ref=to(y,E,v),w.return=y,y=w;break e}r(y,E);break}else t(y,E);E=E.sibling}v.type===Qs?(w=fs(v.props.children,y.mode,_,v.key),w.return=y,y=w):(_=Pc(v.type,v.key,v.props,null,y.mode,_),_.ref=to(y,w,v),_.return=y,y=_)}return i(y);case Js:e:{for(E=v.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(y,w.sibling),w=a(w,v.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=R0(v,y.mode,_),w.return=y,y=w}return i(y);case ma:return E=v._init,p(y,w,E(v._payload),_)}if(uo(v))return g(y,w,v,_);if(Yi(v))return m(y,w,v,_);ec(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(y,w.sibling),w=a(w,v),w.return=y,y=w):(r(y,w),w=F0(v,y.mode,_),w.return=y,y=w),i(y)):r(y,w)}return p}var bi=B1(!0),U1=B1(!1),Yc=za(null),Jc=null,ii=null,Xd=null;function qd(){Xd=ii=Jc=null}function Yd(e){var t=Yc.current;et(Yc),e._currentValue=t}function Df(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function mi(e,t){Jc=e,Xd=ii=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(yr=!0),e.firstContext=null)}function tn(e){var t=e._currentValue;if(Xd!==e)if(e={context:e,memoizedValue:t,next:null},ii===null){if(Jc===null)throw Error(fe(308));ii=e,Jc.dependencies={lanes:0,firstContext:e}}else ii=ii.next=e;return t}var is=null;function Jd(e){is===null?is=[e]:is.push(e)}function $1(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Jd(t)):(r.next=a.next,a.next=r),t.interleaved=r,ea(e,n)}function ea(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xa=!1;function Qd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Xn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ja(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ue&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ea(e,r)}return a=n.interleaved,a===null?(t.next=t,Jd(n)):(t.next=a.next,a.next=t),n.interleaved=t,ea(e,r)}function Cc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ld(e,r)}}function fm(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Qc(e,t,r,n){var a=e.updateQueue;xa=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?s=u:i.next=u,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=u=l=null,o=s;do{var h=o.lane,x=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,x=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(x,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(x,d,h):g,h==null)break e;d=ht({},d,h);break e;case 2:xa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else x={eventTime:x,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=x,l=d):f=f.next=x,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);ys|=i,e.lanes=i,e.memoizedState=d}}function dm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(fe(191,a));a.call(n)}}}var Tl={},Fn=za(Tl),Xo=za(Tl),qo=za(Tl);function os(e){if(e===Tl)throw Error(fe(174));return e}function Zd(e,t){switch(Je(qo,t),Je(Xo,e),Je(Fn,Tl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:xf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=xf(t,e)}et(Fn),Je(Fn,t)}function Ti(){et(Fn),et(Xo),et(qo)}function W1(e){os(qo.current);var t=os(Fn.current),r=xf(t,e.type);t!==r&&(Je(Xo,e),Je(Fn,r))}function eh(e){Xo.current===e&&(et(Fn),et(Xo))}var ct=za(0);function Zc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var b0=[];function th(){for(var e=0;e<b0.length;e++)b0[e]._workInProgressVersionPrimary=null;b0.length=0}var Ac=sa.ReactCurrentDispatcher,T0=sa.ReactCurrentBatchConfig,vs=0,dt=null,Ft=null,Dt=null,eu=!1,So=!1,Yo=0,qk=0;function Yt(){throw Error(fe(321))}function rh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!wn(e[r],t[r]))return!1;return!0}function nh(e,t,r,n,a,s){if(vs=s,dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ac.current=e===null||e.memoizedState===null?Zk:eS,e=r(n,a),So){s=0;do{if(So=!1,Yo=0,25<=s)throw Error(fe(301));s+=1,Dt=Ft=null,t.updateQueue=null,Ac.current=tS,e=r(n,a)}while(So)}if(Ac.current=tu,t=Ft!==null&&Ft.next!==null,vs=0,Dt=Ft=dt=null,eu=!1,t)throw Error(fe(300));return e}function ah(){var e=Yo!==0;return Yo=0,e}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?dt.memoizedState=Dt=e:Dt=Dt.next=e,Dt}function rn(){if(Ft===null){var e=dt.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var t=Dt===null?dt.memoizedState:Dt.next;if(t!==null)Dt=t,Ft=e;else{if(e===null)throw Error(fe(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Dt===null?dt.memoizedState=Dt=e:Dt=Dt.next=e}return Dt}function Jo(e,t){return typeof t=="function"?t(e):t}function N0(e){var t=rn(),r=t.queue;if(r===null)throw Error(fe(311));r.lastRenderedReducer=e;var n=Ft,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,u=s;do{var f=u.lane;if((vs&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,dt.lanes|=f,ys|=f}u=u.next}while(u!==null&&u!==s);l===null?i=n:l.next=o,wn(n,t.memoizedState)||(yr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,dt.lanes|=s,ys|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function C0(e){var t=rn(),r=t.queue;if(r===null)throw Error(fe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);wn(s,t.memoizedState)||(yr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function H1(){}function V1(e,t){var r=dt,n=rn(),a=t(),s=!wn(n.memoizedState,a);if(s&&(n.memoizedState=a,yr=!0),n=n.queue,sh(X1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Dt!==null&&Dt.memoizedState.tag&1){if(r.flags|=2048,Qo(9,K1.bind(null,r,n,a,t),void 0,null),Bt===null)throw Error(fe(349));vs&30||G1(r,t,a)}return a}function G1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function K1(e,t,r,n){t.value=r,t.getSnapshot=n,q1(t)&&Y1(e)}function X1(e,t,r){return r(function(){q1(t)&&Y1(e)})}function q1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!wn(e,r)}catch{return!0}}function Y1(e){var t=ea(e,1);t!==null&&gn(t,e,1,-1)}function hm(e){var t=Nn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qk.bind(null,dt,e),[t.memoizedState,e]}function Qo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function J1(){return rn().memoizedState}function jc(e,t,r,n){var a=Nn();dt.flags|=e,a.memoizedState=Qo(1|t,r,void 0,n===void 0?null:n)}function Ou(e,t,r,n){var a=rn();n=n===void 0?null:n;var s=void 0;if(Ft!==null){var i=Ft.memoizedState;if(s=i.destroy,n!==null&&rh(n,i.deps)){a.memoizedState=Qo(t,r,s,n);return}}dt.flags|=e,a.memoizedState=Qo(1|t,r,s,n)}function pm(e,t){return jc(8390656,8,e,t)}function sh(e,t){return Ou(2048,8,e,t)}function Q1(e,t){return Ou(4,2,e,t)}function Z1(e,t){return Ou(4,4,e,t)}function ev(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tv(e,t,r){return r=r!=null?r.concat([e]):null,Ou(4,4,ev.bind(null,t,e),r)}function ih(){}function rv(e,t){var r=rn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function nv(e,t){var r=rn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function av(e,t,r){return vs&21?(wn(r,t)||(r=c1(),dt.lanes|=r,ys|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,yr=!0),e.memoizedState=r)}function Yk(e,t){var r=Xe;Xe=r!==0&&4>r?r:4,e(!0);var n=T0.transition;T0.transition={};try{e(!1),t()}finally{Xe=r,T0.transition=n}}function sv(){return rn().memoizedState}function Jk(e,t,r){var n=Ra(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},iv(e))ov(t,r);else if(r=$1(e,t,r,n),r!==null){var a=dr();gn(r,e,n,a),lv(r,t,n)}}function Qk(e,t,r){var n=Ra(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(iv(e))ov(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,wn(o,i)){var l=t.interleaved;l===null?(a.next=a,Jd(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=$1(e,t,a,n),r!==null&&(a=dr(),gn(r,e,n,a),lv(r,t,n))}}function iv(e){var t=e.alternate;return e===dt||t!==null&&t===dt}function ov(e,t){So=eu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function lv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ld(e,r)}}var tu={readContext:tn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},Zk={readContext:tn,useCallback:function(e,t){return Nn().memoizedState=[e,t===void 0?null:t],e},useContext:tn,useEffect:pm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,jc(4194308,4,ev.bind(null,t,e),r)},useLayoutEffect:function(e,t){return jc(4194308,4,e,t)},useInsertionEffect:function(e,t){return jc(4,2,e,t)},useMemo:function(e,t){var r=Nn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Nn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Jk.bind(null,dt,e),[n.memoizedState,e]},useRef:function(e){var t=Nn();return e={current:e},t.memoizedState=e},useState:hm,useDebugValue:ih,useDeferredValue:function(e){return Nn().memoizedState=e},useTransition:function(){var e=hm(!1),t=e[0];return e=Yk.bind(null,e[1]),Nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=dt,a=Nn();if(at){if(r===void 0)throw Error(fe(407));r=r()}else{if(r=t(),Bt===null)throw Error(fe(349));vs&30||G1(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,pm(X1.bind(null,n,s,e),[e]),n.flags|=2048,Qo(9,K1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Nn(),t=Bt.identifierPrefix;if(at){var r=Gn,n=Vn;r=(n&~(1<<32-xn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Yo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=qk++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eS={readContext:tn,useCallback:rv,useContext:tn,useEffect:sh,useImperativeHandle:tv,useInsertionEffect:Q1,useLayoutEffect:Z1,useMemo:nv,useReducer:N0,useRef:J1,useState:function(){return N0(Jo)},useDebugValue:ih,useDeferredValue:function(e){var t=rn();return av(t,Ft.memoizedState,e)},useTransition:function(){var e=N0(Jo)[0],t=rn().memoizedState;return[e,t]},useMutableSource:H1,useSyncExternalStore:V1,useId:sv,unstable_isNewReconciler:!1},tS={readContext:tn,useCallback:rv,useContext:tn,useEffect:sh,useImperativeHandle:tv,useInsertionEffect:Q1,useLayoutEffect:Z1,useMemo:nv,useReducer:C0,useRef:J1,useState:function(){return C0(Jo)},useDebugValue:ih,useDeferredValue:function(e){var t=rn();return Ft===null?t.memoizedState=e:av(t,Ft.memoizedState,e)},useTransition:function(){var e=C0(Jo)[0],t=rn().memoizedState;return[e,t]},useMutableSource:H1,useSyncExternalStore:V1,useId:sv,unstable_isNewReconciler:!1};function cn(e,t){if(e&&e.defaultProps){t=ht({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Lf(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ht({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Pu={isMounted:function(e){return(e=e._reactInternals)?Cs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=dr(),a=Ra(e),s=Xn(n,a);s.payload=t,r!=null&&(s.callback=r),t=ja(e,s,a),t!==null&&(gn(t,e,a,n),Cc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=dr(),a=Ra(e),s=Xn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ja(e,s,a),t!==null&&(gn(t,e,a,n),Cc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=dr(),n=Ra(e),a=Xn(r,n);a.tag=2,t!=null&&(a.callback=t),t=ja(e,a,n),t!==null&&(gn(t,e,n,r),Cc(t,e,n))}};function mm(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Ho(r,n)||!Ho(a,s):!0}function cv(e,t,r){var n=!1,a=Ia,s=t.contextType;return typeof s=="object"&&s!==null?s=tn(s):(a=_r(t)?xs:sr.current,n=t.contextTypes,s=(n=n!=null)?Si(e,a):Ia),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Pu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function xm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Pu.enqueueReplaceState(t,t.state,null)}function Mf(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Qd(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=tn(s):(s=_r(t)?xs:sr.current,a.context=Si(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Lf(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Pu.enqueueReplaceState(a,a.state,null),Qc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ni(e,t){try{var r="",n=t;do r+=A_(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function A0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Bf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var rS=typeof WeakMap=="function"?WeakMap:Map;function uv(e,t,r){r=Xn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){nu||(nu=!0,qf=n),Bf(e,t)},r}function fv(e,t,r){r=Xn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Bf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Bf(e,t),typeof n!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function gm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new rS;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=xS.bind(null,e,t,r),t.then(e,e))}function vm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ym(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Xn(-1,1),t.tag=2,ja(r,t,1))),r.lanes|=1),e)}var nS=sa.ReactCurrentOwner,yr=!1;function cr(e,t,r,n){t.child=e===null?U1(t,null,r,n):bi(t,e.child,r,n)}function wm(e,t,r,n,a){r=r.render;var s=t.ref;return mi(t,a),n=nh(e,t,r,n,s,a),r=ah(),e!==null&&!yr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ta(e,t,a)):(at&&r&&Vd(t),t.flags|=1,cr(e,t,n,a),t.child)}function _m(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!ph(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,dv(e,t,s,n,a)):(e=Pc(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ho,r(i,n)&&e.ref===t.ref)return ta(e,t,a)}return t.flags|=1,e=Oa(s,n),e.ref=t.ref,e.return=t,t.child=e}function dv(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Ho(s,n)&&e.ref===t.ref)if(yr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(yr=!0);else return t.lanes=e.lanes,ta(e,t,a)}return Uf(e,t,r,n,a)}function hv(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(li,Cr),Cr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(li,Cr),Cr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Je(li,Cr),Cr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Je(li,Cr),Cr|=n;return cr(e,t,a,r),t.child}function pv(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Uf(e,t,r,n,a){var s=_r(r)?xs:sr.current;return s=Si(t,s),mi(t,a),r=nh(e,t,r,n,s,a),n=ah(),e!==null&&!yr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ta(e,t,a)):(at&&n&&Vd(t),t.flags|=1,cr(e,t,r,a),t.child)}function km(e,t,r,n,a){if(_r(r)){var s=!0;Kc(t)}else s=!1;if(mi(t,a),t.stateNode===null)Fc(e,t),cv(t,r,n),Mf(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=tn(u):(u=_r(r)?xs:sr.current,u=Si(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&xm(t,i,n,u),xa=!1;var h=t.memoizedState;i.state=h,Qc(t,n,i,a),l=t.memoizedState,o!==n||h!==l||wr.current||xa?(typeof f=="function"&&(Lf(t,r,f,n),l=t.memoizedState),(o=xa||mm(t,r,o,n,h,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,z1(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:cn(t.type,o),i.props=u,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=tn(l):(l=_r(r)?xs:sr.current,l=Si(t,l));var x=r.getDerivedStateFromProps;(f=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&xm(t,i,n,l),xa=!1,h=t.memoizedState,i.state=h,Qc(t,n,i,a);var g=t.memoizedState;o!==d||h!==g||wr.current||xa?(typeof x=="function"&&(Lf(t,r,x,n),g=t.memoizedState),(u=xa||mm(t,r,u,n,h,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return $f(e,t,r,n,s,a)}function $f(e,t,r,n,a,s){pv(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&om(t,r,!1),ta(e,t,s);n=t.stateNode,nS.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=bi(t,e.child,null,s),t.child=bi(t,null,o,s)):cr(e,t,o,s),t.memoizedState=n.state,a&&om(t,r,!0),t.child}function mv(e){var t=e.stateNode;t.pendingContext?im(e,t.pendingContext,t.pendingContext!==t.context):t.context&&im(e,t.context,!1),Zd(e,t.containerInfo)}function Sm(e,t,r,n,a){return Ei(),Kd(a),t.flags|=256,cr(e,t,r,n),t.child}var zf={dehydrated:null,treeContext:null,retryLane:0};function Wf(e){return{baseLanes:e,cachePool:null,transitions:null}}function xv(e,t,r){var n=t.pendingProps,a=ct.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Je(ct,a&1),e===null)return If(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Lu(i,n,0,null),e=fs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Wf(r),t.memoizedState=zf,e):oh(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return aS(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Oa(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Oa(o,s):(s=fs(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Wf(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=zf,n}return s=e.child,e=s.sibling,n=Oa(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function oh(e,t){return t=Lu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function tc(e,t,r,n){return n!==null&&Kd(n),bi(t,e.child,null,r),e=oh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function aS(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=A0(Error(fe(422))),tc(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Lu({mode:"visible",children:n.children},a,0,null),s=fs(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&bi(t,e.child,null,i),t.child.memoizedState=Wf(i),t.memoizedState=zf,s);if(!(t.mode&1))return tc(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(fe(419)),n=A0(s,n,void 0),tc(e,t,i,n)}if(o=(i&e.childLanes)!==0,yr||o){if(n=Bt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ea(e,a),gn(n,e,a,-1))}return hh(),n=A0(Error(fe(421))),tc(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=gS.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Ir=Aa(a.nextSibling),Dr=t,at=!0,hn=null,e!==null&&(Yr[Jr++]=Vn,Yr[Jr++]=Gn,Yr[Jr++]=gs,Vn=e.id,Gn=e.overflow,gs=t),t=oh(t,n.children),t.flags|=4096,t)}function Em(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Df(e.return,t,r)}function j0(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function gv(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(cr(e,t,n.children,r),n=ct.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Em(e,r,t);else if(e.tag===19)Em(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Je(ct,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Zc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),j0(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Zc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}j0(t,!0,r,null,s);break;case"together":j0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ta(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ys|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(fe(153));if(t.child!==null){for(e=t.child,r=Oa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Oa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function sS(e,t,r){switch(t.tag){case 3:mv(t),Ei();break;case 5:W1(t);break;case 1:_r(t.type)&&Kc(t);break;case 4:Zd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Je(Yc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Je(ct,ct.current&1),t.flags|=128,null):r&t.child.childLanes?xv(e,t,r):(Je(ct,ct.current&1),e=ta(e,t,r),e!==null?e.sibling:null);Je(ct,ct.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return gv(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Je(ct,ct.current),n)break;return null;case 22:case 23:return t.lanes=0,hv(e,t,r)}return ta(e,t,r)}var vv,Hf,yv,wv;vv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Hf=function(){};yv=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,os(Fn.current);var s=null;switch(r){case"input":a=df(e,a),n=df(e,n),s=[];break;case"select":a=ht({},a,{value:void 0}),n=ht({},n,{value:void 0}),s=[];break;case"textarea":a=mf(e,a),n=mf(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Vc)}gf(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Lo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Lo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Qe("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};wv=function(e,t,r,n){r!==n&&(t.flags|=4)};function ro(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function iS(e,t,r){var n=t.pendingProps;switch(Gd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return _r(t.type)&&Gc(),Jt(t),null;case 3:return n=t.stateNode,Ti(),et(wr),et(sr),th(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,hn!==null&&(Qf(hn),hn=null))),Hf(e,t),Jt(t),null;case 5:eh(t);var a=os(qo.current);if(r=t.type,e!==null&&t.stateNode!=null)yv(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(fe(166));return Jt(t),null}if(e=os(Fn.current),Zl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Cn]=t,n[Ko]=s,e=(t.mode&1)!==0,r){case"dialog":Qe("cancel",n),Qe("close",n);break;case"iframe":case"object":case"embed":Qe("load",n);break;case"video":case"audio":for(a=0;a<ho.length;a++)Qe(ho[a],n);break;case"source":Qe("error",n);break;case"img":case"image":case"link":Qe("error",n),Qe("load",n);break;case"details":Qe("toggle",n);break;case"input":Op(n,s),Qe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Qe("invalid",n);break;case"textarea":Ip(n,s),Qe("invalid",n)}gf(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),a=["children",""+o]):Lo.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Qe("scroll",n)}switch(r){case"input":Hl(n),Pp(n,s,!0);break;case"textarea":Hl(n),Dp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Vc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Cn]=t,e[Ko]=n,vv(e,t,!1,!1),t.stateNode=e;e:{switch(i=vf(r,n),r){case"dialog":Qe("cancel",e),Qe("close",e),a=n;break;case"iframe":case"object":case"embed":Qe("load",e),a=n;break;case"video":case"audio":for(a=0;a<ho.length;a++)Qe(ho[a],e);a=n;break;case"source":Qe("error",e),a=n;break;case"img":case"image":case"link":Qe("error",e),Qe("load",e),a=n;break;case"details":Qe("toggle",e),a=n;break;case"input":Op(e,n),a=df(e,n),Qe("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=ht({},n,{value:void 0}),Qe("invalid",e);break;case"textarea":Ip(e,n),a=mf(e,n),Qe("invalid",e);break;default:a=n}gf(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Jg(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qg(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Mo(e,l):typeof l=="number"&&Mo(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Qe("scroll",e):l!=null&&Fd(e,s,l,i))}switch(r){case"input":Hl(e),Pp(e,n,!1);break;case"textarea":Hl(e),Dp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pa(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?fi(e,!!n.multiple,s,!1):n.defaultValue!=null&&fi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Vc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)wv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(fe(166));if(r=os(qo.current),os(Fn.current),Zl(t)){if(n=t.stateNode,r=t.memoizedProps,n[Cn]=t,(s=n.nodeValue!==r)&&(e=Dr,e!==null))switch(e.tag){case 3:Ql(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ql(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Cn]=t,t.stateNode=n}return Jt(t),null;case 13:if(et(ct),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&Ir!==null&&t.mode&1&&!(t.flags&128))M1(),Ei(),t.flags|=98560,s=!1;else if(s=Zl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(fe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(fe(317));s[Cn]=t}else Ei(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jt(t),s=!1}else hn!==null&&(Qf(hn),hn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ct.current&1?Ot===0&&(Ot=3):hh())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return Ti(),Hf(e,t),e===null&&Vo(t.stateNode.containerInfo),Jt(t),null;case 10:return Yd(t.type._context),Jt(t),null;case 17:return _r(t.type)&&Gc(),Jt(t),null;case 19:if(et(ct),s=t.memoizedState,s===null)return Jt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)ro(s,!1);else{if(Ot!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Zc(e),i!==null){for(t.flags|=128,ro(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Je(ct,ct.current&1|2),t.child}e=e.sibling}s.tail!==null&&_t()>Ci&&(t.flags|=128,n=!0,ro(s,!1),t.lanes=4194304)}else{if(!n)if(e=Zc(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ro(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!at)return Jt(t),null}else 2*_t()-s.renderingStartTime>Ci&&r!==1073741824&&(t.flags|=128,n=!0,ro(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=_t(),t.sibling=null,r=ct.current,Je(ct,n?r&1|2:r&1),t):(Jt(t),null);case 22:case 23:return dh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Cr&1073741824&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error(fe(156,t.tag))}function oS(e,t){switch(Gd(t),t.tag){case 1:return _r(t.type)&&Gc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ti(),et(wr),et(sr),th(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return eh(t),null;case 13:if(et(ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(fe(340));Ei()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return et(ct),null;case 4:return Ti(),null;case 10:return Yd(t.type._context),null;case 22:case 23:return dh(),null;case 24:return null;default:return null}}var rc=!1,tr=!1,lS=typeof WeakSet=="function"?WeakSet:Set,_e=null;function oi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mt(e,t,n)}else r.current=null}function Vf(e,t,r){try{r()}catch(n){mt(e,t,n)}}var bm=!1;function cS(e,t){if(Cf=zc,e=b1(),Hd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var x;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(x=d.firstChild)!==null;)h=d,d=x;for(;;){if(d===e)break t;if(h===r&&++u===a&&(o=i),h===s&&++f===n&&(l=i),(x=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=x}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Af={focusedElem:e,selectionRange:r},zc=!1,_e=t;_e!==null;)if(t=_e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_e=e;else for(;_e!==null;){t=_e;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:cn(t.type,m),p);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(_){mt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,_e=e;break}_e=t.return}return g=bm,bm=!1,g}function Eo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Vf(t,r,s)}a=a.next}while(a!==n)}}function Iu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Gf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function _v(e){var t=e.alternate;t!==null&&(e.alternate=null,_v(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cn],delete t[Ko],delete t[Rf],delete t[Vk],delete t[Gk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kv(e){return e.tag===5||e.tag===3||e.tag===4}function Tm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Kf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Vc));else if(n!==4&&(e=e.child,e!==null))for(Kf(e,t,r),e=e.sibling;e!==null;)Kf(e,t,r),e=e.sibling}function Xf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Xf(e,t,r),e=e.sibling;e!==null;)Xf(e,t,r),e=e.sibling}var Ht=null,fn=!1;function ha(e,t,r){for(r=r.child;r!==null;)Sv(e,t,r),r=r.sibling}function Sv(e,t,r){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(Nu,r)}catch{}switch(r.tag){case 5:tr||oi(r,t);case 6:var n=Ht,a=fn;Ht=null,ha(e,t,r),Ht=n,fn=a,Ht!==null&&(fn?(e=Ht,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ht.removeChild(r.stateNode));break;case 18:Ht!==null&&(fn?(e=Ht,r=r.stateNode,e.nodeType===8?S0(e.parentNode,r):e.nodeType===1&&S0(e,r),zo(e)):S0(Ht,r.stateNode));break;case 4:n=Ht,a=fn,Ht=r.stateNode.containerInfo,fn=!0,ha(e,t,r),Ht=n,fn=a;break;case 0:case 11:case 14:case 15:if(!tr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Vf(r,t,i),a=a.next}while(a!==n)}ha(e,t,r);break;case 1:if(!tr&&(oi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){mt(r,t,o)}ha(e,t,r);break;case 21:ha(e,t,r);break;case 22:r.mode&1?(tr=(n=tr)||r.memoizedState!==null,ha(e,t,r),tr=n):ha(e,t,r);break;default:ha(e,t,r)}}function Nm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new lS),t.forEach(function(n){var a=vS.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function sn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Ht=o.stateNode,fn=!1;break e;case 3:Ht=o.stateNode.containerInfo,fn=!0;break e;case 4:Ht=o.stateNode.containerInfo,fn=!0;break e}o=o.return}if(Ht===null)throw Error(fe(160));Sv(s,i,a),Ht=null,fn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){mt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ev(t,e),t=t.sibling}function Ev(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(sn(t,e),Sn(e),n&4){try{Eo(3,e,e.return),Iu(3,e)}catch(m){mt(e,e.return,m)}try{Eo(5,e,e.return)}catch(m){mt(e,e.return,m)}}break;case 1:sn(t,e),Sn(e),n&512&&r!==null&&oi(r,r.return);break;case 5:if(sn(t,e),Sn(e),n&512&&r!==null&&oi(r,r.return),e.flags&32){var a=e.stateNode;try{Mo(a,"")}catch(m){mt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Gg(a,s),vf(o,i);var u=vf(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?Jg(a,d):f==="dangerouslySetInnerHTML"?qg(a,d):f==="children"?Mo(a,d):Fd(a,f,d,u)}switch(o){case"input":hf(a,s);break;case"textarea":Kg(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?fi(a,!!s.multiple,x,!1):h!==!!s.multiple&&(s.defaultValue!=null?fi(a,!!s.multiple,s.defaultValue,!0):fi(a,!!s.multiple,s.multiple?[]:"",!1))}a[Ko]=s}catch(m){mt(e,e.return,m)}}break;case 6:if(sn(t,e),Sn(e),n&4){if(e.stateNode===null)throw Error(fe(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){mt(e,e.return,m)}}break;case 3:if(sn(t,e),Sn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zo(t.containerInfo)}catch(m){mt(e,e.return,m)}break;case 4:sn(t,e),Sn(e);break;case 13:sn(t,e),Sn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(uh=_t())),n&4&&Nm(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(tr=(u=tr)||f,sn(t,e),tr=u):sn(t,e),Sn(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(_e=e,f=e.child;f!==null;){for(d=_e=f;_e!==null;){switch(h=_e,x=h.child,h.tag){case 0:case 11:case 14:case 15:Eo(4,h,h.return);break;case 1:oi(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){mt(n,r,m)}}break;case 5:oi(h,h.return);break;case 22:if(h.memoizedState!==null){Am(d);continue}}x!==null?(x.return=h,_e=x):Am(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Yg("display",i))}catch(m){mt(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){mt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:sn(t,e),Sn(e),n&4&&Nm(e);break;case 21:break;default:sn(t,e),Sn(e)}}function Sn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(kv(r)){var n=r;break e}r=r.return}throw Error(fe(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Mo(a,""),n.flags&=-33);var s=Tm(e);Xf(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Tm(e);Kf(e,o,i);break;default:throw Error(fe(161))}}catch(l){mt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function uS(e,t,r){_e=e,bv(e)}function bv(e,t,r){for(var n=(e.mode&1)!==0;_e!==null;){var a=_e,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||rc;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||tr;o=rc;var u=tr;if(rc=i,(tr=l)&&!u)for(_e=a;_e!==null;)i=_e,l=i.child,i.tag===22&&i.memoizedState!==null?jm(a):l!==null?(l.return=i,_e=l):jm(a);for(;s!==null;)_e=s,bv(s),s=s.sibling;_e=a,rc=o,tr=u}Cm(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,_e=s):Cm(e)}}function Cm(e){for(;_e!==null;){var t=_e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:tr||Iu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!tr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:cn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&dm(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}dm(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&zo(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}tr||t.flags&512&&Gf(t)}catch(h){mt(t,t.return,h)}}if(t===e){_e=null;break}if(r=t.sibling,r!==null){r.return=t.return,_e=r;break}_e=t.return}}function Am(e){for(;_e!==null;){var t=_e;if(t===e){_e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,_e=r;break}_e=t.return}}function jm(e){for(;_e!==null;){var t=_e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Iu(4,t)}catch(l){mt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){mt(t,a,l)}}var s=t.return;try{Gf(t)}catch(l){mt(t,s,l)}break;case 5:var i=t.return;try{Gf(t)}catch(l){mt(t,i,l)}}}catch(l){mt(t,t.return,l)}if(t===e){_e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,_e=o;break}_e=t.return}}var fS=Math.ceil,ru=sa.ReactCurrentDispatcher,lh=sa.ReactCurrentOwner,Zr=sa.ReactCurrentBatchConfig,Ue=0,Bt=null,Ct=null,Kt=0,Cr=0,li=za(0),Ot=0,Zo=null,ys=0,Du=0,ch=0,bo=null,vr=null,uh=0,Ci=1/0,zn=null,nu=!1,qf=null,Fa=null,nc=!1,ka=null,au=0,To=0,Yf=null,Rc=-1,Oc=0;function dr(){return Ue&6?_t():Rc!==-1?Rc:Rc=_t()}function Ra(e){return e.mode&1?Ue&2&&Kt!==0?Kt&-Kt:Xk.transition!==null?(Oc===0&&(Oc=c1()),Oc):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:x1(e.type)),e):1}function gn(e,t,r,n){if(50<To)throw To=0,Yf=null,Error(fe(185));Sl(e,r,n),(!(Ue&2)||e!==Bt)&&(e===Bt&&(!(Ue&2)&&(Du|=r),Ot===4&&ya(e,Kt)),kr(e,n),r===1&&Ue===0&&!(t.mode&1)&&(Ci=_t()+500,Ru&&Wa()))}function kr(e,t){var r=e.callbackNode;X_(e,t);var n=$c(e,e===Bt?Kt:0);if(n===0)r!==null&&Bp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Bp(r),t===1)e.tag===0?Kk(Fm.bind(null,e)):I1(Fm.bind(null,e)),Wk(function(){!(Ue&6)&&Wa()}),r=null;else{switch(u1(n)){case 1:r=Dd;break;case 4:r=o1;break;case 16:r=Uc;break;case 536870912:r=l1;break;default:r=Uc}r=Ov(r,Tv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Tv(e,t){if(Rc=-1,Oc=0,Ue&6)throw Error(fe(327));var r=e.callbackNode;if(xi()&&e.callbackNode!==r)return null;var n=$c(e,e===Bt?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=su(e,n);else{t=n;var a=Ue;Ue|=2;var s=Cv();(Bt!==e||Kt!==t)&&(zn=null,Ci=_t()+500,us(e,t));do try{pS();break}catch(o){Nv(e,o)}while(!0);qd(),ru.current=s,Ue=a,Ct!==null?t=0:(Bt=null,Kt=0,t=Ot)}if(t!==0){if(t===2&&(a=Sf(e),a!==0&&(n=a,t=Jf(e,a))),t===1)throw r=Zo,us(e,0),ya(e,n),kr(e,_t()),r;if(t===6)ya(e,n);else{if(a=e.current.alternate,!(n&30)&&!dS(a)&&(t=su(e,n),t===2&&(s=Sf(e),s!==0&&(n=s,t=Jf(e,s))),t===1))throw r=Zo,us(e,0),ya(e,n),kr(e,_t()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(fe(345));case 2:Za(e,vr,zn);break;case 3:if(ya(e,n),(n&130023424)===n&&(t=uh+500-_t(),10<t)){if($c(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){dr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ff(Za.bind(null,e,vr,zn),t);break}Za(e,vr,zn);break;case 4:if(ya(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-xn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=_t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*fS(n/1960))-n,10<n){e.timeoutHandle=Ff(Za.bind(null,e,vr,zn),n);break}Za(e,vr,zn);break;case 5:Za(e,vr,zn);break;default:throw Error(fe(329))}}}return kr(e,_t()),e.callbackNode===r?Tv.bind(null,e):null}function Jf(e,t){var r=bo;return e.current.memoizedState.isDehydrated&&(us(e,t).flags|=256),e=su(e,t),e!==2&&(t=vr,vr=r,t!==null&&Qf(t)),e}function Qf(e){vr===null?vr=e:vr.push.apply(vr,e)}function dS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!wn(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ya(e,t){for(t&=~ch,t&=~Du,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-xn(t),n=1<<r;e[r]=-1,t&=~n}}function Fm(e){if(Ue&6)throw Error(fe(327));xi();var t=$c(e,0);if(!(t&1))return kr(e,_t()),null;var r=su(e,t);if(e.tag!==0&&r===2){var n=Sf(e);n!==0&&(t=n,r=Jf(e,n))}if(r===1)throw r=Zo,us(e,0),ya(e,t),kr(e,_t()),r;if(r===6)throw Error(fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Za(e,vr,zn),kr(e,_t()),null}function fh(e,t){var r=Ue;Ue|=1;try{return e(t)}finally{Ue=r,Ue===0&&(Ci=_t()+500,Ru&&Wa())}}function ws(e){ka!==null&&ka.tag===0&&!(Ue&6)&&xi();var t=Ue;Ue|=1;var r=Zr.transition,n=Xe;try{if(Zr.transition=null,Xe=1,e)return e()}finally{Xe=n,Zr.transition=r,Ue=t,!(Ue&6)&&Wa()}}function dh(){Cr=li.current,et(li)}function us(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,zk(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Gd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Gc();break;case 3:Ti(),et(wr),et(sr),th();break;case 5:eh(n);break;case 4:Ti();break;case 13:et(ct);break;case 19:et(ct);break;case 10:Yd(n.type._context);break;case 22:case 23:dh()}r=r.return}if(Bt=e,Ct=e=Oa(e.current,null),Kt=Cr=t,Ot=0,Zo=null,ch=Du=ys=0,vr=bo=null,is!==null){for(t=0;t<is.length;t++)if(r=is[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}is=null}return e}function Nv(e,t){do{var r=Ct;try{if(qd(),Ac.current=tu,eu){for(var n=dt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}eu=!1}if(vs=0,Dt=Ft=dt=null,So=!1,Yo=0,lh.current=null,r===null||r.return===null){Ot=1,Zo=t,Ct=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Kt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=vm(i);if(x!==null){x.flags&=-257,ym(x,i,o,s,t),x.mode&1&&gm(s,u,t),t=x,l=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){gm(s,u,t),hh();break e}l=Error(fe(426))}}else if(at&&o.mode&1){var p=vm(i);if(p!==null){!(p.flags&65536)&&(p.flags|=256),ym(p,i,o,s,t),Kd(Ni(l,o));break e}}s=l=Ni(l,o),Ot!==4&&(Ot=2),bo===null?bo=[s]:bo.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=uv(s,l,t);fm(s,y);break e;case 1:o=l;var w=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Fa===null||!Fa.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=fv(s,o,t);fm(s,_);break e}}s=s.return}while(s!==null)}jv(r)}catch(k){t=k,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function Cv(){var e=ru.current;return ru.current=tu,e===null?tu:e}function hh(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),Bt===null||!(ys&268435455)&&!(Du&268435455)||ya(Bt,Kt)}function su(e,t){var r=Ue;Ue|=2;var n=Cv();(Bt!==e||Kt!==t)&&(zn=null,us(e,t));do try{hS();break}catch(a){Nv(e,a)}while(!0);if(qd(),Ue=r,ru.current=n,Ct!==null)throw Error(fe(261));return Bt=null,Kt=0,Ot}function hS(){for(;Ct!==null;)Av(Ct)}function pS(){for(;Ct!==null&&!B_();)Av(Ct)}function Av(e){var t=Rv(e.alternate,e,Cr);e.memoizedProps=e.pendingProps,t===null?jv(e):Ct=t,lh.current=null}function jv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=oS(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ot=6,Ct=null;return}}else if(r=iS(r,t,Cr),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Ot===0&&(Ot=5)}function Za(e,t,r){var n=Xe,a=Zr.transition;try{Zr.transition=null,Xe=1,mS(e,t,r,n)}finally{Zr.transition=a,Xe=n}return null}function mS(e,t,r,n){do xi();while(ka!==null);if(Ue&6)throw Error(fe(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(fe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(q_(e,s),e===Bt&&(Ct=Bt=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nc||(nc=!0,Ov(Uc,function(){return xi(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Zr.transition,Zr.transition=null;var i=Xe;Xe=1;var o=Ue;Ue|=4,lh.current=null,cS(e,r),Ev(r,e),Ik(Af),zc=!!Cf,Af=Cf=null,e.current=r,uS(r),U_(),Ue=o,Xe=i,Zr.transition=s}else e.current=r;if(nc&&(nc=!1,ka=e,au=a),s=e.pendingLanes,s===0&&(Fa=null),W_(r.stateNode),kr(e,_t()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(nu)throw nu=!1,e=qf,qf=null,e;return au&1&&e.tag!==0&&xi(),s=e.pendingLanes,s&1?e===Yf?To++:(To=0,Yf=e):To=0,Wa(),null}function xi(){if(ka!==null){var e=u1(au),t=Zr.transition,r=Xe;try{if(Zr.transition=null,Xe=16>e?16:e,ka===null)var n=!1;else{if(e=ka,ka=null,au=0,Ue&6)throw Error(fe(331));var a=Ue;for(Ue|=4,_e=e.current;_e!==null;){var s=_e,i=s.child;if(_e.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(_e=u;_e!==null;){var f=_e;switch(f.tag){case 0:case 11:case 15:Eo(8,f,s)}var d=f.child;if(d!==null)d.return=f,_e=d;else for(;_e!==null;){f=_e;var h=f.sibling,x=f.return;if(_v(f),f===u){_e=null;break}if(h!==null){h.return=x,_e=h;break}_e=x}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}_e=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,_e=i;else e:for(;_e!==null;){if(s=_e,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Eo(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,_e=y;break e}_e=s.return}}var w=e.current;for(_e=w;_e!==null;){i=_e;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,_e=v;else e:for(i=w;_e!==null;){if(o=_e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Iu(9,o)}}catch(k){mt(o,o.return,k)}if(o===i){_e=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,_e=_;break e}_e=o.return}}if(Ue=a,Wa(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(Nu,e)}catch{}n=!0}return n}finally{Xe=r,Zr.transition=t}}return!1}function Rm(e,t,r){t=Ni(r,t),t=uv(e,t,1),e=ja(e,t,1),t=dr(),e!==null&&(Sl(e,1,t),kr(e,t))}function mt(e,t,r){if(e.tag===3)Rm(e,e,r);else for(;t!==null;){if(t.tag===3){Rm(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Fa===null||!Fa.has(n))){e=Ni(r,e),e=fv(t,e,1),t=ja(t,e,1),e=dr(),t!==null&&(Sl(t,1,e),kr(t,e));break}}t=t.return}}function xS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=dr(),e.pingedLanes|=e.suspendedLanes&r,Bt===e&&(Kt&r)===r&&(Ot===4||Ot===3&&(Kt&130023424)===Kt&&500>_t()-uh?us(e,0):ch|=r),kr(e,t)}function Fv(e,t){t===0&&(e.mode&1?(t=Kl,Kl<<=1,!(Kl&130023424)&&(Kl=4194304)):t=1);var r=dr();e=ea(e,t),e!==null&&(Sl(e,t,r),kr(e,r))}function gS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Fv(e,r)}function vS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(fe(314))}n!==null&&n.delete(t),Fv(e,r)}var Rv;Rv=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||wr.current)yr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return yr=!1,sS(e,t,r);yr=!!(e.flags&131072)}else yr=!1,at&&t.flags&1048576&&D1(t,qc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fc(e,t),e=t.pendingProps;var a=Si(t,sr.current);mi(t,r),a=nh(null,t,n,e,a,r);var s=ah();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_r(n)?(s=!0,Kc(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Qd(t),a.updater=Pu,t.stateNode=a,a._reactInternals=t,Mf(t,n,e,r),t=$f(null,t,n,!0,s,r)):(t.tag=0,at&&s&&Vd(t),cr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=wS(n),e=cn(n,e),a){case 0:t=Uf(null,t,n,e,r);break e;case 1:t=km(null,t,n,e,r);break e;case 11:t=wm(null,t,n,e,r);break e;case 14:t=_m(null,t,n,cn(n.type,e),r);break e}throw Error(fe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:cn(n,a),Uf(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:cn(n,a),km(e,t,n,a,r);case 3:e:{if(mv(t),e===null)throw Error(fe(387));n=t.pendingProps,s=t.memoizedState,a=s.element,z1(e,t),Qc(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Ni(Error(fe(423)),t),t=Sm(e,t,n,r,a);break e}else if(n!==a){a=Ni(Error(fe(424)),t),t=Sm(e,t,n,r,a);break e}else for(Ir=Aa(t.stateNode.containerInfo.firstChild),Dr=t,at=!0,hn=null,r=U1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ei(),n===a){t=ta(e,t,r);break e}cr(e,t,n,r)}t=t.child}return t;case 5:return W1(t),e===null&&If(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,jf(n,a)?i=null:s!==null&&jf(n,s)&&(t.flags|=32),pv(e,t),cr(e,t,i,r),t.child;case 6:return e===null&&If(t),null;case 13:return xv(e,t,r);case 4:return Zd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=bi(t,null,n,r):cr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:cn(n,a),wm(e,t,n,a,r);case 7:return cr(e,t,t.pendingProps,r),t.child;case 8:return cr(e,t,t.pendingProps.children,r),t.child;case 12:return cr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Je(Yc,n._currentValue),n._currentValue=i,s!==null)if(wn(s.value,i)){if(s.children===a.children&&!wr.current){t=ta(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Xn(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Df(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(fe(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Df(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}cr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,mi(t,r),a=tn(a),n=n(a),t.flags|=1,cr(e,t,n,r),t.child;case 14:return n=t.type,a=cn(n,t.pendingProps),a=cn(n.type,a),_m(e,t,n,a,r);case 15:return dv(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:cn(n,a),Fc(e,t),t.tag=1,_r(n)?(e=!0,Kc(t)):e=!1,mi(t,r),cv(t,n,a),Mf(t,n,a,r),$f(null,t,n,!0,e,r);case 19:return gv(e,t,r);case 22:return hv(e,t,r)}throw Error(fe(156,t.tag))};function Ov(e,t){return i1(e,t)}function yS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,t,r,n){return new yS(e,t,r,n)}function ph(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wS(e){if(typeof e=="function")return ph(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Od)return 11;if(e===Pd)return 14}return 2}function Oa(e,t){var r=e.alternate;return r===null?(r=Qr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Pc(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")ph(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Qs:return fs(r.children,a,s,t);case Rd:i=8,a|=8;break;case lf:return e=Qr(12,r,t,a|2),e.elementType=lf,e.lanes=s,e;case cf:return e=Qr(13,r,t,a),e.elementType=cf,e.lanes=s,e;case uf:return e=Qr(19,r,t,a),e.elementType=uf,e.lanes=s,e;case Wg:return Lu(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $g:i=10;break e;case zg:i=9;break e;case Od:i=11;break e;case Pd:i=14;break e;case ma:i=16,n=null;break e}throw Error(fe(130,e==null?e:typeof e,""))}return t=Qr(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function fs(e,t,r,n){return e=Qr(7,e,n,t),e.lanes=r,e}function Lu(e,t,r,n){return e=Qr(22,e,n,t),e.elementType=Wg,e.lanes=r,e.stateNode={isHidden:!1},e}function F0(e,t,r){return e=Qr(6,e,null,t),e.lanes=r,e}function R0(e,t,r){return t=Qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _S(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=d0(0),this.expirationTimes=d0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=d0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function mh(e,t,r,n,a,s,i,o,l){return e=new _S(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Qr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(s),e}function kS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Js,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Pv(e){if(!e)return Ia;e=e._reactInternals;e:{if(Cs(e)!==e||e.tag!==1)throw Error(fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_r(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(fe(171))}if(e.tag===1){var r=e.type;if(_r(r))return P1(e,r,t)}return t}function Iv(e,t,r,n,a,s,i,o,l){return e=mh(r,n,!0,e,a,s,i,o,l),e.context=Pv(null),r=e.current,n=dr(),a=Ra(r),s=Xn(n,a),s.callback=t??null,ja(r,s,a),e.current.lanes=a,Sl(e,a,n),kr(e,n),e}function Mu(e,t,r,n){var a=t.current,s=dr(),i=Ra(a);return r=Pv(r),t.context===null?t.context=r:t.pendingContext=r,t=Xn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ja(a,t,i),e!==null&&(gn(e,a,i,s),Cc(e,a,i)),i}function iu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Om(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xh(e,t){Om(e,t),(e=e.alternate)&&Om(e,t)}function SS(){return null}var Dv=typeof reportError=="function"?reportError:function(e){console.error(e)};function gh(e){this._internalRoot=e}Bu.prototype.render=gh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(fe(409));Mu(e,t,null,null)};Bu.prototype.unmount=gh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ws(function(){Mu(null,e,null,null)}),t[Zn]=null}};function Bu(e){this._internalRoot=e}Bu.prototype.unstable_scheduleHydration=function(e){if(e){var t=h1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<va.length&&t!==0&&t<va[r].priority;r++);va.splice(r,0,e),r===0&&m1(e)}};function vh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Uu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Pm(){}function ES(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=iu(i);s.call(u)}}var i=Iv(t,n,e,0,null,!1,!1,"",Pm);return e._reactRootContainer=i,e[Zn]=i.current,Vo(e.nodeType===8?e.parentNode:e),ws(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=iu(l);o.call(u)}}var l=mh(e,0,!1,null,null,!1,!1,"",Pm);return e._reactRootContainer=l,e[Zn]=l.current,Vo(e.nodeType===8?e.parentNode:e),ws(function(){Mu(t,l,r,n)}),l}function $u(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=iu(i);o.call(l)}}Mu(t,i,e,a)}else i=ES(r,t,e,a,n);return iu(i)}f1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fo(t.pendingLanes);r!==0&&(Ld(t,r|1),kr(t,_t()),!(Ue&6)&&(Ci=_t()+500,Wa()))}break;case 13:ws(function(){var n=ea(e,1);if(n!==null){var a=dr();gn(n,e,1,a)}}),xh(e,1)}};Md=function(e){if(e.tag===13){var t=ea(e,134217728);if(t!==null){var r=dr();gn(t,e,134217728,r)}xh(e,134217728)}};d1=function(e){if(e.tag===13){var t=Ra(e),r=ea(e,t);if(r!==null){var n=dr();gn(r,e,t,n)}xh(e,t)}};h1=function(){return Xe};p1=function(e,t){var r=Xe;try{return Xe=e,t()}finally{Xe=r}};wf=function(e,t,r){switch(t){case"input":if(hf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Fu(n);if(!a)throw Error(fe(90));Vg(n),hf(n,a)}}}break;case"textarea":Kg(e,r);break;case"select":t=r.value,t!=null&&fi(e,!!r.multiple,t,!1)}};e1=fh;t1=ws;var bS={usingClientEntryPoint:!1,Events:[bl,ri,Fu,Qg,Zg,fh]},no={findFiberByHostInstance:ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TS={bundleType:no.bundleType,version:no.version,rendererPackageName:no.rendererPackageName,rendererConfig:no.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=a1(e),e===null?null:e.stateNode},findFiberByHostInstance:no.findFiberByHostInstance||SS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ac=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ac.isDisabled&&ac.supportsFiber)try{Nu=ac.inject(TS),jn=ac}catch{}}Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bS;Ur.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vh(t))throw Error(fe(200));return kS(e,t,null,r)};Ur.createRoot=function(e,t){if(!vh(e))throw Error(fe(299));var r=!1,n="",a=Dv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=mh(e,1,!1,null,null,r,!1,n,a),e[Zn]=t.current,Vo(e.nodeType===8?e.parentNode:e),new gh(t)};Ur.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(fe(188)):(e=Object.keys(e).join(","),Error(fe(268,e)));return e=a1(t),e=e===null?null:e.stateNode,e};Ur.flushSync=function(e){return ws(e)};Ur.hydrate=function(e,t,r){if(!Uu(t))throw Error(fe(200));return $u(null,e,t,!0,r)};Ur.hydrateRoot=function(e,t,r){if(!vh(e))throw Error(fe(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Dv;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Iv(t,null,e,1,r??null,a,!1,s,i),e[Zn]=t.current,Vo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Bu(t)};Ur.render=function(e,t,r){if(!Uu(t))throw Error(fe(200));return $u(null,e,t,!1,r)};Ur.unmountComponentAtNode=function(e){if(!Uu(e))throw Error(fe(40));return e._reactRootContainer?(ws(function(){$u(null,null,e,!1,function(){e._reactRootContainer=null,e[Zn]=null})}),!0):!1};Ur.unstable_batchedUpdates=fh;Ur.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Uu(r))throw Error(fe(200));if(e==null||e._reactInternals===void 0)throw Error(fe(38));return $u(e,t,r,!1,n)};Ur.version="18.3.1-next-f1338f8080-20240426";function Lv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Lv)}catch(e){console.error(e)}}Lv(),Lg.exports=Ur;var NS=Lg.exports,Im=NS;sf.createRoot=Im.createRoot,sf.hydrateRoot=Im.hydrateRoot;/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Dm="popstate";function CS(e={}){function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Zf("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:el(a)}return jS(t,r,null,e)}function st(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function AS(){return Math.random().toString(36).substring(2,10)}function Lm(e,t){return{usr:e.state,key:e.key,idx:t}}function Zf(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Li(t):t,state:r,key:t&&t.key||n||AS()}}function el({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Li(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function jS(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o="POP",l=null,u=f();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function f(){return(i.state||{idx:null}).idx}function d(){o="POP";let p=f(),y=p==null?null:p-u;u=p,l&&l({action:o,location:m.location,delta:y})}function h(p,y){o="PUSH";let w=Zf(m.location,p,y);u=f()+1;let v=Lm(w,u),_=m.createHref(w);try{i.pushState(v,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;a.location.assign(_)}s&&l&&l({action:o,location:m.location,delta:1})}function x(p,y){o="REPLACE";let w=Zf(m.location,p,y);u=f();let v=Lm(w,u),_=m.createHref(w);i.replaceState(v,"",_),s&&l&&l({action:o,location:m.location,delta:0})}function g(p){return FS(p)}let m={get action(){return o},get location(){return e(a,i)},listen(p){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Dm,d),l=p,()=>{a.removeEventListener(Dm,d),l=null}},createHref(p){return t(a,p)},createURL:g,encodeLocation(p){let y=g(p);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:x,go(p){return i.go(p)}};return m}function FS(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),st(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:el(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Mv(e,t,r="/"){return RS(e,t,r,!1)}function RS(e,t,r,n){let a=typeof t=="string"?Li(t):t,s=ra(a.pathname||"/",r);if(s==null)return null;let i=Bv(e);OS(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=HS(s);o=zS(i[l],u,n)}return o}function Bv(e,t=[],r=[],n="",a=!1){let s=(i,o,l=a,u)=>{let f={relativePath:u===void 0?i.path||"":u,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(n)&&l)return;st(f.relativePath.startsWith(n),`Absolute route path "${f.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(n.length)}let d=qn([n,f.relativePath]),h=r.concat(f);i.children&&i.children.length>0&&(st(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Bv(i.children,t,h,d,l)),!(i.path==null&&!i.index)&&t.push({path:d,score:US(d,i.index),routesMeta:h})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let u of Uv(i.path))s(i,o,!0,u)}),t}function Uv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Uv(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function OS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:$S(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var PS=/^:[\w-]+$/,IS=3,DS=2,LS=1,MS=10,BS=-2,Mm=e=>e==="*";function US(e,t){let r=e.split("/"),n=r.length;return r.some(Mm)&&(n+=BS),t&&(n+=DS),r.filter(a=>!Mm(a)).reduce((a,s)=>a+(PS.test(s)?IS:s===""?LS:MS),n)}function $S(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function zS(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=ou({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),h=l.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=ou({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:qn([s,d.pathname]),pathnameBase:XS(qn([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=qn([s,d.pathnameBase]))}return i}function ou(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=WS(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,{paramName:f,isOptional:d},h)=>{if(f==="*"){let g=o[h]||"";i=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[h];return d&&!x?u[f]=void 0:u[f]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:i,pattern:e}}function WS(e,t=!1,r=!0){nn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function HS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ra(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var $v=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VS=e=>$v.test(e);function GS(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Li(e):e,s;if(r)if(VS(r))s=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),nn(!1,`Pathnames cannot have embedded double slashes - normalizing ${i} -> ${r}`)}r.startsWith("/")?s=Bm(r.substring(1),"/"):s=Bm(r,t)}else s=t;return{pathname:s,search:qS(n),hash:YS(a)}}function Bm(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function O0(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function KS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function yh(e){let t=KS(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function wh(e,t,r,n=!1){let a;typeof e=="string"?a=Li(e):(a={...e},st(!a.pathname||!a.pathname.includes("?"),O0("?","pathname","search",a)),st(!a.pathname||!a.pathname.includes("#"),O0("#","pathname","hash",a)),st(!a.search||!a.search.includes("#"),O0("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=GS(a,o),u=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}var qn=e=>e.join("/").replace(/\/\/+/g,"/"),XS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,YS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,JS=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function QS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function ZS(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var zv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Wv(e,t){let r=e;if(typeof r!="string"||!$v.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,a=!1;if(zv)try{let s=new URL(window.location.href),i=r.startsWith("//")?new URL(s.protocol+r):new URL(r),o=ra(i.pathname,t);i.origin===s.origin&&o!=null?r=o+i.search+i.hash:a=!0}catch{nn(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Hv=["POST","PUT","PATCH","DELETE"];new Set(Hv);var eE=["GET",...Hv];new Set(eE);var Mi=N.createContext(null);Mi.displayName="DataRouter";var zu=N.createContext(null);zu.displayName="DataRouterState";var tE=N.createContext(!1),Vv=N.createContext({isTransitioning:!1});Vv.displayName="ViewTransition";var rE=N.createContext(new Map);rE.displayName="Fetchers";var nE=N.createContext(null);nE.displayName="Await";var zr=N.createContext(null);zr.displayName="Navigation";var Nl=N.createContext(null);Nl.displayName="Location";var Dn=N.createContext({outlet:null,matches:[],isDataRoute:!1});Dn.displayName="Route";var _h=N.createContext(null);_h.displayName="RouteError";var Gv="REACT_ROUTER_ERROR",aE="REDIRECT",sE="ROUTE_ERROR_RESPONSE";function iE(e){if(e.startsWith(`${Gv}:${aE}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function oE(e){if(e.startsWith(`${Gv}:${sE}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new JS(t.status,t.statusText,t.data)}catch{}}function lE(e,{relative:t}={}){st(Bi(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(zr),{hash:a,pathname:s,search:i}=Cl(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:qn([r,s])),n.createHref({pathname:o,search:i,hash:a})}function Bi(){return N.useContext(Nl)!=null}function ia(){return st(Bi(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Nl).location}var Kv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Xv(e){N.useContext(zr).static||N.useLayoutEffect(e)}function Wu(){let{isDataRoute:e}=N.useContext(Dn);return e?_E():cE()}function cE(){st(Bi(),"useNavigate() may be used only in the context of a <Router> component.");let e=N.useContext(Mi),{basename:t,navigator:r}=N.useContext(zr),{matches:n}=N.useContext(Dn),{pathname:a}=ia(),s=JSON.stringify(yh(n)),i=N.useRef(!1);return Xv(()=>{i.current=!0}),N.useCallback((l,u={})=>{if(nn(i.current,Kv),!i.current)return;if(typeof l=="number"){r.go(l);return}let f=wh(l,JSON.parse(s),a,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:qn([t,f.pathname])),(u.replace?r.replace:r.push)(f,u.state,u)},[t,r,s,a,e])}N.createContext(null);function Cl(e,{relative:t}={}){let{matches:r}=N.useContext(Dn),{pathname:n}=ia(),a=JSON.stringify(yh(r));return N.useMemo(()=>wh(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function uE(e,t){return qv(e,t)}function qv(e,t,r,n,a){var w;st(Bi(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(zr),{matches:i}=N.useContext(Dn),o=i[i.length-1],l=o?o.params:{},u=o?o.pathname:"/",f=o?o.pathnameBase:"/",d=o&&o.route;{let v=d&&d.path||"";Jv(u,!d||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let h=ia(),x;if(t){let v=typeof t=="string"?Li(t):t;st(f==="/"||((w=v.pathname)==null?void 0:w.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${v.pathname}" was given in the \`location\` prop.`),x=v}else x=h;let g=x.pathname||"/",m=g;if(f!=="/"){let v=f.replace(/^\//,"").split("/");m="/"+g.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=Mv(e,{pathname:m});nn(d||p!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),nn(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=mE(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:qn([f,s.encodeLocation?s.encodeLocation(v.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?f:qn([f,s.encodeLocation?s.encodeLocation(v.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathnameBase])})),i,r,n,a);return t&&y?N.createElement(Nl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},y):y}function fE(){let e=wE(),t=QS(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:s},"ErrorBoundary")," or"," ",N.createElement("code",{style:s},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),r?N.createElement("pre",{style:a},r):null,i)}var dE=N.createElement(fE,null),Yv=class extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=oE(e.digest);r&&(e=r)}let t=e!==void 0?N.createElement(Dn.Provider,{value:this.props.routeContext},N.createElement(_h.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?N.createElement(hE,{error:e},t):t}};Yv.contextType=tE;var P0=new WeakMap;function hE({children:e,error:t}){let{basename:r}=N.useContext(zr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=iE(t.digest);if(n){let a=P0.get(t);if(a)throw a;let s=Wv(n.location,r);if(zv&&!P0.get(t))if(s.isExternal||n.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:n.replace}));throw P0.set(t,i),i}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function pE({routeContext:e,match:t,children:r}){let n=N.useContext(Mi);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),N.createElement(Dn.Provider,{value:e},r)}function mE(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let f=s.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);st(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let o=!1,l=-1;if(r)for(let f=0;f<s.length;f++){let d=s[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=f),d.route.id){let{loaderData:h,errors:x}=r,g=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!x||x[d.route.id]===void 0);if(d.route.lazy||g){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let u=r&&n?(f,d)=>{var h,x;n(f,{location:r.location,params:((x=(h=r.matches)==null?void 0:h[0])==null?void 0:x.params)??{},unstable_pattern:ZS(r.matches),errorInfo:d})}:void 0;return s.reduceRight((f,d,h)=>{let x,g=!1,m=null,p=null;r&&(x=i&&d.route.id?i[d.route.id]:void 0,m=d.route.errorElement||dE,o&&(l<0&&h===0?(Jv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,p=null):l===h&&(g=!0,p=d.route.hydrateFallbackElement||null)));let y=t.concat(s.slice(0,h+1)),w=()=>{let v;return x?v=m:g?v=p:d.route.Component?v=N.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=f,N.createElement(pE,{match:d,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:v})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?N.createElement(Yv,{location:r.location,revalidation:r.revalidation,component:m,error:x,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0},onError:u}):w()},null)}function kh(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xE(e){let t=N.useContext(Mi);return st(t,kh(e)),t}function gE(e){let t=N.useContext(zu);return st(t,kh(e)),t}function vE(e){let t=N.useContext(Dn);return st(t,kh(e)),t}function Sh(e){let t=vE(e),r=t.matches[t.matches.length-1];return st(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function yE(){return Sh("useRouteId")}function wE(){var n;let e=N.useContext(_h),t=gE("useRouteError"),r=Sh("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function _E(){let{router:e}=xE("useNavigate"),t=Sh("useNavigate"),r=N.useRef(!1);return Xv(()=>{r.current=!0}),N.useCallback(async(a,s={})=>{nn(r.current,Kv),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var Um={};function Jv(e,t,r){!t&&!Um[e]&&(Um[e]=!0,nn(!1,r))}N.memo(kE);function kE({routes:e,future:t,state:r,onError:n}){return qv(e,void 0,r,n,t)}function ao({to:e,replace:t,state:r,relative:n}){st(Bi(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=N.useContext(zr);nn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=N.useContext(Dn),{pathname:i}=ia(),o=Wu(),l=wh(e,yh(s),i,n==="path"),u=JSON.stringify(l);return N.useEffect(()=>{o(JSON.parse(u),{replace:t,state:r,relative:n})},[o,u,n,t,r]),null}function Tr(e){st(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function SE({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1,unstable_useTransitions:i}){st(!Bi(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:a,static:s,unstable_useTransitions:i,future:{}}),[o,a,s,i]);typeof r=="string"&&(r=Li(r));let{pathname:u="/",search:f="",hash:d="",state:h=null,key:x="default"}=r,g=N.useMemo(()=>{let m=ra(u,o);return m==null?null:{location:{pathname:m,search:f,hash:d,state:h,key:x},navigationType:n}},[o,u,f,d,h,x,n]);return nn(g!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:N.createElement(zr.Provider,{value:l},N.createElement(Nl.Provider,{children:t,value:g}))}function $m({children:e,location:t}){return uE(ed(e),t)}function ed(e,t=[]){let r=[];return N.Children.forEach(e,(n,a)=>{if(!N.isValidElement(n))return;let s=[...t,a];if(n.type===N.Fragment){r.push.apply(r,ed(n.props.children,s));return}st(n.type===Tr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),st(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=ed(n.props.children,s)),r.push(i)}),r}var Ic="get",Dc="application/x-www-form-urlencoded";function Hu(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function EE(e){return Hu(e)&&e.tagName.toLowerCase()==="button"}function bE(e){return Hu(e)&&e.tagName.toLowerCase()==="form"}function TE(e){return Hu(e)&&e.tagName.toLowerCase()==="input"}function NE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function CE(e,t){return e.button===0&&(!t||t==="_self")&&!NE(e)}var sc=null;function AE(){if(sc===null)try{new FormData(document.createElement("form"),0),sc=!1}catch{sc=!0}return sc}var jE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function I0(e){return e!=null&&!jE.has(e)?(nn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dc}"`),null):e}function FE(e,t){let r,n,a,s,i;if(bE(e)){let o=e.getAttribute("action");n=o?ra(o,t):null,r=e.getAttribute("method")||Ic,a=I0(e.getAttribute("enctype"))||Dc,s=new FormData(e)}else if(EE(e)||TE(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?ra(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Ic,a=I0(e.getAttribute("formenctype"))||I0(o.getAttribute("enctype"))||Dc,s=new FormData(o,e),!AE()){let{name:u,type:f,value:d}=e;if(f==="image"){let h=u?`${u}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else u&&s.append(u,d)}}else{if(Hu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ic,n=null,a=Dc,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Eh(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function RE(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&ra(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function OE(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function PE(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function IE(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await OE(s,r);return i.links?i.links():[]}return[]}));return BE(n.flat(1).filter(PE).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function zm(e,t,r,n,a,s){let i=(l,u)=>r[u]?l.route.id!==r[u].route.id:!0,o=(l,u)=>{var f;return r[u].pathname!==l.pathname||((f=r[u].route.path)==null?void 0:f.endsWith("*"))&&r[u].params["*"]!==l.params["*"]};return s==="assets"?t.filter((l,u)=>i(l,u)||o(l,u)):s==="data"?t.filter((l,u)=>{var d;let f=n.routes[l.route.id];if(!f||!f.hasLoader)return!1;if(i(l,u)||o(l,u))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function DE(e,t,{includeHydrateFallback:r}={}){return LE(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function LE(e){return[...new Set(e)]}function ME(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function BE(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(ME(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function Qv(){let e=N.useContext(Mi);return Eh(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function UE(){let e=N.useContext(zu);return Eh(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var bh=N.createContext(void 0);bh.displayName="FrameworkContext";function Zv(){let e=N.useContext(bh);return Eh(e,"You must render this element inside a <HydratedRouter> element"),e}function $E(e,t){let r=N.useContext(bh),[n,a]=N.useState(!1),[s,i]=N.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:u,onMouseLeave:f,onTouchStart:d}=t,h=N.useRef(null);N.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=y=>{y.forEach(w=>{i(w.isIntersecting)})},p=new IntersectionObserver(m,{threshold:.5});return h.current&&p.observe(h.current),()=>{p.disconnect()}}},[e]),N.useEffect(()=>{if(n){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[n]);let x=()=>{a(!0)},g=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,h,{}]:[s,h,{onFocus:so(o,x),onBlur:so(l,g),onMouseEnter:so(u,x),onMouseLeave:so(f,g),onTouchStart:so(d,x)}]:[!1,h,{}]}function so(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function zE({page:e,...t}){let{router:r}=Qv(),n=N.useMemo(()=>Mv(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?N.createElement(HE,{page:e,matches:n,...t}):null}function WE(e){let{manifest:t,routeModules:r}=Zv(),[n,a]=N.useState([]);return N.useEffect(()=>{let s=!1;return IE(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function HE({page:e,matches:t,...r}){let n=ia(),{manifest:a,routeModules:s}=Zv(),{basename:i}=Qv(),{loaderData:o,matches:l}=UE(),u=N.useMemo(()=>zm(e,t,l,a,n,"data"),[e,t,l,a,n]),f=N.useMemo(()=>zm(e,t,l,a,n,"assets"),[e,t,l,a,n]),d=N.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let g=new Set,m=!1;if(t.forEach(y=>{var v;let w=a.routes[y.route.id];!w||!w.hasLoader||(!u.some(_=>_.route.id===y.route.id)&&y.route.id in o&&((v=s[y.route.id])!=null&&v.shouldRevalidate)||w.hasClientLoader?m=!0:g.add(y.route.id))}),g.size===0)return[];let p=RE(e,i,"data");return m&&g.size>0&&p.searchParams.set("_routes",t.filter(y=>g.has(y.route.id)).map(y=>y.route.id).join(",")),[p.pathname+p.search]},[i,o,n,a,u,t,e,s]),h=N.useMemo(()=>DE(f,a),[f,a]),x=WE(f);return N.createElement(N.Fragment,null,d.map(g=>N.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),h.map(g=>N.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),x.map(({key:g,link:m})=>N.createElement("link",{key:g,nonce:r.nonce,...m})))}function VE(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var GE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GE&&(window.__reactRouterVersion="7.11.0")}catch{}function KE({basename:e,children:t,unstable_useTransitions:r,window:n}){let a=N.useRef();a.current==null&&(a.current=CS({window:n,v5Compat:!0}));let s=a.current,[i,o]=N.useState({action:s.action,location:s.location}),l=N.useCallback(u=>{r===!1?o(u):N.startTransition(()=>o(u))},[r]);return N.useLayoutEffect(()=>s.listen(l),[s,l]),N.createElement(SE,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:s,unstable_useTransitions:r})}var ey=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Th=N.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:o,target:l,to:u,preventScrollReset:f,viewTransition:d,unstable_defaultShouldRevalidate:h,...x},g){let{basename:m,unstable_useTransitions:p}=N.useContext(zr),y=typeof u=="string"&&ey.test(u),w=Wv(u,m);u=w.to;let v=lE(u,{relative:a}),[_,k,E]=$E(n,x),S=JE(u,{replace:i,state:o,target:l,preventScrollReset:f,relative:a,viewTransition:d,unstable_defaultShouldRevalidate:h,unstable_useTransitions:p});function C(U){t&&t(U),U.defaultPrevented||S(U)}let A=N.createElement("a",{...x,...E,href:w.absoluteURL||v,onClick:w.isExternal||s?t:C,ref:VE(g,k),target:l,"data-discover":!y&&r==="render"?"true":void 0});return _&&!y?N.createElement(N.Fragment,null,A,N.createElement(zE,{page:v})):A});Th.displayName="Link";var XE=N.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:o,children:l,...u},f){let d=Cl(i,{relative:u.relative}),h=ia(),x=N.useContext(zu),{navigator:g,basename:m}=N.useContext(zr),p=x!=null&&rb(d)&&o===!0,y=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,w=h.pathname,v=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;r||(w=w.toLowerCase(),v=v?v.toLowerCase():null,y=y.toLowerCase()),v&&m&&(v=ra(v,m)||v);const _=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let k=w===y||!a&&w.startsWith(y)&&w.charAt(_)==="/",E=v!=null&&(v===y||!a&&v.startsWith(y)&&v.charAt(y.length)==="/"),S={isActive:k,isPending:E,isTransitioning:p},C=k?t:void 0,A;typeof n=="function"?A=n(S):A=[n,k?"active":null,E?"pending":null,p?"transitioning":null].filter(Boolean).join(" ");let U=typeof s=="function"?s(S):s;return N.createElement(Th,{...u,"aria-current":C,className:A,ref:f,style:U,to:i,viewTransition:o},typeof l=="function"?l(S):l)});XE.displayName="NavLink";var qE=N.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Ic,action:o,onSubmit:l,relative:u,preventScrollReset:f,viewTransition:d,unstable_defaultShouldRevalidate:h,...x},g)=>{let{unstable_useTransitions:m}=N.useContext(zr),p=eb(),y=tb(o,{relative:u}),w=i.toLowerCase()==="get"?"get":"post",v=typeof o=="string"&&ey.test(o),_=k=>{if(l&&l(k),k.defaultPrevented)return;k.preventDefault();let E=k.nativeEvent.submitter,S=(E==null?void 0:E.getAttribute("formmethod"))||i,C=()=>p(E||k.currentTarget,{fetcherKey:t,method:S,navigate:r,replace:a,state:s,relative:u,preventScrollReset:f,viewTransition:d,unstable_defaultShouldRevalidate:h});m&&r!==!1?N.startTransition(()=>C()):C()};return N.createElement("form",{ref:g,method:w,action:y,onSubmit:n?l:_,...x,"data-discover":!v&&e==="render"?"true":void 0})});qE.displayName="Form";function YE(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ty(e){let t=N.useContext(Mi);return st(t,YE(e)),t}function JE(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i,unstable_defaultShouldRevalidate:o,unstable_useTransitions:l}={}){let u=Wu(),f=ia(),d=Cl(e,{relative:s});return N.useCallback(h=>{if(CE(h,t)){h.preventDefault();let x=r!==void 0?r:el(f)===el(d),g=()=>u(e,{replace:x,state:n,preventScrollReset:a,relative:s,viewTransition:i,unstable_defaultShouldRevalidate:o});l?N.startTransition(()=>g()):g()}},[f,u,d,r,n,t,e,a,s,i,o,l])}var QE=0,ZE=()=>`__${String(++QE)}__`;function eb(){let{router:e}=ty("useSubmit"),{basename:t}=N.useContext(zr),r=yE(),n=e.fetch,a=e.navigate;return N.useCallback(async(s,i={})=>{let{action:o,method:l,encType:u,formData:f,body:d}=FE(s,t);if(i.navigate===!1){let h=i.fetcherKey||ZE();await n(h,r,i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:f,body:d,formMethod:i.method||l,formEncType:i.encType||u,flushSync:i.flushSync})}else await a(i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:f,body:d,formMethod:i.method||l,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,a,t,r])}function tb(e,{relative:t}={}){let{basename:r}=N.useContext(zr),n=N.useContext(Dn);st(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...Cl(e||".",{relative:t})},i=ia();if(e==null){s.search=i.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(f=>f==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let f=o.toString();s.search=f?`?${f}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:qn([r,s.pathname])),el(s)}function rb(e,{relative:t}={}){let r=N.useContext(Vv);st(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=ty("useViewTransitionState"),a=Cl(e,{relative:t});if(!r.isTransitioning)return!1;let s=ra(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ra(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ou(a.pathname,i)!=null||ou(a.pathname,s)!=null}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ab=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Wm=e=>{const t=ab(e);return t.charAt(0).toUpperCase()+t.slice(1)},ry=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),sb=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ib={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=N.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>N.createElement("svg",{ref:l,...ib,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:ry("lucide",a),...!s&&!sb(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,f])=>N.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=(e,t)=>{const r=N.forwardRef(({className:n,...a},s)=>N.createElement(ob,{ref:s,iconNode:t,className:ry(`lucide-${nb(Wm(e))}`,`lucide-${e}`,n),...a}));return r.displayName=Wm(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],cb=ke("arrow-down",lb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fb=ke("arrow-left",ub);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],hb=ke("bell",db);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],mb=ke("bold",pb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ny=ke("book-open",xb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],vb=ke("building",gb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],On=ke("calendar",yb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],_b=ke("chart-no-axes-column",wb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Sb=ke("chart-pie",kb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Nh=ke("check",Eb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ay=ke("chevron-left",bb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],sy=ke("chevron-right",Tb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Da=ke("circle-alert",Nb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],lu=ke("circle-check-big",Cb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jb=ke("circle",Ab);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tl=ke("clock",Fb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ob=ke("copy",Rb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],iy=ke("database",Pb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ha=ke("dollar-sign",Ib);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ts=ke("download",Db);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Mb=ke("ellipsis",Lb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ub=ke("external-link",Bb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],oy=ke("eye-off",$b);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ch=ke("eye",zb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Hm=ke("file-spreadsheet",Wb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Al=ke("file-text",Hb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Gb=ke("funnel",Vb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],td=ke("globe",Kb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],qb=ke("house",Xb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Jb=ke("image",Yb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Zb=ke("italic",Qb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],t4=ke("layout-dashboard",e4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Pn=ke("loader",r4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ah=ke("lock",n4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],s4=ke("log-out",a4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],jl=ke("mail",i4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ly=ke("map-pin",o4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],c4=ke("maximize",l4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Vm=ke("message-circle",u4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],d4=ke("panels-top-left",f4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],jh=ke("pen",h4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],m4=ke("pencil",p4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ai=ke("phone",x4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],In=ke("plus",g4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],cy=ke("receipt",v4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],w4=ke("refresh-cw",y4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ui=ke("save",_4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Vu=ke("search",k4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],E4=ke("send",S4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],T4=ke("settings",b4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Gu=ke("square-check-big",N4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],uy=ke("square",C4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],j4=ke("strikethrough",A4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Ku=ke("tag",F4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$i=ke("trash-2",R4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],P4=ke("trending-down",O4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],cu=ke("trending-up",I4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],L4=ke("triangle-alert",D4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],As=ke("upload",M4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],U4=ke("user-check",B4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],z4=ke("user-plus",$4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],H4=ke("user-x",W4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],na=ke("user",V4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ji=ke("users",G4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ut=ke("x",K4);function Xu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function X4(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function l(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?s(f.value):a(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})}const q4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Fh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Y4 extends Fh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Gm extends Fh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Km extends Fh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var rd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(rd||(rd={}));class J4{constructor(t,{headers:r={},customFetch:n,region:a=rd.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=q4(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return X4(this,arguments,void 0,function*(r,n={}){var a;let s,i;try{const{headers:o,method:l,body:u,signal:f,timeout:d}=n;let h={},{region:x}=n;x||(x=this.region);const g=new URL(`${this.url}/${r}`);x&&x!=="any"&&(h["x-region"]=x,g.searchParams.set("forceFunctionRegion",x));let m;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(h["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(h["Content-Type"]="application/json",m=JSON.stringify(u)):m=u;let p=f;d&&(i=new AbortController,s=setTimeout(()=>i.abort(),d),f?(p=i.signal,f.addEventListener("abort",()=>i.abort())):p=i.signal);const y=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:m,signal:p}).catch(k=>{throw new Y4(k)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new Gm(y);if(!y.ok)throw new Km(y);let v=((a=y.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),_;return v==="application/json"?_=yield y.json():v==="application/octet-stream"||v==="application/pdf"?_=yield y.blob():v==="text/event-stream"?_=y:v==="multipart/form-data"?_=yield y.formData():_=yield y.text(),{data:_,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof Km||o instanceof Gm?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Q4=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Z4=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let i=null,o=null,l=null,u=s.status,f=s.statusText;if(s.ok){var d,h;if(r.method!=="HEAD"){var x;const y=await s.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((x=r.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const m=(d=r.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),p=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&p&&p.length>1&&(l=parseInt(p[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var g;const m=await s.text();try{i=JSON.parse(m),Array.isArray(i)&&s.status===404&&(o=[],i=null,u=200,f="OK")}catch{s.status===404&&m===""?(u=204,f="No Content"):i={message:m}}if(i&&r.isMaybeSingle&&(!(i==null||(g=i.details)===null||g===void 0)&&g.includes("0 rows"))&&(i=null,u=200,f="OK"),i&&r.shouldThrowOnError)throw new Q4(i)}return{error:i,data:o,count:l,status:u,statusText:f}});return this.shouldThrowOnError||(a=a.catch(s=>{var i;let o="";const l=s==null?void 0:s.cause;if(l){var u,f,d,h;const g=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",m=(f=l==null?void 0:l.code)!==null&&f!==void 0?f:"";o=`${(d=s==null?void 0:s.name)!==null&&d!==void 0?d:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"Error"}: ${g}`,m&&(o+=` (${m})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var x;o=(x=s==null?void 0:s.stack)!==null&&x!==void 0?x:""}return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},eT=class extends Z4{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const s=a?`${a}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:s="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Xm=new RegExp("[,()]");var Ks=class extends eT{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Xm.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Xm.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},tT=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Ks({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const s=e.reduce((i,o)=>i.concat(Object.keys(o)),[]);if(s.length>0){const i=[...new Set(s)].map(o=>`"${o}"`);this.url.searchParams.set("columns",i.join(","))}}return new Ks({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var s;const i="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ks({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Ks({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Ks({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},rT=class fy{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new tT(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new fy(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let u;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",u=r);const f=new Headers(this.headers);return s&&f.set("Prefer",`count=${s}`),new Ks({method:o,url:l,headers:f,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class nT{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const aT="2.89.0",sT=`realtime-js/${aT}`,dy="1.0.0",iT="2.0.0",qm=dy,nd=1e4,oT=1e3,lT=100;var ga;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ga||(ga={}));var jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jt||(jt={}));var dn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(dn||(dn={}));var ad;(function(e){e.websocket="websocket"})(ad||(ad={}));var rs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(rs||(rs={}));class cT{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},i=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,r,n){var a,s;const i=t.topic,o=(a=t.ref)!==null&&a!==void 0?a:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,f=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},d=Object.keys(f).length===0?"":JSON.stringify(f);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+i.length+u.length+d.length,x=new ArrayBuffer(this.HEADER_LENGTH+h);let g=new DataView(x),m=0;g.setUint8(m++,this.KINDS.userBroadcastPush),g.setUint8(m++,l.length),g.setUint8(m++,o.length),g.setUint8(m++,i.length),g.setUint8(m++,u.length),g.setUint8(m++,d.length),g.setUint8(m++,r),Array.from(l,y=>g.setUint8(m++,y.charCodeAt(0))),Array.from(o,y=>g.setUint8(m++,y.charCodeAt(0))),Array.from(i,y=>g.setUint8(m++,y.charCodeAt(0))),Array.from(u,y=>g.setUint8(m++,y.charCodeAt(0))),Array.from(d,y=>g.setUint8(m++,y.charCodeAt(0)));var p=new Uint8Array(x.byteLength+n.byteLength);return p.set(new Uint8Array(x),0),p.set(new Uint8Array(n),x.byteLength),p.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,s,i,o,l]=n;return r({join_ref:a,ref:s,topic:i,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=n.decode(t.slice(l,l+a));l=l+a;const f=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+i));l=l+i;const h=t.slice(l,t.byteLength),x=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST_EVENT,event:f,payload:x};return i>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class hy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ye||(Ye={}));const Ym=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,i)=>(s[i]=uT(i,e,t,a),s),{}):{}},uT=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?py(s,i):sd(i)},py=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return pT(t,r)}switch(e){case Ye.bool:return fT(t);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return dT(t);case Ye.json:case Ye.jsonb:return hT(t);case Ye.timestamp:return mT(t);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return sd(t);default:return sd(t)}},sd=e=>e,fT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},dT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},hT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},pT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>py(t,o))}return e},mT=e=>typeof e=="string"?e.replace(" ","T"):e,my=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class D0{constructor(t,r,n={},a=nd){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Jm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Jm||(Jm={}));class No{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=No.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=No.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=No.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(u,f)=>{i[u]||(l[u]=f)}),this.map(i,(u,f)=>{const d=s[u];if(d){const h=f.map(p=>p.presence_ref),x=d.map(p=>p.presence_ref),g=f.filter(p=>x.indexOf(p.presence_ref)<0),m=d.filter(p=>h.indexOf(p.presence_ref)<0);g.length>0&&(o[u]=g),m.length>0&&(l[u]=m)}else o[u]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(x=>x.presence_ref),h=f.filter(x=>d.indexOf(x.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let u=t[o];if(!u)return;const f=l.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=u,a(o,u,l),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qm;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Qm||(Qm={}));var Co;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Co||(Co={}));var Wn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wn||(Wn={}));class ci{constructor(t,r={config:{}},n){var a,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new D0(this,dn.join,this.params,this.timeout),this.rejoinTimer=new hy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new No(this),this.broadcastEndpointURL=my(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[Co.PRESENCE]&&this.bindings[Co.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(x=>t==null?void 0:t(Wn.CHANNEL_ERROR,x)),this._onClose(()=>t==null?void 0:t(Wn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){t==null||t(Wn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,p=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,y=[];for(let w=0;w<p;w++){const v=m[w],{filter:{event:_,schema:k,table:E,filter:S}}=v,C=x&&x[w];if(C&&C.event===_&&ci.isFilterValueEqual(C.schema,k)&&ci.isFilterValueEqual(C.table,E)&&ci.isFilterValueEqual(C.filter,S))y.push(Object.assign(Object.assign({},v),{id:C.id}));else{this.unsubscribe(),this.state=jt.errored,t==null||t(Wn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Wn.SUBSCRIBED);return}}).receive("error",x=>{this.state=jt.errored,t==null||t(Wn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===jt.joined&&t===Co.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const u=await o.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new D0(this,dn.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new D0(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>lT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:u,join:f}=dn;if(n&&[o,l,u,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var g,m,p;return((g=x.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(m=x.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===i}).map(x=>x.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(x=>{var g,m,p,y,w,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in x){const _=x.id,k=(g=x.filter)===null||g===void 0?void 0:g.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((p=r.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const _=(w=(y=x==null?void 0:x.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===i}).map(x=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:p,commit_timestamp:y,type:w,errors:v}=g;h=Object.assign(Object.assign({},{schema:m,table:p,commit_timestamp:y,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(g))}x.callback(h,n)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ci.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(dn.close,{},t)}_onError(t){this._on(dn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ym(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ym(t.columns,t.old_record)),r}}const L0=()=>{},ic={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xT=[1e3,2e3,5e3,1e4],gT=1e4,vT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=nd,this.transport=null,this.heartbeatIntervalMs=ic.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=L0,this.ref=0,this.reconnectTimer=null,this.vsn=qm,this.logger=L0,this.conn=null,this.sendBuffer=[],this.serializer=new cT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...s)=>a(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ad.websocket}`,this.httpEndpoint=my(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=nT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ga.connecting:return rs.Connecting;case ga.open:return rs.Open;case ga.closing:return rs.Closing;default:return rs.Closed}}isConnected(){return this.connectionState()===rs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new ci(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(oT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ic.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ga.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ga.open||this.conn.readyState===ga.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(dn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([vT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const s={access_token:r,version:sT};r&&a.updateJoinPayload(s),a.joinedOnce&&a._isJoined()&&a._push(dn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new hy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ic.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,u,f,d,h,x;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:nd,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:ic.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:L0,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:qm,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:g=>xT[g-1]||gT,this.vsn){case dy:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(g,m)=>m(JSON.stringify(g)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(g,m)=>m(JSON.parse(g));break;case iT:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var rl=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function wT(e,t,r){const n=new URL(t,e);if(r)for(const[a,s]of Object.entries(r))s!==void 0&&n.searchParams.set(a,s);return n.toString()}async function _T(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function kT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:s,headers:i}){const o=wT(e.baseUrl,n,a),l=await _T(e.auth),u=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...i},body:s?JSON.stringify(s):void 0}),f=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),h=d&&f?JSON.parse(f):f;if(!u.ok){const x=d?h:void 0,g=x==null?void 0:x.error;throw new rl((g==null?void 0:g.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:g==null?void 0:g.type,icebergCode:g==null?void 0:g.code,details:x})}return{status:u.status,headers:u.headers,data:h}}}}function oc(e){return e.join("")}var ST=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:oc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${oc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${oc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${oc(e.namespace)}`}),!0}catch(t){if(t instanceof rl&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof rl&&r.status===409)return;throw r}}};function Ms(e){return e.join("")}var ET=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ms(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof rl&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof rl&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},bT=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=kT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new ST(this.client,t),this.tableOps=new ET(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},qu=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function lt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var TT=class extends qu{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},id=class extends qu{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Rh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),NT=()=>Response,od=e=>{if(Array.isArray(e))return e.map(r=>od(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=od(n)}),t},CT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},AT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function nl(e){"@babel/helpers - typeof";return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(e)}function jT(e,t){if(nl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FT(e){var t=jT(e,"string");return nl(t)=="symbol"?t:t+""}function RT(e,t,r){return(t=FT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zm(Object(r),!0).forEach(function(n){RT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zm(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const M0=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},OT=async(e,t,r)=>{e instanceof await NT()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,s=(n==null?void 0:n.statusCode)||a+"";t(new TT(M0(n),a,s))}).catch(n=>{t(new id(M0(n),n))}):t(new id(M0(e),e))},PT=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(CT(n)?(a.headers=Ne({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Ne(Ne({},a),r))};async function Fl(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,PT(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>OT(l,o,n))})}async function al(e,t,r,n){return Fl(e,"GET",t,r,n)}async function un(e,t,r,n,a){return Fl(e,"POST",t,n,a,r)}async function ld(e,t,r,n,a){return Fl(e,"PUT",t,n,a,r)}async function IT(e,t,r,n){return Fl(e,"HEAD",t,Ne(Ne({},r),{},{noResolveJson:!0}),n)}async function Oh(e,t,r,n,a){return Fl(e,"DELETE",t,n,a,r)}var DT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(lt(t))return{data:null,error:t};throw t}}};let xy;xy=Symbol.toStringTag;var LT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[xy]="BlobDownloadBuilder",this.promise=null}asStream(){return new DT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(lt(t))return{data:null,error:t};throw t}}};const MT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ex={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var BT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Rh(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var a=this;try{let s;const i=Ne(Ne({},ex),n);let o=Ne(Ne({},a.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",a.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),l&&!s.has("metadata")&&s.append("metadata",a.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(o=Ne(Ne({},o),n.headers));const u=a._removeEmptyFolders(t),f=a._getFinalPath(u),d=await(e=="PUT"?ld:un)(a.fetch,`${a.url}/object/${f}`,s,Ne({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(lt(s))return{data:null,error:s};throw s}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const s=a._removeEmptyFolders(e),i=a._getFinalPath(s),o=new URL(a.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const u=Ne({upsert:ex.upsert},n),f=Ne(Ne({},a.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType),{data:{path:s,fullPath:(await ld(a.fetch,o.toString(),l,{headers:f})).Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(lt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const a=Ne({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const s=await un(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(r.url+s.url),o=i.searchParams.get("token");if(!o)throw new qu("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await un(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}}async copy(e,t,r){var n=this;try{return{data:{path:(await un(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var n=this;try{let a=n._getFinalPath(e),s=await un(n.fetch,`${n.url}/object/sign/${a}`,Ne({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${n.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var n=this;try{const a=await un(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(i=>Ne(Ne({},i),{},{signedUrl:i.signedURL?encodeURI(`${n.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",s=this._getFinalPath(e),i=()=>al(this.fetch,`${this.url}/${r}/${s}${a}`,{headers:this.headers,noResolveJson:!0});return new LT(i,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:od(await al(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await IT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(lt(n)&&n instanceof id){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});i!==""&&n.push(i);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await Oh(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const a=Ne(Ne(Ne({},MT),t),{},{prefix:e||""});return{data:await un(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const n=Ne({},e);return{data:await un(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const gy="2.89.0",vy={"X-Client-Info":`storage-js/${gy}`};var UT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Ne(Ne({},vy),t),this.fetch=Rh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await al(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await al(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await un(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await ld(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await un(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Oh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},$T=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},vy),t),this.fetch=Rh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await un(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await al(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Oh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!AT(e))throw new qu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new bT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,s){const i=a[s];return typeof i!="function"?i:async(...o)=>{try{return{data:await i.apply(a,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}};const Ph={"X-Client-Info":`storage-js/${gy}`,"Content-Type":"application/json"};var yy=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Fr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var B0=class extends yy{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},zT=class extends yy{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Ih=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),WT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tx=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),HT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(s=>{const i=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||n+"";t(new B0(tx(s),n,i))}).catch(()=>{const s=n+"";t(new B0(a.statusText||`HTTP ${n} error`,n,s))});else{const s=n+"";t(new B0(a.statusText||`HTTP ${n} error`,n,s))}}else t(new zT(tx(e),e))},VT=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(WT(n)?(a.headers=Ne({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Ne(Ne({},a),r)):a};async function GT(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,VT(t,n,a,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>i(l)).catch(l=>HT(l,o,n))})}async function Rr(e,t,r,n,a){return GT(e,"POST",t,n,a,r)}var KT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},Ph),t),this.fetch=Ih(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Rr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Rr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}},XT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},Ph),t),this.fetch=Ih(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Rr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Rr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Rr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}},qT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},Ph),t),this.fetch=Ih(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Rr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}},YT=class extends qT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new JT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},JT=class extends KT{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new QT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},QT=class extends XT{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},ZT=class extends UT{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new BT(this.url,this.headers,e,this.fetch)}get vectors(){return new YT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new $T(this.url+"/iceberg",this.headers,this.fetch)}};const wy="2.89.0",Xs=30*1e3,cd=3,U0=cd*Xs,eN="http://localhost:9999",tN="supabase.auth.token",rN={"X-Client-Info":`gotrue-js/${wy}`},ud="X-Supabase-Api-Version",_y={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},nN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,aN=10*60*1e3;class sl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Se(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class sN extends sl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function iN(e){return Se(e)&&e.name==="AuthApiError"}class ns extends sl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class oa extends sl{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Nr extends oa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oN(e){return Se(e)&&e.name==="AuthSessionMissingError"}class Bs extends oa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lc extends oa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class cc extends oa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lN(e){return Se(e)&&e.name==="AuthImplicitGrantRedirectError"}class rx extends oa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cN extends oa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class fd extends oa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function $0(e){return Se(e)&&e.name==="AuthRetryableFetchError"}class nx extends oa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class dd extends oa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const uu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ax=` 	
\r=`.split(""),uN=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ax.length;t+=1)e[ax[t].charCodeAt(0)]=-2;for(let t=0;t<uu.length;t+=1)e[uu[t].charCodeAt(0)]=t;return e})();function sx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uu[n]),t.queuedBits-=6}}function ky(e,t,r){const n=uN[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ix(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{hN(i,n,r)};for(let i=0;i<e.length;i+=1)ky(e.charCodeAt(i),a,s);return t.join("")}function fN(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function dN(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}fN(n,t)}}function hN(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function gi(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)ky(e.charCodeAt(a),r,n);return new Uint8Array(t)}function pN(e){const t=[];return dN(e,r=>t.push(r)),new Uint8Array(t)}function ls(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>sx(a,r,n)),sx(null,r,n),t.join("")}function mN(e){return Math.round(Date.now()/1e3)+e}function xN(){return Symbol("auth-callback")}const zt=()=>typeof window<"u"&&typeof document<"u",Ya={tested:!1,writable:!1},Sy=()=>{if(!zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ya.tested)return Ya.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ya.tested=!0,Ya.writable=!0}catch{Ya.tested=!0,Ya.writable=!1}return Ya.writable};function gN(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Ey=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),vN=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",qs=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ja=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},$t=async(e,t)=>{await e.removeItem(t)};class Yu{constructor(){this.promise=new Yu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Yu.promiseConstructor=Promise;function z0(e){const t=e.split(".");if(t.length!==3)throw new dd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!nN.test(t[n]))throw new dd("JWT not in base64url format");return{header:JSON.parse(ix(t[0])),payload:JSON.parse(ix(t[1])),signature:gi(t[2]),raw:{header:t[0],payload:t[1]}}}async function yN(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function wN(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function _N(e){return("0"+e.toString(16)).substr(-2)}function kN(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,_N).join("")}async function SN(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function EN(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await SN(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Us(e,t,r=!1){const n=kN();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await qs(e,`${t}-code-verifier`,a);const s=await EN(n);return[s,n===s?"plain":"s256"]}const bN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function TN(e){const t=e.headers.get(ud);if(!t||!t.match(bN))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function NN(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function CN(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const AN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $s(e){if(!AN.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function W0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jN(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function ox(e){return JSON.parse(JSON.stringify(e))}const es=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),FN=[502,503,504];async function lx(e){var t;if(!vN(e))throw new fd(es(e),0);if(FN.includes(e.status))throw new fd(es(e),e.status);let r;try{r=await e.json()}catch(s){throw new ns(es(s),s)}let n;const a=TN(e);if(a&&a.getTime()>=_y["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new nx(es(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Nr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new nx(es(r),e.status,r.weak_password.reasons);throw new sN(es(r),e.status||500,n)}const RN=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Te(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[ud]||(s[ud]=_y["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await ON(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function ON(e,t,r,n,a,s){const i=RN(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new fd(es(l),0)}if(o.ok||await lx(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await lx(l)}}function ln(e){var t;let r=null;DN(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=mN(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function cx(e){const t=ln(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function wa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function PN(e){return{data:e,error:null}}function IN(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=Xu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function ux(e){return e}function DN(e){return e.access_token&&e.refresh_token&&e.expires_in}const H0=["global","local","others"];class LN{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Ey(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=H0[0]){if(H0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${H0.join(", ")}`);try{return await Te(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Te(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wa})}catch(n){if(Se(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Xu(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:IN,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Se(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Te(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:wa})}catch(r){if(Se(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await Te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:ux});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return x.length>0&&(x.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);u[`${p}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Se(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){$s(t);try{return await Te(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:wa})}catch(r){if(Se(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){$s(t);try{return await Te(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:wa})}catch(n){if(Se(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){$s(t);try{return await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:wa})}catch(n){if(Se(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){$s(t.userId);try{const{data:r,error:n}=await Te(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Se(r))return{data:null,error:r};throw r}}async _deleteFactor(t){$s(t.userId),$s(t.id);try{return{data:await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,s,i,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await Te(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:ux});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return x.length>0&&(x.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);u[`${p}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Se(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Te(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Se(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Te(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Se(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Te(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Se(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Te(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Te(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Se(r))return{data:null,error:r};throw r}}}function fx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const zs={debug:!!(globalThis&&Sy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class by extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class MN extends by{}async function BN(e,t,r){zs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),zs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){zs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{zs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw zs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new MN(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(zs.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function UN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ty(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function $N(e){return parseInt(e,16)}function zN(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function WN(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:u,scheme:f,uri:d,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const x=Ty(e.address),g=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",p=`${g} wants you to sign in with your Ethereum account:
${x}

${m}`;let y=`URI: ${d}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(a&&(y+=`
Expiration Time: ${a.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let w=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}y+=w}return`${p}
${y}`}class Nt extends Error{constructor({message:t,code:r,cause:n,name:a}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=a??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class fu extends Nt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function HN({error:e,options:t}){var r,n,a;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Nt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(Ny(i)){if(s.rp.id!==i)return new Nt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function VN({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Nt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Ny(n)){if(r.rpId!==n)return new Nt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class GN{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const KN=new GN;function XN(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=Xu(e,["challenge","user","excludeCredentials"]),s=gi(t).buffer,i=Object.assign(Object.assign({},r),{id:gi(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:s,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:gi(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function qN(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Xu(e,["challenge","allowCredentials"]),a=gi(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];s.allowCredentials[i]=Object.assign(Object.assign({},o),{id:gi(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function YN(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ls(new Uint8Array(e.response.attestationObject)),clientDataJSON:ls(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function JN(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ls(new Uint8Array(a.authenticatorData)),clientDataJSON:ls(new Uint8Array(a.clientDataJSON)),signature:ls(new Uint8Array(a.signature)),userHandle:a.userHandle?ls(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ny(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function dx(){var e,t;return!!(zt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function QN(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new fu("Browser returned unexpected credential type",t)}:{data:null,error:new fu("Empty credential response",t)}}catch(t){return{data:null,error:HN({error:t,options:e})}}}async function ZN(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new fu("Browser returned unexpected credential type",t)}:{data:null,error:new fu("Empty credential response",t)}}catch(t){return{data:null,error:VN({error:t,options:e})}}}const e3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},t3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function du(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const s in a){const i=a[s];if(i!==void 0)if(Array.isArray(i))n[s]=i;else if(r(i))n[s]=i;else if(t(i)){const o=n[s];t(o)?n[s]=du(o,i):n[s]=du(i)}else n[s]=i}return n}function r3(e,t){return du(e3,e,t||{})}function n3(e,t){return du(t3,e,t||{})}class a3{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},s){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const l=a??KN.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=r3(i.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:f,error:d}=await QN({publicKey:u,signal:l});return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}case"request":{const u=n3(i.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:f,error:d}=await ZN(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:l}));return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}}}catch(i){return Se(i)?{data:null,error:i}:{data:null,error:new ns("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new sl("rpId is required for WebAuthn authentication")};try{if(!dx())return{data:null,error:new ns("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:s});if(!i)return{data:null,error:o};const{webauthn:l}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(i){return Se(i)?{data:null,error:i}:{data:null,error:new ns("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new sl("rpId is required for WebAuthn registration")};try{if(!dx())return{data:null,error:new ns("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:s});return l?this._verify({factorId:i.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Se(i)?{data:null,error:i}:{data:null,error:new ns("Unexpected error in register",i)}}}}UN();const s3={url:eN,storageKey:tN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:rN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function hx(e,t,r){return await r()}const Ws={};class il{get jwks(){var t,r;return(r=(t=Ws[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ws[this.storageKey]=Object.assign(Object.assign({},Ws[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ws[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ws[this.storageKey]=Object.assign(Object.assign({},Ws[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},s3),t);if(this.storageKey=s.storageKey,this.instanceID=(r=il.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,il.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&zt()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new LN({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ey(s.fetch),this.lock=s.lock||hx,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:this.persistSession&&zt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=BN:this.lock=hx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new a3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Sy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fx(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=fx(this.memoryStorage)),zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${wy}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(zt()&&(r=gN(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),zt()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),lN(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Se(r)?this._returnResult({error:r}):this._returnResult({error:new ns("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ln}),{data:i,error:o}=s;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(Se(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let x=null,g=null;this.flowType==="pkce"&&([x,g]=await Us(this.storage,this.storageKey)),s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:x,code_challenge_method:g},xform:ln})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ln})}else throw new lc("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return await $t(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:cx})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:cx})}else throw new lc("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const s=new Bs;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Se(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,s,i,o,l,u,f,d,h;let x,g;if("message"in t)x=t.message,g=t.signature;else{const{chain:m,wallet:p,statement:y,options:w}=t;let v;if(zt())if(typeof p=="object")v=p;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")v=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=p}const _=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),k=await v.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=Ty(k[0]);let S=(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const A=await v.request({method:"eth_chainId"});S=$N(A)}const C={domain:_.host,address:E,statement:y,uri:_.href,version:"1",chainId:S,nonce:(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=w==null?void 0:w.signInWithEthereum)===null||f===void 0?void 0:f.resources};x=WN(C),g=await v.request({method:"personal_sign",params:[zN(x),E]})}try{const{data:m,error:p}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:g},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:ln});if(p)throw p;if(!m||!m.session||!m.user){const y=new Bs;return this._returnResult({data:{user:null,session:null},error:y})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:p})}catch(m){if(Se(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,a,s,i,o,l,u,f,d,h,x;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:p,wallet:y,statement:w,options:v}=t;let _;if(zt())if(typeof y=="object")_=y;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=y}const k=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let S;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")S=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)S=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)g=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),m=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(a=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=v==null?void 0:v.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((d=(f=v==null?void 0:v.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...v.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:p,error:y}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:ls(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ln});if(y)throw y;if(!p||!p.session||!p.user){const w=new Bs;return this._returnResult({data:{user:null,session:null},error:w})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:y})}catch(p){if(Se(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async _exchangeCodeForSession(t){const r=await Ja(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new cN;const{data:s,error:i}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ln});if(await $t(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!s||!s.session||!s.user){const o=new Bs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ln}),{data:l,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const f=new Bs;return this._returnResult({data:{user:null,session:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(Se(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await Us(this.storage,this.storageKey));const{error:d}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:o,options:l}=t,{data:u,error:f}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f})}throw new lc("You must provide either an email or phone number.")}catch(o){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:ln});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,u=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(Se(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,s,i;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Us(this.storage,this.storageKey));const u=await Te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:PN});return!((s=u.data)===null||s===void 0)&&s.url&&zt()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Nr;const{error:a}=await Te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Se(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new lc("You must provide either an email or phone number and a type")}catch(r){if(Se(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ja(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<U0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await Ja(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=W0()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=jN(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:wa}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nr}:await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:wa})})}catch(r){if(Se(r))return oN(r)&&(await this._removeSession(),await $t(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Nr;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Us(this.storage,this.storageKey));const{data:u,error:f}=await Te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:wa});if(f)throw f;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Nr;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=z0(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Se(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Nr;const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Se(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!zt())throw new cc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new cc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new rx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new cc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new rx("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:u}=t;if(!s||!o||!i||!u)throw new cc("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const x=h-f;x*1e3<=Xs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${d}s`);const g=h-d;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,f);const{data:m,error:p}=await this._getUser(s);if(p)throw p;const y={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(n){if(Se(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ja(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({error:s});const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(iN(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await $t(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=xN(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Us(this.storage,this.storageKey,!0));try{return await Te(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,u,f;const{data:d,error:h}=s;if(h)throw h;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Te(this.fetch,"GET",x,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return zt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Se(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:s}}=r;if(a)throw a;const{options:i,provider:o,token:l,access_token:u,nonce:f}=t,d=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:u,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:ln}),{data:h,error:x}=d;return x?this._returnResult({data:{user:null,session:null},error:x}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Bs}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:x}))}catch(a){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Se(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Te(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await wN(async a=>(a>0&&await yN(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ln})),(a,s)=>{const i=200*Math.pow(2,a);return s&&$0(s)&&Date.now()+i-n<Xs})}catch(n){if(this._debug(r,"error",n),Se(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),zt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ja(this.storage,this.storageKey);if(a&&this.userStorage){let i=await Ja(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await qs(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:W0()}else if(a&&!a.user&&!a.user){const i=await Ja(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await $t(this.storage,this.storageKey+"-user"),await qs(this.storage,this.storageKey,a)):a.user=W0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<U0;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${U0}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),$0(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Yu;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Nr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Se(s)){const i={data:null,error:s};return $0(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await $t(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await qs(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=ox(a);await qs(this.storage,this.storageKey,s)}else{const a=ox(r);await qs(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $t(this.storage,this.storageKey),await $t(this.storage,this.storageKey+"-code-verifier"),await $t(this.storage,this.storageKey+"-user"),this.userStorage&&await $t(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&zt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Xs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Xs}ms, refresh threshold is ${cd} ticks`),a<=cd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof by)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Us(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?this._returnResult({data:null,error:s}):await Te(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:u}=await Te(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&l.type==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?YN(t.webauthn.credential_response):JN(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:XN(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:qN(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(s),s.status==="verified"&&a[s.factor_type].push(s);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=z0(n.access_token);let i=null;s.aal&&(i=s.aal);let o=i;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const u=s.amr||[];return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Te(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Nr})})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Nr});const i=await Te(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&zt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(Se(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Nr});const i=await Te(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&zt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(Se(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Te(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Nr})})}catch(t){if(Se(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Te(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Nr})})}catch(r){if(Se(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+aN>a)return n;const{data:s,error:i}=await Te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:x,error:g}=await this.getSession();if(g||!x.session)return this._returnResult({data:null,error:g});n=x.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=z0(n);r!=null&&r.allowExpired||NN(s.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:s,header:a,signature:i},error:null}}const f=CN(a.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,i,pN(`${o}.${l}`)))throw new dd("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Se(n))return this._returnResult({data:null,error:n});throw n}}}il.nextInstanceID={};const i3=il,o3="2.89.0";let po="";typeof Deno<"u"?po="deno":typeof document<"u"?po="web":typeof navigator<"u"&&navigator.product==="ReactNative"?po="react-native":po="node";const l3={"X-Client-Info":`supabase-js-${po}/${o3}`},c3={headers:l3},u3={schema:"public"},f3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},d3={};function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function h3(e,t){if(ol(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ol(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p3(e){var t=h3(e,"string");return ol(t)=="symbol"?t:t+""}function m3(e,t,r){return(t=p3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function px(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?px(Object(r),!0).forEach(function(n){m3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):px(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const x3=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),g3=()=>Headers,v3=(e,t,r)=>{const n=x3(r),a=g3();return async(s,i)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let u=new a(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,pt(pt({},i),{},{headers:u}))}};function y3(e){return e.endsWith("/")?e:e+"/"}function w3(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:u,realtime:f,global:d}=t,h={db:pt(pt({},l),a),auth:pt(pt({},u),s),realtime:pt(pt({},f),i),storage:{},global:pt(pt(pt({},d),o),{},{headers:pt(pt({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function _3(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(y3(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var k3=class extends i3{constructor(e){super(e)}},S3=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const s=_3(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:u3,realtime:d3,auth:pt(pt({},f3),{},{storageKey:i}),global:c3},l=w3(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=l.global.headers)!==null&&a!==void 0?a:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=v3(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(pt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new rT(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new ZT(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new J4(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:s,flowType:i,lock:o,debug:l,throwOnError:u},f,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new k3({url:this.authUrl.href,headers:pt(pt({},h),f),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:i,lock:o,debug:l,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new yT(this.realtimeUrl.href,pt(pt({},e),{},{params:pt(pt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const E3=(e,t,r)=>new S3(e,t,r);function b3(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}b3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const T3="https://qwzdatnlfdnsxebfgjwu.supabase.co",N3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF3emRhdG5sZmRuc3hlYmZnand1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1ODg5NTksImV4cCI6MjA4MjE2NDk1OX0.Sv80mva2PThxNhdaRAHLxMdNArl7pa3Ff1ew_R-FTd4",xe=E3(T3,N3);function C3({user:e,onClose:t,onSave:r}){const[n,a]=N.useState({email:"",full_name:"",role:"user",password:"",therapist_id:"",active:!0}),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[u,f]=N.useState(null),[d,h]=N.useState([]);N.useEffect(()=>{x()},[]);async function x(){try{const{data:m,error:p}=await xe.from("therapists").select("id, name, email").eq("active",!0).order("name");if(p)throw p;h(m||[])}catch(m){console.error("Error fetching therapists:",m)}}N.useEffect(()=>{e&&a({email:e.email||"",full_name:e.full_name||"",role:e.role||"user",therapist_id:e.therapist_id||"",active:e.active!==!1,password:""})},[e]);const g=async m=>{m.preventDefault(),l(!0),f(null);try{if(e){const{error:p}=await xe.from("users").update({full_name:n.full_name,role:n.role,therapist_id:n.role==="therapist"?n.therapist_id:null,active:n.active}).eq("id",e.id);if(p)throw p}else{if(!n.password)throw new Error("La contrasea es obligatoria para nuevos usuarios");if(n.role==="therapist"&&!n.therapist_id)throw new Error("Debes seleccionar un terapeuta para asociar");const p=crypto.randomUUID(),{error:y}=await xe.from("users").insert({id:p,email:n.email,password:n.password,full_name:n.full_name,role:n.role,therapist_id:n.role==="therapist"?n.therapist_id:null,active:!0});if(y)throw y.code==="23505"?new Error("Ya existe un usuario con ese email"):y}r(),t()}catch(p){console.error("Error saving user:",p),f(p.message||"Error al guardar el usuario")}finally{l(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e?"Editar Usuario":"Nuevo Usuario"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:c.jsx(Ut,{size:20})})]}),c.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[u&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 p-4 rounded text-sm",children:[c.jsx("p",{className:"font-bold mb-2",children:" Instrucciones para crear el usuario:"}),c.jsx("pre",{className:"whitespace-pre-wrap text-xs bg-white p-2 rounded border mt-2 overflow-x-auto",children:u}),c.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(u.split(`SQL:

`)[1]||u),alert("SQL copiado al portapapeles")},className:"mt-2 text-xs bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700",children:"Copiar SQL"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo"}),c.jsx("input",{type:"text",required:!0,value:n.full_name,onChange:m=>a({...n,full_name:m.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo Electrnico"}),c.jsx("input",{type:"email",required:!0,disabled:!!e,value:n.email,onChange:m=>a({...n,email:m.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 disabled:bg-gray-100 disabled:text-gray-500"})]}),!e&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea Inicial"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:s?"text":"password",required:!0,minLength:6,value:n.password,onChange:m=>a({...n,password:m.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 pr-10"}),c.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?c.jsx(oy,{size:18}):c.jsx(Ch,{size:18})})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Mnimo 6 caracteres"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol de Acceso"}),c.jsxs("select",{value:n.role,onChange:m=>a({...n,role:m.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",children:[c.jsx("option",{value:"user",children:"Usuario Estndar"}),c.jsx("option",{value:"admin",children:"Administrador"}),c.jsx("option",{value:"therapist",children:"Terapeuta"}),c.jsx("option",{value:"reception",children:"Recepcin"})]})]}),n.role==="therapist"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asociar con Terapeuta"}),c.jsxs("select",{required:n.role==="therapist",value:n.therapist_id,onChange:m=>a({...n,therapist_id:m.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",children:[c.jsx("option",{value:"",children:"Seleccionar terapeuta..."}),d.map(m=>c.jsxs("option",{value:m.id,children:[m.name," (",m.email,")"]},m.id))]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"El usuario solo ver la agenda de este terapeuta"})]}),e&&c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"active",checked:n.active,onChange:m=>a({...n,active:m.target.checked}),className:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-900",children:"Usuario Activo"})]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"}),c.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700 disabled:opacity-50",children:[o&&c.jsx(Pn,{className:"animate-spin w-4 h-4"}),c.jsx(Ui,{size:18}),e?"Guardar Cambios":"Crear Usuario"]})]})]})]})})}function A3(){const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,s]=N.useState(""),[i,o]=N.useState(null),[l,u]=N.useState(!1),[f,d]=N.useState(null);N.useEffect(()=>{h()},[]);async function h(){try{n(!0);const{data:p,error:y}=await xe.from("users").select("*").order("created_at",{ascending:!1});if(y)throw y;t(p||[])}catch(p){console.error("Error fetching users:",p),o("Error al cargar usuarios")}finally{n(!1)}}async function x(p,y){try{const{error:w}=await xe.from("users").update({active:!y}).eq("id",p);if(w)throw w;t(e.map(v=>v.id===p?{...v,active:!y}:v))}catch(w){console.error("Error updating user status:",w),alert("Error al actualizar el estado del usuario")}}async function g(p){if(window.confirm("Ests seguro de que deseas eliminar este usuario? Esta accin eliminar sus datos del perfil, pero la cuenta de autenticacin podra permanecer."))try{const{error:y}=await xe.from("users").delete().eq("id",p);if(y)throw y;t(e.filter(w=>w.id!==p))}catch(y){console.error("Error deleting user:",y),alert("Error al eliminar el usuario")}}const m=e.filter(p=>{var y,w;return((y=p.full_name)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||((w=p.email)==null?void 0:w.toLowerCase().includes(a.toLowerCase()))});return r?c.jsx("div",{className:"flex justify-center p-8",children:c.jsx(Pn,{className:"animate-spin text-teal-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gestin de Usuarios"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Vu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),c.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:a,onChange:p=>s(p.target.value),className:"pl-9 pr-4 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]}),c.jsxs("button",{onClick:()=>{d(null),u(!0)},className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm font-medium",children:[c.jsx(In,{size:18}),"Nuevo Usuario"]})]})]}),i&&c.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg flex items-center gap-2",children:[c.jsx(Da,{size:20}),i]}),c.jsxs("div",{className:"bg-white border rounded-lg overflow-hidden",children:[c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(p=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 font-bold",children:p.full_name?p.full_name.charAt(0).toUpperCase():"?"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.full_name||"Sin nombre"}),c.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.role==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:p.role==="admin"?"Administrador":"Usuario"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.active!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.active!==!1?"Activo":"Suspendido"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>{d(p),u(!0)},className:"p-1 text-blue-600 rounded hover:bg-blue-50",title:"Editar usuario",children:c.jsx(jh,{size:18})}),c.jsx("button",{onClick:()=>x(p.id,p.active!==!1),className:`p-1 rounded hover:bg-gray-100 ${p.active!==!1?"text-orange-600":"text-green-600"}`,title:p.active!==!1?"Suspender usuario":"Activar usuario",children:p.active!==!1?c.jsx(H4,{size:18}):c.jsx(U4,{size:18})}),c.jsx("button",{onClick:()=>g(p.id),className:"p-1 text-red-600 rounded hover:bg-red-50",title:"Eliminar usuario",children:c.jsx($i,{size:18})})]})})]},p.id))})]}),m.length===0&&c.jsx("div",{className:"p-8 text-center text-gray-500",children:"No se encontraron usuarios."})]}),l&&c.jsx(C3,{user:f,onClose:()=>u(!1),onSave:()=>{h(),u(!1)}})]})}function j3({isOpen:e,onClose:t,onUpdate:r}){const[n,a]=N.useState("general"),[s,i]=N.useState(""),[o,l]=N.useState(""),[u,f]=N.useState(!1),[d,h]=N.useState(!1),[x,g]=N.useState(!0);N.useEffect(()=>{e&&m()},[e]);async function m(){try{g(!0);const{data:w,error:v}=await xe.from("settings").select("*").single();if(v&&v.code!=="PGRST116")throw v;w&&(i(w.company_name||""),l(w.logo_url||""))}catch(w){console.error("Error fetching settings:",w)}finally{g(!1)}}async function p(w){try{f(!0);const v=w.target.files[0];if(!v)return;const _=v.name.split(".").pop(),E=`${`logo-${Math.random()}.${_}`}`,{error:S}=await xe.storage.from("company-assets").upload(E,v);if(S)throw S;const{data:{publicUrl:C}}=xe.storage.from("company-assets").getPublicUrl(E);l(C)}catch(v){console.error("Error uploading logo:",v),alert("Error al subir el logo")}finally{f(!1)}}async function y(){try{h(!0);const{data:w}=await xe.from("settings").select("id").single();let v;if(w){const{error:_}=await xe.from("settings").update({company_name:s,logo_url:o}).eq("id",w.id);v=_}else{const{error:_}=await xe.from("settings").insert([{company_name:s,logo_url:o}]);v=_}if(v)throw v;r&&r(),t()}catch(w){console.error("Error saving settings:",w),alert("Error al guardar la configuracin")}finally{h(!1)}}return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:`bg-white rounded-lg w-full ${n==="users"?"max-w-4xl":"max-w-md"} transition-all duration-300`,children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Configuracin"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})})]}),c.jsxs("div",{className:"flex border-b px-6",children:[c.jsxs("button",{onClick:()=>a("general"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n==="general"?"border-teal-600 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[c.jsx(vb,{size:18}),"Empresa"]}),c.jsxs("button",{onClick:()=>a("users"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n==="users"?"border-teal-600 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[c.jsx(ji,{size:18}),"Usuarios"]})]}),c.jsx("div",{className:"p-6",children:n==="general"?c.jsx("div",{className:"space-y-6",children:x?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx(Pn,{className:"animate-spin text-teal-600"})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logotipo"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden border border-gray-200",children:o?c.jsx("img",{src:o,alt:"Logo",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-gray-400 text-xs text-center px-2",children:"Sin logo"})}),c.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[c.jsx(As,{size:18,className:"text-gray-600"}),c.jsx("span",{className:"text-sm text-gray-700",children:u?"Subiendo...":"Subir Logo"}),c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:p,disabled:u})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Empresa"}),c.jsx("input",{type:"text",value:s,onChange:w=>i(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none transition-all",placeholder:"Nombre de tu empresa"})]})]})}):c.jsx(A3,{})}),n==="general"&&c.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3 rounded-b-lg",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancelar"}),c.jsxs("button",{onClick:y,disabled:d||x,className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:[c.jsx(Ui,{size:18}),d?"Guardando...":"Guardar Cambios"]})]})]})}):null}function F3({children:e,userRole:t,userEmail:r}){const n=ia(),a=Wu(),[s,i]=N.useState(!1),o={name:"Eutymia"},u=[{path:"/",icon:t4,label:"Dashboard",roles:["admin"]},{path:"/agenda",icon:On,label:"Agenda",roles:["admin","therapist","user"]},{path:"/leads",icon:ji,label:"Leads (CRM)",roles:["admin"]},{path:"/database",icon:iy,label:"Base de Datos",roles:["admin"]},{path:"/expenses",icon:cy,label:"Gastos",roles:["admin"]},{path:"/therapists",icon:ji,label:"Terapeutas",roles:["admin"]},{path:"/workshops",icon:ny,label:"Talleres",roles:["admin"]},{path:"/reports",icon:_b,label:"Reportes",roles:["admin"]}].filter(d=>d.roles.includes(t)),f=()=>{try{localStorage.removeItem("user_session"),a("/login"),window.location.reload()}catch(d){console.error("Error logging out:",d)}};return c.jsxs("div",{className:"flex h-screen bg-gray-100",children:[c.jsxs("div",{className:"w-16 md:w-64 bg-white border-r flex flex-col",children:[c.jsx("div",{className:"p-4 md:p-6 border-b",children:c.jsxs("h1",{className:"text-xl md:text-2xl font-bold text-teal-600 flex items-center justify-center md:justify-start gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-teal-600 rounded-lg flex items-center justify-center text-white text-sm",children:o.name.charAt(0)}),c.jsx("span",{className:"hidden md:inline",children:o.name})]})}),c.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:u.map(d=>c.jsxs(Th,{to:d.path,className:`flex items-center justify-center md:justify-start px-2 md:px-4 py-3 rounded-lg text-sm font-medium transition-colors ${n.pathname===d.path?"bg-teal-50 text-teal-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[c.jsx(d.icon,{size:20}),c.jsx("span",{className:"hidden md:inline ml-3",children:d.label})]},d.path))}),c.jsxs("div",{className:"p-2 md:p-4 border-t space-y-1",children:[c.jsx("div",{className:"px-2 md:px-4 py-2 mb-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 font-bold",children:c.jsx(na,{size:16})}),c.jsxs("div",{className:"hidden md:block flex-1 min-w-0",children:[c.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",children:r}),c.jsx("p",{className:"text-xs text-gray-500 capitalize",children:t==="admin"?"Administrador":t==="therapist"?"Terapeuta":"Usuario"})]})]})}),t==="admin"&&c.jsxs("button",{onClick:()=>i(!0),className:"w-full flex items-center justify-center md:justify-start px-2 md:px-4 py-3 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[c.jsx(T4,{size:20}),c.jsx("span",{className:"hidden md:inline ml-3",children:"Configuracin"})]}),c.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center md:justify-start px-2 md:px-4 py-3 rounded-lg text-sm font-medium text-red-600 hover:bg-red-50",children:[c.jsx(s4,{size:20}),c.jsx("span",{className:"hidden md:inline ml-3",children:"Cerrar Sesin"})]})]})]}),c.jsx("div",{className:"flex-1 overflow-hidden",children:e}),c.jsx(j3,{isOpen:s,onClose:()=>i(!1),onUpdate:()=>{}})]})}function R3(e){const r=new Date-e,n=Math.floor(r/6e4),a=Math.floor(r/36e5),s=Math.floor(r/864e5);return n<1?"Hace un momento":n<60?`Hace ${n} min`:a<24?`Hace ${a} hora${a>1?"s":""}`:s<7?`Hace ${s} da${s>1?"s":""}`:e.toLocaleDateString()}function O3({reportsRefreshKey:e}){const[t,r]=N.useState({total:0,fixed:0,variable:0}),[n,a]=N.useState([]),[s,i]=N.useState(0),[o,l]=N.useState(0),[u,f]=N.useState(0),[d,h]=N.useState(0),[x,g]=N.useState([]),[m,p]=N.useState([]),[y,w]=N.useState(!0);N.useEffect(()=>{v()},[e]);async function v(){try{await Promise.all([k(),_(),E(),S(),C(),A(),U(),H()])}catch(b){console.error("Error fetching dashboard data:",b)}finally{w(!1)}}async function _(){try{const{data:b,error:V}=await xe.from("appointments").select("branch");if(V)throw V;const J={};let W=0;b.forEach(ee=>{ee.branch&&(J[ee.branch]=(J[ee.branch]||0)+1,W++)});const Z=Object.keys(J).map(ee=>({branch:ee,count:J[ee],percentage:W>0?Math.round(J[ee]/W*100):0})).sort((ee,G)=>G.count-ee.count);a(Z)}catch(b){console.error("Error fetching branch stats:",b)}}async function k(){try{const{data:b,error:V}=await xe.from("expenses").select("amount, type");if(V)throw V;const J=b.reduce((W,Z)=>{const ee=parseFloat(Z.amount)||0;return W.total+=ee,Z.type==="fixed"&&(W.fixed+=ee),Z.type==="variable"&&(W.variable+=ee),W},{total:0,fixed:0,variable:0});r(J)}catch(b){console.error("Error fetching expenses:",b)}}async function E(){try{const b=new Date().toISOString().split("T")[0],{data:V,error:J}=await xe.from("appointments").select("id").eq("date",b).neq("status","cancelada");if(J)throw J;i((V==null?void 0:V.length)||0)}catch(b){console.error("Error fetching today appointments:",b)}}async function S(){try{const{data:b,error:V}=await xe.from("leads").select("id").not("status","in","(lost,closed)");if(V)throw V;l((b==null?void 0:b.length)||0)}catch(b){console.error("Error fetching active patients:",b)}}async function C(){try{const b=new Date,V=new Date(b.getFullYear(),b.getMonth(),1).toISOString().split("T")[0],J=new Date(b.getFullYear(),b.getMonth()+1,0).toISOString().split("T")[0],{data:W,error:Z}=await xe.from("appointments").select("price").gte("date",V).lte("date",J).eq("payment_status","paid");if(Z)throw Z;const ee=W.reduce((G,B)=>G+(parseFloat(B.price)||0),0);f(ee)}catch(b){console.error("Error fetching monthly income:",b)}}async function A(){try{const b=new Date,V=new Date(b.getFullYear(),b.getMonth(),1).toISOString().split("T")[0],J=new Date(b.getFullYear(),b.getMonth()+1,0).toISOString().split("T")[0],W=new Date(b.getFullYear(),b.getMonth()-1,1).toISOString().split("T")[0],Z=new Date(b.getFullYear(),b.getMonth(),0).toISOString().split("T")[0],[ee,G]=await Promise.all([xe.from("appointments").select("price").gte("date",V).lte("date",J).eq("payment_status","paid"),xe.from("appointments").select("price").gte("date",W).lte("date",Z).eq("payment_status","paid")]);if(ee.error||G.error)throw ee.error||G.error;const B=ee.data.reduce((R,z)=>R+(parseFloat(z.price)||0),0),ae=G.data.reduce((R,z)=>R+(parseFloat(z.price)||0),0),de=ae>0?(B-ae)/ae*100:0;h(Math.round(de))}catch(b){console.error("Error fetching growth:",b)}}async function U(){try{const b=new Date,V=b.toISOString().split("T")[0],J=b.toTimeString().split(" ")[0],{data:W,error:Z}=await xe.from("appointments").select("id, patient_name, service, time, status, date").gte("date",V).neq("status","cancelada").order("date",{ascending:!0}).order("time",{ascending:!0}).limit(3);if(Z)throw Z;const ee=W.filter(G=>G.date===V?G.time>=J:!0);g(ee.slice(0,3))}catch(b){console.error("Error fetching upcoming appointments:",b)}}async function H(){try{const[b,V]=await Promise.all([xe.from("leads").select("name, created_at").order("created_at",{ascending:!1}).limit(3),xe.from("appointments").select("price, payment_date, patient_name").eq("payment_status","paid").not("payment_date","is",null).order("payment_date",{ascending:!1}).limit(3)]);if(b.error||V.error)throw b.error||V.error;const J=[...b.data.map(W=>({type:"lead",name:W.name,date:new Date(W.created_at)})),...V.data.map(W=>({type:"payment",amount:W.price,name:W.patient_name,date:new Date(W.payment_date)}))].sort((W,Z)=>Z.date-W.date).slice(0,5);p(J)}catch(b){console.error("Error fetching recent activity:",b)}}return c.jsxs("div",{className:"p-6 overflow-y-auto h-full",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Dashboard General"}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Resumen de Gastos"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Total Gastos"}),c.jsxs("h3",{className:"text-2xl font-bold text-red-600 mt-1",children:["$",t.total.toLocaleString()]})]}),c.jsx("div",{className:"p-3 bg-red-50 rounded-full text-red-600",children:c.jsx(cy,{size:24})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-orange-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Gastos Fijos"}),c.jsxs("h3",{className:"text-2xl font-bold text-orange-600 mt-1",children:["$",t.fixed.toLocaleString()]})]}),c.jsx("div",{className:"p-3 bg-orange-50 rounded-full text-orange-600",children:c.jsx(cb,{size:24})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-yellow-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Gastos Variables"}),c.jsxs("h3",{className:"text-2xl font-bold text-yellow-600 mt-1",children:["$",t.variable.toLocaleString()]})]}),c.jsx("div",{className:"p-3 bg-yellow-50 rounded-full text-yellow-600",children:c.jsx(cu,{size:24})})]})})]})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Ocupacin por Sucursal"}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:n.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map(b=>c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ly,{size:18,className:"text-teal-600"}),c.jsx("span",{className:"font-medium text-gray-700",children:b.branch})]}),c.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[b.percentage,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:c.jsx("div",{className:"bg-teal-600 h-2.5 rounded-full",style:{width:`${b.percentage}%`}})}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[b.count," citas"]})]},b.branch))}):c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay datos de sucursales disponibles an."})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Citas Hoy"}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-1",children:y?"...":s})]}),c.jsx("div",{className:"p-3 bg-teal-50 rounded-full text-teal-600",children:c.jsx(On,{size:24})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Pacientes Activos"}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-1",children:y?"...":o})]}),c.jsx("div",{className:"p-3 bg-teal-50 rounded-full text-teal-600",children:c.jsx(ji,{size:24})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Ingresos Mes"}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-1",children:y?"...":`$${u.toLocaleString()}`})]}),c.jsx("div",{className:"p-3 bg-teal-50 rounded-full text-teal-600",children:c.jsx(Ha,{size:24})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500 uppercase font-medium",children:"Crecimiento"}),c.jsx("h3",{className:`text-2xl font-bold mt-1 ${d>=0?"text-green-600":"text-red-600"}`,children:y?"...":`${d>=0?"+":""}${d}%`})]}),c.jsx("div",{className:`p-3 rounded-full ${d>=0?"bg-teal-50 text-teal-600":"bg-red-50 text-red-600"}`,children:c.jsx(cu,{size:24})})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Prximas Citas"}),c.jsx("div",{className:"space-y-4",children:y?c.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cargando..."}):x.length>0?x.map(b=>{const V=b.patient_name.split(" ").map(Z=>Z[0]).join("").toUpperCase().slice(0,2),J={confirmada:"bg-teal-100 text-teal-700",pendiente:"bg-yellow-100 text-yellow-700",completada:"bg-green-100 text-green-700"},W={confirmada:"Confirmada",pendiente:"Pendiente",completada:"Completada"};return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-bold",children:V}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:b.patient_name}),c.jsxs("p",{className:"text-xs text-gray-500",children:[b.service,"  ",b.time.slice(0,5)]})]})]}),c.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${J[b.status]||"bg-gray-100 text-gray-700"}`,children:W[b.status]||b.status})]},b.id)}):c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay citas prximas"})})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Actividad Reciente"}),c.jsx("div",{className:"space-y-4",children:y?c.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cargando..."}):m.length>0?m.map((b,V)=>{const J=R3(b.date);return c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:`w-2 h-2 mt-2 rounded-full ${b.type==="lead"?"bg-teal-500":"bg-green-500"}`}),c.jsxs("div",{children:[b.type==="lead"?c.jsxs("p",{className:"text-sm text-gray-800",children:["Nuevo lead registrado: ",c.jsx("span",{className:"font-medium",children:b.name})]}):c.jsxs("p",{className:"text-sm text-gray-800",children:["Pago recibido: ",c.jsxs("span",{className:"font-medium",children:["$",parseFloat(b.amount).toLocaleString()]})]}),c.jsx("p",{className:"text-xs text-gray-500",children:J})]})]},V)}):c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay actividad reciente"})})]})]})]})}function P3({isOpen:e,onClose:t,initialDetails:r,onSave:n,therapists:a,userRole:s,therapistId:i}){const[o,l]=N.useState({patient_name:"",patient_phone:"",patient_email:"",date:"",time:"",therapist_id:"",service:"",branch:"",notes:""}),[u,f]=N.useState(!1),[d,h]=N.useState(null),x=["Sesin individual presencial","Sesin individual en lnea","Sesin pareja presencial","Sesin pareja en lnea","Sesin familiar presencial","Sesin familiar en lnea","Sesin a domicilio"],g=["Roma Norte","Qro Centro","Qro. Hospital","En linea"],[m,p]=N.useState(0),[y,w]=N.useState([]),[v,_]=N.useState(!1),[k,E]=N.useState(!1),[S,C]=N.useState(!1),[A,U]=N.useState({firstName:"",lastName:""}),H=async W=>{if(S){w([]),_(!1);return}E(!0);try{let Z=xe.from("leads").select("id, full_name, phone, email").limit(10);W&&W.length>0&&(Z=Z.ilike("full_name",`%${W}%`));const{data:ee,error:G}=await Z;G&&console.error("Error fetching leads:",G);let B=xe.from("appointments").select("patient_name, patient_phone, patient_email").limit(10);W&&W.length>0&&(B=B.ilike("patient_name",`%${W}%`));const{data:ae,error:de}=await B;de&&console.error("Error fetching appointments:",de);const R=[];if(ee&&ee.forEach(z=>{R.push({id:z.id,name:z.full_name,phone:z.phone,email:z.email,type:"Lead"})}),ae){const z=new Map;ae.forEach(O=>{O.patient_name&&!z.has(O.patient_name)&&z.set(O.patient_name,{id:O.patient_name,name:O.patient_name,phone:O.patient_phone,email:O.patient_email,type:"Paciente"})}),z.forEach(O=>R.push(O))}w(R),_(!0)}catch(Z){console.error("Error searching:",Z)}finally{E(!1)}};N.useEffect(()=>{const W=setTimeout(()=>{H(o.patient_name)},500);return()=>clearTimeout(W)},[o.patient_name,S]);const b=W=>{l(Z=>({...Z,patient_name:W.name,patient_phone:W.phone||"",patient_email:W.email||""})),_(!1)};N.useEffect(()=>{const Z=setTimeout(async()=>{if(!o.patient_name){p(0);return}try{const{count:ee,error:G}=await xe.from("appointments").select("*",{count:"exact",head:!0}).eq("patient_name",o.patient_name);G||p(ee||0)}catch(ee){console.error("Error fetching session count:",ee)}},500);return()=>clearTimeout(Z)},[o.patient_name]),N.useEffect(()=>{if(e&&(console.log(" Terapeutas disponibles:",a.length,a),console.log(" User Role:",s,"Therapist ID:",i)),e&&r){const Z=(r.date?new Date(r.date):new Date).toISOString().split("T")[0],ee=r.time||"09:00",G=s==="therapist"&&i?i:r.therapistId||(a.length>0?a[0].id:"");l(B=>({...B,date:Z,time:ee,therapist_id:G}))}else if(e){const Z=new Date().toISOString().split("T")[0],ee=s==="therapist"&&i?i:a.length>0?a[0].id:"";l({patient_name:"",patient_phone:"",patient_email:"",date:Z,time:"09:00",therapist_id:ee,service:"",branch:"",notes:""})}h(null)},[e,r,a,s,i]);const V=W=>{const{name:Z,value:ee}=W.target;l(G=>({...G,[Z]:ee}))},J=async W=>{if(W.preventDefault(),f(!0),h(null),!o.therapist_id){h("Por favor selecciona un terapeuta."),f(!1);return}try{if(S){if(!A.firstName||!A.lastName)throw new Error("Por favor ingresa el nombre y apellido del nuevo paciente.");o.patient_name=`${A.firstName} ${A.lastName}`;try{await xe.from("leads").insert([{full_name:o.patient_name,phone:o.patient_phone,email:o.patient_email,status:"scheduled",service:o.service,notes:"Creado desde agenda"}])}catch(O){console.warn("No se pudo crear el lead, pero la cita se guardar:",O)}}const[Z,ee]=o.time.split(":"),G=new Date(o.date);G.setHours(parseInt(Z),parseInt(ee),0,0);const B=new Date(G.getTime()+60*60*1e3),ae=`${String(B.getHours()).padStart(2,"0")}:${String(B.getMinutes()).padStart(2,"0")}`,de={...o,end_time:ae,status:o.status||"pendiente"},{data:R,error:z}=await xe.from("appointments").insert([de]).select();if(z)throw z;n(),t()}catch(Z){console.error("Error saving appointment:",Z),h("Error al guardar la cita. Intntalo de nuevo: "+(Z.message||"Error desconocido"))}finally{f(!1)}};return e?c.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[c.jsxs("div",{className:"flex justify-between items-center border-b pb-3 mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nueva Cita"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:c.jsx(Ut,{size:20})})]}),c.jsxs("form",{onSubmit:J,className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("input",{id:"is_new_patient",type:"checkbox",checked:S,onChange:W=>{C(W.target.checked),W.target.checked&&l(Z=>({...Z,patient_name:""}))},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"is_new_patient",className:"ml-2 block text-sm text-gray-900",children:"Paciente Nuevo (Registrar en base de datos)"})]}),S?c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"Nombre(s)"}),c.jsx("input",{type:"text",id:"firstName",value:A.firstName,onChange:W=>U(Z=>({...Z,firstName:W.target.value})),className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Apellidos"}),c.jsx("input",{type:"text",id:"lastName",value:A.lastName,onChange:W=>U(Z=>({...Z,lastName:W.target.value})),className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0})]})]}):c.jsxs("div",{children:[c.jsx("label",{htmlFor:"patient_name",className:"block text-sm font-medium text-gray-700",children:"Nombre del Paciente"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(na,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"text",name:"patient_name",id:"patient_name",value:o.patient_name,onChange:V,onFocus:()=>{y.length>0?_(!0):H(o.patient_name)},onBlur:()=>{setTimeout(()=>_(!1),200)},className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Buscar por nombre...",required:!0,autoComplete:"off"}),v&&c.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg max-h-60 rounded-b-md py-0 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:[c.jsx("div",{className:"cursor-pointer select-none relative py-3 pl-3 pr-9 hover:bg-gray-100 border-b border-gray-100 bg-gray-50",onClick:()=>{C(!0),l(W=>({...W,patient_name:""})),_(!1)},children:c.jsxs("div",{className:"flex items-center justify-center text-gray-700",children:[c.jsx(In,{size:14,className:"mr-1"}),c.jsx("span",{className:"text-sm underline",children:"Crear como nuevo paciente"})]})}),y.map((W,Z)=>c.jsx("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-indigo-50 bg-white border-b border-gray-50 last:border-0",onClick:()=>b(W),children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"font-medium text-gray-900 text-sm",children:W.name}),c.jsxs("span",{className:"text-xs text-gray-500 mt-0.5",children:[W.email||"Sin email"," |"," ",W.phone||"Sin telfono"]})]})},`${W.type}-${W.id}-${Z}`))]})]}),o.patient_name&&c.jsxs("p",{className:"mt-1 text-xs text-indigo-600 font-medium",children:["Sesiones anteriores: ",m," (Esta ser la #",m+1,")"]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"patient_phone",className:"block text-sm font-medium text-gray-700",children:"Telfono"}),c.jsx("input",{type:"tel",name:"patient_phone",id:"patient_phone",value:o.patient_phone,onChange:V,className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"55 1234 5678"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"patient_email",className:"block text-sm font-medium text-gray-700",children:"Email"}),c.jsx("input",{type:"email",name:"patient_email",id:"patient_email",value:o.patient_email,onChange:V,className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"correo@ejemplo.com"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700",children:"Fecha"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(On,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"date",name:"date",id:"date",value:o.date,onChange:V,className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700",children:"Hora"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(tl,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"time",name:"time",id:"time",value:o.time,onChange:V,className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",required:!0})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"therapist_id",className:"block text-sm font-medium text-gray-700",children:"Terapeuta"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(na,{className:"h-5 w-5 text-gray-400"})}),c.jsxs("select",{name:"therapist_id",id:"therapist_id",value:o.therapist_id,onChange:V,disabled:s==="therapist",className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-700",required:!0,children:[c.jsx("option",{value:"",children:a.length===0?" No hay terapeutas disponibles":"Selecciona un terapeuta"}),a.map(W=>c.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.length===0&&c.jsx("p",{className:"mt-1 text-xs text-red-600",children:" No hay terapeutas en la base de datos. Por favor, agrega terapeutas primero."}),s==="therapist"&&c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Las citas se crean automticamente para tu agenda"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"service",className:"block text-sm font-medium text-gray-700",children:"Servicio"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Ku,{className:"h-5 w-5 text-gray-400"})}),c.jsxs("select",{name:"service",id:"service",value:o.service,onChange:V,className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",required:!0,children:[c.jsx("option",{value:"",children:"Selecciona un servicio"}),x.map(W=>c.jsx("option",{value:W,children:W},W))]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"branch",className:"block text-sm font-medium text-gray-700",children:"Sucursal"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(ly,{className:"h-5 w-5 text-gray-400"})}),c.jsxs("select",{name:"branch",id:"branch",value:o.branch,onChange:V,className:"focus:ring-teal-500 focus:border-teal-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",required:!0,children:[c.jsx("option",{value:"",children:"Selecciona una sucursal"}),g.map(W=>c.jsx("option",{value:W,children:W},W))]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notas"}),c.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Al,{className:"h-5 w-5 text-gray-400"})}),c.jsx("textarea",{name:"notes",id:"notes",rows:"3",value:o.notes,onChange:V,className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Notas adicionales sobre la cita"})]})]}),d&&c.jsx("p",{className:"text-red-500 text-sm",children:d}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancelar"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50",disabled:u,children:u?"Guardando...":"Guardar Cita"})]})]})]})}):null}function I3({isOpen:e,onClose:t,onSave:r,initialDetails:n}){const[a,s]=N.useState(""),[i,o]=N.useState(""),[l,u]=N.useState(""),[f,d]=N.useState(!1),[h,x]=N.useState(null);N.useEffect(()=>{if(e){if(n!=null&&n.id)s(n.reason||""),o(g(new Date(n.startDate))),u(g(new Date(n.endDate)));else{let w=new Date;if(n.date&&(w=new Date(n.date),n.time)){const[_,k]=n.time.split(":");w.setHours(parseInt(_),parseInt(k))}const v=new Date(w);v.setHours(v.getHours()+1),o(g(w)),u(g(v)),s("")}x(null)}},[e,n]);const g=y=>{const w=new Date(y),v=_=>_.toString().padStart(2,"0");return`${w.getFullYear()}-${v(w.getMonth()+1)}-${v(w.getDate())}T${v(w.getHours())}:${v(w.getMinutes())}`},m=async y=>{y.preventDefault(),d(!0),x(null);try{if(!a.trim())throw new Error("Por favor ingresa un motivo para el bloqueo.");if(!i)throw new Error("La fecha de inicio es requerida.");if(!l)throw new Error("La fecha de fin es requerida.");if(new Date(i)>=new Date(l))throw new Error("La fecha de fin debe ser posterior a la fecha de inicio.");const w=new Date(i),v=new Date(l),_={therapist_id:(n==null?void 0:n.therapistId)||null,patient_name:"BLOQUEO",service:"Bloqueo de Agenda",date:w.toISOString().split("T")[0],time:w.toTimeString().split(" ")[0].substring(0,5),start_time:w.toISOString(),end_date:v.toISOString().split("T")[0],end_time:v.toISOString(),status:"blocked",notes:a,payment_status:"na"};let k;if(n!=null&&n.id){const{error:E}=await xe.from("appointments").update(_).eq("id",n.id);k=E}else{const{error:E}=await xe.from("appointments").insert([_]);k=E}if(k)throw k;r(),t()}catch(w){console.error("Error blocking schedule:",w),x(w.message)}finally{d(!1)}};if(!e)return null;const p=n==null?void 0:n.id;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[c.jsx(Ah,{size:20,className:"text-red-500"}),p?"Modificar Bloqueo":"Bloquear Horario"]}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:20})})]}),c.jsxs("form",{onSubmit:m,className:"p-4 space-y-4",children:[h&&c.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:h}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo del bloqueo"}),c.jsx("textarea",{value:a,onChange:y=>s(y.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500",rows:"3",placeholder:"Ej: Vacaciones, Asuntos personales, Mantenimiento...",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha y Hora de Inicio"}),c.jsx("div",{className:"relative",children:c.jsx("input",{type:"datetime-local",value:i,onChange:y=>o(y.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500",required:!0})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha y Hora de Fin"}),c.jsx("div",{className:"relative",children:c.jsx("input",{type:"datetime-local",value:l,onChange:y=>u(y.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500",required:!0})})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"button",onClick:()=>{const y=new Date(i);y.setHours(8,0,0,0);const w=new Date(i);w.setHours(19,0,0,0),o(g(y)),u(g(w))},className:"text-xs text-teal-600 hover:text-teal-800 underline",children:"Usar horario laboral (8:00 AM - 7:00 PM)"})}),c.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-4",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancelar"}),c.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50 flex items-center gap-2",children:f?"Guardando...":p?"Guardar Cambios":"Bloquear Horario"})]})]})]})})}function D3({isOpen:e,onClose:t,appointmentId:r,onProofUploaded:n}){const[a,s]=N.useState(null),[i,o]=N.useState(null),[l,u]=N.useState(!1),[f,d]=N.useState(null);if(!e)return null;const h=g=>{const m=g.target.files[0];if(d(null),!!m){if(!m.type.match("image/jpeg")&&!m.type.match("image/png")){d("Solo se permiten archivos JPG o PNG.");return}if(m.size>5*1024*1024){d("El archivo no debe superar los 5MB.");return}s(m),o(URL.createObjectURL(m))}},x=async()=>{if(!a||!r){d("Por favor selecciona un comprobante.");return}u(!0),d(null);try{const g=a.name.split(".").pop(),p=`${`${r}_${Date.now()}.${g}`}`,{error:y}=await xe.storage.from("payment-proofs").upload(p,a);if(y)throw y;const{data:{publicUrl:w}}=xe.storage.from("payment-proofs").getPublicUrl(p),{error:v}=await xe.from("appointments").update({payment_status:"paid",payment_proof_url:w,payment_date:new Date().toISOString()}).eq("id",r);if(v)throw v;n&&n(),t()}catch(g){console.error("Error uploading proof:",g),d("Error al subir el comprobante. Intntalo de nuevo.")}finally{u(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 relative animate-in fade-in zoom-in duration-200",children:[c.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:c.jsx(Ut,{size:20})}),c.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[c.jsx(As,{className:"text-teal-600",size:24}),"Registrar Pago"]}),c.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Para marcar esta cita como pagada, es ",c.jsx("strong",{children:"obligatorio"})," subir el comprobante de pago (JPG o PNG)."]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${a?"border-teal-200 bg-teal-50":"border-gray-300 hover:border-teal-400"}`,children:[c.jsx("input",{type:"file",accept:"image/jpeg, image/png",onChange:h,className:"hidden",id:"proof-upload"}),i?c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:i,alt:"Vista previa",className:"max-h-48 mx-auto rounded shadow-sm"}),c.jsx("label",{htmlFor:"proof-upload",className:"absolute bottom-2 right-2 bg-white text-gray-700 px-3 py-1 rounded-full text-xs font-medium shadow cursor-pointer hover:bg-gray-50",children:"Cambiar"})]}):c.jsxs("label",{htmlFor:"proof-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:[c.jsx("div",{className:"p-3 bg-teal-100 text-teal-600 rounded-full",children:c.jsx(Al,{size:24})}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Haz clic para subir comprobante"}),c.jsx("span",{className:"text-xs text-gray-500",children:"JPG o PNG (Mx. 5MB)"})]})]}),f&&c.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm bg-red-50 p-3 rounded",children:[c.jsx(Da,{size:16}),f]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-md text-sm font-medium",disabled:l,children:"Cancelar"}),c.jsx("button",{onClick:x,disabled:!a||l,className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium text-white transition-colors ${!a||l?"bg-gray-400 cursor-not-allowed":"bg-teal-600 hover:bg-teal-700"}`,children:l?c.jsxs(c.Fragment,{children:[c.jsx(Pn,{size:16,className:"animate-spin"}),"Subiendo..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Nh,{size:16}),"Confirmar Pago"]})})]})]})]})})}function L3({currentDate:e,onDateChange:t,therapists:r,selectedTherapists:n,onToggleTherapist:a,canViewAllTherapists:s=!0}){const i=m=>{const p=m.getFullYear(),y=m.getMonth(),w=new Date(p,y+1,0).getDate(),v=new Date(p,y,1).getDay();return{days:w,firstDay:v}},{days:o,firstDay:l}=i(e),u=Array.from({length:o},(m,p)=>p+1),f=Array.from({length:l},(m,p)=>p),d=()=>{const m=new Date(e);m.setMonth(m.getMonth()-1),t(m)},h=()=>{const m=new Date(e);m.setMonth(m.getMonth()+1),t(m)},x=m=>{const p=new Date;return m===p.getDate()&&e.getMonth()===p.getMonth()&&e.getFullYear()===p.getFullYear()},g=m=>m===e.getDate();return c.jsxs("div",{className:"w-64 bg-white border-r flex-shrink-0 flex flex-col h-full hidden md:flex",children:[c.jsxs("div",{className:"p-4 border-b",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("span",{className:"font-semibold text-gray-800 capitalize",children:e.toLocaleString("es-ES",{month:"long",year:"numeric"})}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:d,className:"p-1 hover:bg-gray-100 rounded-full",children:c.jsx(ay,{size:16})}),c.jsx("button",{onClick:h,className:"p-1 hover:bg-gray-100 rounded-full",children:c.jsx(sy,{size:16})})]})]}),c.jsxs("div",{className:"grid grid-cols-7 text-center text-xs mb-2 text-gray-500",children:[c.jsx("div",{children:"D"}),c.jsx("div",{children:"L"}),c.jsx("div",{children:"M"}),c.jsx("div",{children:"M"}),c.jsx("div",{children:"J"}),c.jsx("div",{children:"V"}),c.jsx("div",{children:"S"})]}),c.jsxs("div",{className:"grid grid-cols-7 text-center text-sm gap-y-2",children:[f.map(m=>c.jsx("div",{},`empty-${m}`)),u.map(m=>c.jsx("button",{onClick:()=>{const p=new Date(e);p.setDate(m),t(p)},className:`w-7 h-7 rounded-full flex items-center justify-center mx-auto transition-colors
                ${g(m)?"bg-gray-900 text-white":"hover:bg-gray-100 text-gray-700"}
                ${x(m)&&!g(m)?"text-teal-600 font-bold":""}
              `,children:m},m))]})]}),c.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:s&&c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:["Profesionales (",n.length,")"]}),c.jsx("div",{className:"space-y-2",children:r.map(m=>c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[c.jsx("div",{className:`w-4 h-4 border rounded flex items-center justify-center transition-colors ${n.includes(m.id)?"bg-teal-600 border-teal-600":"border-gray-300 bg-white"}`,children:n.includes(m.id)&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-sm text-gray-700 group-hover:text-gray-900",children:m.name}),c.jsx("input",{type:"checkbox",className:"hidden",checked:n.includes(m.id),onChange:()=>a(m.id)})]},m.id))})]})})]})}function M3({currentDate:e,onPrev:t,onNext:r,onToday:n,onRefresh:a,onNewAppointment:s,view:i,setView:o,selectedTherapistName:l}){const u=f=>f.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return c.jsxs("div",{className:"px-6 py-4 border-b bg-white flex flex-col sm:flex-row items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm font-medium rounded-md transition-colors",children:"Hoy"}),c.jsxs("div",{className:"flex items-center bg-white border rounded-md shadow-sm",children:[c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-50 text-gray-600 border-r",children:c.jsx(ay,{size:20})}),c.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-50 text-gray-600",children:c.jsx(sy,{size:20})})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 capitalize leading-tight",children:u(e)}),l&&c.jsx("div",{className:"mt-1 px-3 py-1 bg-teal-50 border border-teal-100 rounded-md inline-block",children:c.jsxs("p",{className:"text-base font-bold text-teal-700 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-teal-500"}),l]})}),c.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-xs mt-1",children:[c.jsx(qb,{size:12}),c.jsx("span",{children:"Eutymia"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto justify-end",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-xs mr-2 hidden lg:flex",children:[c.jsx("div",{className:"w-4 h-4 rounded-full border flex items-center justify-center",children:"?"}),c.jsx("span",{children:"Actualizado hace 0 min"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:a,className:"p-2 border rounded-md text-gray-600 hover:bg-gray-50",title:"Actualizar",children:c.jsx(w4,{size:18})}),c.jsx("button",{onClick:()=>o(i==="day"?"week":"day"),className:`p-2 border rounded-md text-gray-600 hover:bg-gray-50 ${i==="week"?"bg-gray-100":""}`,title:"Cambiar Vista",children:c.jsx(d4,{size:18})}),c.jsx("button",{className:"p-2 border rounded-md text-gray-600 hover:bg-gray-50 hidden sm:block",title:"Pantalla Completa",children:c.jsx(c4,{size:18})})]}),c.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-2 px-4 py-2 bg-[#7A42D6] hover:bg-[#6938b8] text-white rounded-md font-medium shadow-sm transition-colors",children:[c.jsx("span",{children:"Nuevo"}),c.jsx(In,{size:18})]})]})]})}function B3({date:e,view:t,appointments:r,therapists:n,selectedTherapists:a,onTimeClick:s,onAppointmentClick:i,onDrop:o}){const l=Array.from({length:15},(x,g)=>g+8),u=n.filter(x=>a.includes(x.id)),f=x=>x.split(" ").map(g=>g[0]).slice(0,2).join("").toUpperCase(),d=x=>{const g=new Date;return x.getDate()===g.getDate()&&x.getMonth()===g.getMonth()&&x.getFullYear()===g.getFullYear()},h=x=>{switch(x){case"blocked":return"bg-gray-200 text-gray-600 border-l-4 border-gray-400";case"confirmada":return"bg-yellow-100 text-yellow-800 border-l-4 border-yellow-400";case"asiste":return"bg-[#FFB6F0] text-pink-900 border-l-4 border-pink-500";case"no_asistio":return"bg-orange-100 text-orange-800 border-l-4 border-orange-400";case"cancelado":return"bg-red-100 text-red-800 border-l-4 border-red-400";case"pagado":return"bg-green-100 text-green-800 border-l-4 border-green-400";default:return"bg-blue-100 text-blue-800 border-l-4 border-blue-400"}};if(t==="day")return u.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Selecciona al menos un profesional para ver su agenda."}):c.jsxs("div",{className:"flex flex-col h-full overflow-hidden bg-white",children:[c.jsxs("div",{className:"flex border-b sticky top-0 bg-white z-20 shadow-sm overflow-x-auto",children:[c.jsx("div",{className:"w-16 flex-shrink-0 border-r bg-white"})," ",c.jsx("div",{className:"flex flex-grow",children:u.map(x=>c.jsxs("div",{className:"flex-1 min-w-[200px] p-3 border-r flex flex-col items-center justify-center bg-gray-50",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold text-sm mb-1 shadow-sm",children:f(x.name)}),c.jsx("span",{className:"text-sm font-semibold text-gray-700 truncate w-full text-center",children:x.name})]},x.id))})]}),c.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-auto",children:l.map(x=>c.jsxs("div",{className:"flex min-h-[80px]",children:[c.jsx("div",{className:"w-16 flex-shrink-0 border-r border-b bg-white flex items-start justify-center pt-2",children:c.jsxs("span",{className:"text-xs font-medium text-gray-500",children:[String(x).padStart(2,"0"),":00"]})}),u.map(g=>{const m=r.filter(p=>{if(!p.date||!p.time)return!1;const y=new Date(p.date+"T00:00:00"),w=y.getDate()===e.getDate()&&y.getMonth()===e.getMonth()&&y.getFullYear()===e.getFullYear(),v=parseInt(p.time.split(":")[0],10);return w&&v===x&&p.therapist_id===g.id});return c.jsxs("div",{className:"flex-1 min-w-[200px] border-r border-b relative hover:bg-gray-50 transition-colors",onClick:p=>s(p,`${String(x).padStart(2,"0")}:00`,g.id,e),onDragOver:p=>p.preventDefault(),onDrop:p=>{p.preventDefault();const y=p.dataTransfer.getData("appointmentId");if(y){const w=new Date(e);w.setHours(x,0,0,0),o(y,w,g.id)}},children:[c.jsx("div",{className:"absolute top-1/2 left-0 right-0 border-t border-gray-100 border-dashed pointer-events-none"}),m.map(p=>{let y=0,w="100%";if(p.start_time&&p.end_time){const _=new Date(p.start_time),k=new Date(p.end_time),E=_.getMinutes(),S=(k-_)/(1e3*60);y=`${E/60*100}%`,w=`${S/60*100}%`}const v=p.status==="blocked";return c.jsx("div",{draggable:!v,onDragStart:_=>_.dataTransfer.setData("appointmentId",p.id),onClick:_=>i(_,p),className:`absolute left-1 right-1 rounded px-2 py-1 text-xs shadow-sm cursor-pointer overflow-hidden hover:opacity-90 z-10 ${h(p.status)}`,style:{top:y,height:w,minHeight:"30px"},children:v?c.jsxs("div",{className:"flex flex-col justify-center h-full",children:[c.jsx("span",{className:"font-medium",children:"Profesional no disponible"}),c.jsxs("span",{className:"opacity-75",children:[p.time," - ",p.end_time?p.end_time.substring(0,5):""]})]}):c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsx("span",{className:"font-bold text-gray-900 truncate",children:p.patient_name}),c.jsx("span",{className:"truncate opacity-90",children:p.service||"Consulta General"}),(p.payment_status==="paid"||p.payment_status==="pagado")&&c.jsx(Ha,{size:12,className:"absolute top-1 right-1 text-green-700"})]})},p.id)})]},`${g.id}-${x}`)})]},x))})]});if(t==="week"){const x=new Date(e),g=x.getDay(),m=x.getDate()-g+(g===0?-6:1);x.setDate(m);const p=Array.from({length:7},(y,w)=>{const v=new Date(x);return v.setDate(v.getDate()+w),v});return c.jsxs("div",{className:"flex flex-col h-full overflow-hidden bg-white",children:[c.jsxs("div",{className:"flex border-b sticky top-0 bg-white z-20 shadow-sm",children:[c.jsx("div",{className:"w-16 flex-shrink-0 border-r bg-white"}),p.map(y=>c.jsxs("div",{className:`flex-1 min-w-[120px] p-2 border-r text-center ${d(y)?"bg-teal-50":"bg-gray-50"}`,children:[c.jsx("div",{className:"text-xs text-gray-500 uppercase mb-1",children:y.toLocaleDateString("es-ES",{weekday:"short"})}),c.jsx("div",{className:`text-lg font-bold ${d(y)?"text-teal-600":"text-gray-800"}`,children:y.getDate()})]},y.toISOString()))]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:l.map(y=>c.jsxs("div",{className:"flex min-h-[80px]",children:[c.jsx("div",{className:"w-16 flex-shrink-0 border-r border-b bg-white flex items-start justify-center pt-2",children:c.jsxs("span",{className:"text-xs font-medium text-gray-500",children:[String(y).padStart(2,"0"),":00"]})}),p.map(w=>{const v=r.filter(_=>{if(!_.date||!_.time)return!1;const k=new Date(_.date+"T00:00:00"),E=k.getDate()===w.getDate()&&k.getMonth()===w.getMonth()&&k.getFullYear()===w.getFullYear(),S=parseInt(_.time.split(":")[0],10);return E&&S===y&&a.includes(_.therapist_id)});return c.jsx("div",{className:"flex-1 min-w-[120px] border-r border-b relative hover:bg-gray-50 transition-colors",onClick:_=>s(_,`${String(y).padStart(2,"0")}:00`,a[0],w),children:v.map(_=>{const k=_.status==="blocked";return c.jsx("div",{onClick:E=>i(E,_),className:`text-xs p-1 mb-1 rounded truncate cursor-pointer ${h(_.status)}`,children:k?"Bloqueado":_.patient_name},_.id)})},`${w.toISOString()}-${y}`)})]},y))})]})}return null}function U3({onReportsRefresh:e,userRole:t,userEmail:r,therapistId:n}){const[a,s]=N.useState("day"),[i,o]=N.useState(new Date),[l,u]=N.useState([]),[f,d]=N.useState([]),[h,x]=N.useState([]),[g,m]=N.useState(!0),[p,y]=N.useState(!1),[w,v]=N.useState(!1),[_,k]=N.useState(!1),[E,S]=N.useState(!1),[C,A]=N.useState(null),[U,H]=N.useState(null),[b,V]=N.useState(null),[J,W]=N.useState(null);N.useEffect(()=>{Z()},[]),N.useEffect(()=>{!g&&f.length>0&&ee()},[i,a,h,g]);const Z=async()=>{m(!0);try{const{data:ce}=await xe.from("therapists").select("*").eq("active",!0).order("name");if(ce){d(ce);const I=t==="admin";y(I),x(I?ce.map(je=>je.id):n?[n]:[])}}catch(ce){console.error("Error loading initial data:",ce)}finally{m(!1)}},ee=async()=>{if(h.length===0){u([]);return}try{let ce=xe.from("appointments").select("*, therapists(name, color)").in("therapist_id",h);const I=new Date(i),je=new Date(i);if(a==="week"){const nt=I.getDay(),xr=I.getDate()-nt+(nt===0?-6:1);I.setDate(xr),I.setHours(0,0,0,0),je.setDate(I.getDate()+6),je.setHours(23,59,59,999)}else I.setHours(0,0,0,0),je.setHours(23,59,59,999);const Re=I.toISOString().split("T")[0],He=je.toISOString().split("T")[0];ce=ce.gte("date",Re).lte("date",He);const{data:Oe,error:ge}=await ce;if(ge)throw ge;u(Oe||[])}catch(ce){console.error("Error fetching appointments:",ce)}},G=()=>{const ce=new Date(i);a==="week"?ce.setDate(ce.getDate()-7):ce.setDate(ce.getDate()-1),o(ce)},B=()=>{const ce=new Date(i);a==="week"?ce.setDate(ce.getDate()+7):ce.setDate(ce.getDate()+1),o(ce)},ae=()=>{o(new Date)},de=(ce,I,je,Re)=>{ce.stopPropagation(),W({x:ce.clientX,y:ce.clientY,time:I,therapistId:je,date:Re}),V(null)},R=(ce,I)=>{ce.stopPropagation(),V({x:ce.clientX,y:ce.clientY,appointment:I}),W(null)},z=(ce=null,I=null,je=null)=>{A({time:ce,therapistId:I||(h.length===1?h[0]:null),date:je||i}),v(!0),W(null)},O=(ce=null,I=null,je=null)=>{A({time:ce,therapistId:I||(h.length===1?h[0]:null),date:je||i}),k(!0),W(null)},P=async(ce,I,je)=>{try{const Re=I.toISOString().split("T")[0],He=I.toTimeString().substring(0,5),Oe={date:Re,time:He};je&&(Oe.therapist_id=je);const{error:ge}=await xe.from("appointments").update(Oe).eq("id",ce);if(ge)throw ge;ee()}catch(Re){console.error("Error moving appointment:",Re)}},K=async ce=>{b!=null&&b.appointment&&(await xe.from("appointments").update({status:ce}).eq("id",b.appointment.id),ee(),V(null))},re=async ce=>{b!=null&&b.appointment&&(H(b.appointment),S(!0),V(null))},oe=async()=>{b!=null&&b.appointment&&confirm("Ests seguro de eliminar esta cita?")&&(await xe.from("appointments").delete().eq("id",b.appointment.id),ee(),V(null))},le=()=>{if(!(b!=null&&b.appointment))return;const ce=b.appointment;A({id:ce.id,patient_name:ce.patient_name,service:ce.service,date:new Date(ce.date+"T00:00:00"),time:ce.time,therapistId:ce.therapist_id,notes:ce.notes,status:ce.status,payment_status:ce.payment_status,estimated_value:ce.estimated_value}),ce.status==="blocked"?k(!0):v(!0),V(null)},ie=N.useMemo(()=>{if(h.length===1){const ce=f.find(I=>I.id===h[0]);return ce?ce.name:""}else if(h.length>1)return"Mltiples Terapeutas";return"Ningn Terapeuta Seleccionado"},[h,f]);return c.jsxs("div",{className:"flex h-full bg-gray-100 rounded-lg overflow-hidden shadow-lg",onClick:()=>{W(null),V(null)},children:[c.jsx(L3,{currentDate:i,onDateChange:o,therapists:f,selectedTherapists:h,canViewAllTherapists:p,onToggleTherapist:ce=>{p&&x(I=>I.includes(ce)?I.filter(je=>je!==ce):[...I,ce])}}),c.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-white",children:[c.jsx(M3,{currentDate:i,onPrev:G,onNext:B,onToday:ae,onRefresh:ee,onNewAppointment:()=>z(),view:a,setView:s,selectedTherapistName:ie}),c.jsx("div",{className:"flex-1 overflow-hidden relative",children:g?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})}):c.jsx(B3,{date:i,view:a,appointments:l,therapists:f,selectedTherapists:h,onTimeClick:de,onAppointmentClick:R,onDrop:P})})]}),J&&c.jsxs("div",{className:"fixed bg-white rounded-md shadow-xl border py-1 z-50 w-48",style:{top:J.y,left:J.x},children:[c.jsxs("button",{onClick:()=>z(J.time,J.therapistId,J.date),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[c.jsx(In,{size:16})," Nueva Cita"]}),c.jsxs("button",{onClick:()=>O(J.time,J.therapistId,J.date),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[c.jsx(Ah,{size:16})," Bloquear Horario"]})]}),b&&c.jsxs("div",{className:"fixed bg-white rounded-md shadow-xl border py-1 z-50 w-48",style:{top:b.y,left:b.x},children:[c.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 border-b mb-1",children:"Acciones"}),c.jsxs("button",{onClick:le,className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",children:[c.jsx(m4,{size:16})," Editar"]}),b.appointment.status!=="blocked"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"border-t my-1"}),c.jsxs("button",{onClick:()=>K("confirmada"),className:"w-full text-left px-4 py-2 text-sm hover:bg-yellow-50 text-yellow-800 flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-400"})," Confirmar"]}),c.jsxs("button",{onClick:()=>K("asiste"),className:"w-full text-left px-4 py-2 text-sm hover:bg-pink-50 text-pink-800 flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-pink-400"})," Asiste"]}),c.jsxs("button",{onClick:()=>K("cancelado"),className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-800 flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400"})," Cancelar"]}),c.jsx("div",{className:"border-t my-1"}),c.jsxs("button",{onClick:()=>re(),className:"w-full text-left px-4 py-2 text-sm hover:bg-green-50 text-green-800 flex items-center gap-2",children:[c.jsx(Ha,{size:16})," Registrar Pago"]})]}),c.jsx("div",{className:"border-t my-1"}),c.jsxs("button",{onClick:oe,className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-800 flex items-center gap-2",children:[c.jsx($i,{size:16})," Eliminar"]})]}),c.jsx(P3,{isOpen:w,onClose:()=>v(!1),initialDetails:C,onSave:ee,therapists:f,userRole:t,therapistId:n}),c.jsx(I3,{isOpen:_,onClose:()=>k(!1),initialDetails:C,onSave:ee}),c.jsx(D3,{isOpen:E,onClose:()=>S(!1),appointmentId:U==null?void 0:U.id,onProofUploaded:()=>{ee(),e&&e()}})]})}const io=["Sesin individual presencial","Sesin individual en lnea","Sesin pareja presencial","Sesin pareja en lnea","Sesin familiar en lnea","Sesin familiar presencial","Sesin a domicilio","Taller","Conferencia","Curso"],oo=["Facebook","Instagram","TikTok","Google Ads","Referido","Orgnico","Base General"],uc=["WhatsApp 1","WhatsApp 2","WhatsApp 3"],fc=["Facebook 1","Facebook 2","Facebook 3"];function $3({isOpen:e,onClose:t,onSave:r,initialData:n}){const[a,s]=N.useState({full_name:"",phone:"",email:"",value:"",service:io[0],notes:"",source:oo[0],whatsapp_line:uc[0],facebook_account:fc[0]}),[i,o]=N.useState(!1),[l,u]=N.useState(null),[f,d]=N.useState([]);N.useEffect(()=>{h()},[]);async function h(){try{const{data:g,error:m}=await xe.from("therapists").select("id, name").eq("active",!0).order("name");if(m)throw m;d(g||[])}catch(g){console.error("Error fetching therapists:",g)}}if(N.useEffect(()=>{e&&(s(n?{full_name:n.full_name||"",phone:n.phone||"",email:n.email||"",value:n.value||"",service:n.service||io[0],assigned_therapist_id:n.assigned_therapist_id||"",notes:n.notes||"",source:n.source||oo[0],whatsapp_line:n.whatsapp_line||uc[0],facebook_account:n.facebook_account||fc[0]}:{full_name:"",phone:"",email:"",value:"",service:io[0],assigned_therapist_id:"",notes:"",source:oo[0],whatsapp_line:uc[0],facebook_account:fc[0]}),u(null),o(!1))},[e,n]),!e)return null;const x=async g=>{g.preventDefault(),o(!0),u(null);try{const m={...a,value:a.value===""?null:a.value,assigned_therapist_id:a.assigned_therapist_id===""?null:a.assigned_therapist_id};await r(m),s({full_name:"",phone:"",email:"",service:io[0],value:"",notes:"",source:oo[0]}),t()}catch(m){console.error("Error al guardar el lead:",m),u(m.message||"Error al crear el lead")}finally{o(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n?"Editar Lead":"Nuevo Lead"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:20})})]}),c.jsxs("form",{onSubmit:x,className:"p-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Paciente"}),c.jsxs("div",{className:"relative",children:[c.jsx(na,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("input",{required:!0,type:"text",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Nombre completo",value:a.full_name,onChange:g=>s({...a,full_name:g.target.value})})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ai,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("input",{type:"tel",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"55 1234 5678",value:a.phone,onChange:g=>s({...a,phone:g.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),c.jsxs("div",{className:"relative",children:[c.jsx(jl,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("input",{type:"email",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"correo@ejemplo.com",value:a.email,onChange:g=>s({...a,email:g.target.value})})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor Estimado"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ha,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("input",{type:"number",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"0.00",value:a.value,onChange:g=>s({...a,value:g.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Servicio de Inters"}),c.jsx("select",{className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",value:a.service,onChange:g=>s({...a,service:g.target.value}),children:io.map(g=>c.jsx("option",{value:g,children:g},g))})]}),a.service&&a.service.toLowerCase().includes("sesin")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terapeuta Asignado"}),c.jsxs("div",{className:"relative",children:[c.jsx(na,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsxs("select",{className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",value:a.assigned_therapist_id,onChange:g=>s({...a,assigned_therapist_id:g.target.value}),children:[c.jsx("option",{value:"",children:"Seleccionar terapeuta..."}),f.map(g=>c.jsx("option",{value:g.id,children:g.name},g.id))]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Origen (Source)"}),c.jsxs("div",{className:"relative",children:[c.jsx(td,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("select",{required:!0,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",value:a.source,onChange:g=>s({...a,source:g.target.value}),children:oo.map(g=>c.jsx("option",{value:g,children:g},g))})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lnea de WhatsApp"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ai,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("select",{className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",value:a.whatsapp_line,onChange:g=>s({...a,whatsapp_line:g.target.value}),children:uc.map(g=>c.jsx("option",{value:g,children:g},g))})]})]}),["Facebook","Instagram","TikTok"].includes(a.source)&&!a.service.toLowerCase().includes("sesin")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cuenta de Facebook"}),c.jsxs("div",{className:"relative",children:[c.jsx(td,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("select",{className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",value:a.facebook_account,onChange:g=>s({...a,facebook_account:g.target.value}),children:fc.map(g=>c.jsx("option",{value:g,children:g},g))})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas"}),c.jsxs("div",{className:"relative",children:[c.jsx(Al,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),c.jsx("textarea",{className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",rows:"3",placeholder:"Detalles adicionales...",value:a.notes,onChange:g=>s({...a,notes:g.target.value})})]})]}),l&&c.jsx("p",{className:"text-red-500 text-sm mt-3",children:l}),c.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",disabled:i,children:"Cancelar"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2 disabled:opacity-50",disabled:i,children:i?"Guardando...":c.jsxs(c.Fragment,{children:[c.jsx(Ui,{size:18})," ",n?"Actualizar Lead":"Guardar Lead"]})})]})]})]})})}function z3({isOpen:e,onClose:t,selectedLeads:r,leads:n}){const[a,s]=N.useState(""),[i,o]=N.useState(""),[l,u]=N.useState(""),[f,d]=N.useState(!1),[h,x]=N.useState(!1),[g,m]=N.useState(null),p=N.useRef(null);if(!e)return null;const y=n.filter(k=>r.includes(k.id)&&k.email),w=y.length,v=async k=>{const E=k.target.files[0];if(E){x(!0);try{const S=E.name.split(".").pop(),A=`${`${Date.now()}.${S}`}`,{error:U}=await xe.storage.from("email_attachments").upload(A,E);if(U)throw U;const{data:H}=xe.storage.from("email_attachments").getPublicUrl(A);u(H.publicUrl)}catch(S){console.error("Error uploading image:",S),alert("Error al subir la imagen")}finally{x(!1),p.current&&(p.current.value="")}}},_=async()=>{if(!a.trim()||!i.trim()){alert("Por favor completa el asunto y el mensaje.");return}if(w===0){alert("No hay destinatarios con email vlido seleccionados.");return}d(!0),m(null);try{const k=y.map(C=>C.email),{data:E,error:S}=await xe.functions.invoke("send-bulk-email",{body:{emails:k,subject:a,message:i,imageUrl:l}});if(S)throw S;m({success:!0,message:`Se enviaron correos a ${w} destinatarios.`}),setTimeout(()=>{t(),s(""),o(""),m(null)},2e3)}catch(k){console.error("Error sending emails:",k),m({success:!1,message:"Hubo un error al enviar los correos. Por favor intenta de nuevo."})}finally{d(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Enviar Correo Masivo"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[g&&c.jsx("div",{className:`mb-4 p-4 rounded-lg ${g.success?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:g.message}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destinatarios"}),c.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border text-sm text-gray-600",children:["Se enviar a ",c.jsx("span",{className:"font-bold text-gray-900",children:w})," leads seleccionados.",w<r.length&&c.jsxs("span",{className:"text-amber-600 ml-2 text-xs",children:["(",r.length-w," leads seleccionados no tienen email)"]})]})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),c.jsx("input",{type:"text",value:a,onChange:k=>s(k.target.value),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Asunto del correo..."})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje"}),c.jsx("textarea",{value:i,onChange:k=>o(k.target.value),className:"w-full p-2 border rounded-lg h-64 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none resize-none",placeholder:"Escribe tu mensaje aqu..."})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Imagen (Opcional)"}),l?c.jsxs("div",{className:"relative mt-2 inline-block border rounded-lg overflow-hidden bg-gray-50",children:[c.jsx("img",{src:l,alt:"Vista previa",className:"max-h-40 object-contain"}),c.jsx("button",{onClick:()=>u(""),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors shadow-sm",title:"Eliminar imagen",children:c.jsx(Ut,{size:14})})]}):c.jsxs("div",{children:[c.jsx("input",{type:"file",ref:p,onChange:v,className:"hidden",accept:"image/*"}),c.jsxs("button",{onClick:()=>{var k;return(k=p.current)==null?void 0:k.click()},disabled:h,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors w-full justify-center border-dashed",children:[h?c.jsx(Pn,{className:"animate-spin",size:18}):c.jsx(As,{size:18}),h?"Subiendo...":"Seleccionar imagen desde mi computadora"]})]})]})]}),c.jsxs("div",{className:"p-6 border-t bg-gray-50 rounded-b-lg flex justify-end gap-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",disabled:f,children:"Cancelar"}),c.jsx("button",{onClick:_,disabled:f||w===0,className:"px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?c.jsxs(c.Fragment,{children:[c.jsx(Pn,{className:"animate-spin",size:18}),"Enviando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(E4,{size:18}),"Enviar Correo"]})})]})]})})}function W3({isOpen:e,onClose:t,selectedLeads:r,leads:n}){const[a,s]=N.useState(""),[i,o]=N.useState(""),[l,u]=N.useState(!1),[f,d]=N.useState("1"),[h,x]=N.useState(""),[g,m]=N.useState(!1),p=N.useRef(null);if(!e)return null;const y=n.filter(C=>r.includes(C.id)&&(C.whatsapp_line||C.phone)),w=y.length,v=C=>{const A=p.current;if(!A)return;const U=A.selectionStart,H=A.selectionEnd,b=A.value,V=b.substring(U,H);let J="",W="";switch(C){case"bold":W="*";break;case"italic":W="_";break;case"strikethrough":W="~";break;default:return}J=`${W}${V}${W}`;const Z=b.substring(0,U)+J+b.substring(H);o(Z),setTimeout(()=>{A.focus(),A.setSelectionRange(U+1,H+1)},0)},_=async C=>{const A=C.target.files[0];if(A)try{m(!0);const U=A.name.split(".").pop(),b=`${`${Math.random()}.${U}`}`,{error:V}=await xe.storage.from("whatsapp_attachments").upload(b,A);if(V)throw V;const{data:J}=xe.storage.from("whatsapp_attachments").getPublicUrl(b);x(J.publicUrl)}catch(U){console.error("Error uploading image:",U),alert("Error al subir la imagen")}finally{m(!1)}},k=()=>{let C="";return a&&(C+=`*${a}*

`),C+=i,h&&(C+=`

${h}`),C},E=C=>{const A=C.replace(/\D/g,""),U=encodeURIComponent(k());return`https://wa.me/${A}?text=${U}`},S=()=>{navigator.clipboard.writeText(k()),u(!0),setTimeout(()=>u(!1),2e3)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[c.jsx(Vm,{className:"text-green-600"}),"Enviar WhatsApp Masivo"]}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})})]}),c.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[c.jsx("div",{className:"w-1/2 p-6 border-r overflow-y-auto",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enviar desde"}),c.jsxs("select",{value:f,onChange:C=>d(C.target.value),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none",children:[c.jsx("option",{value:"1",children:"Lnea WhatsApp 1"}),c.jsx("option",{value:"2",children:"Lnea WhatsApp 2"}),c.jsx("option",{value:"3",children:"Lnea WhatsApp 3"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Asegrate de tener abierta la sesin de WhatsApp Web correspondiente."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ttulo (opcional)"}),c.jsx("input",{type:"text",value:a,onChange:C=>s(C.target.value),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none font-bold",placeholder:"Ttulo del mensaje"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje"}),c.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 border-b",children:[c.jsx("button",{onClick:()=>v("bold"),className:"p-1.5 hover:bg-gray-200 rounded",title:"Negrita",children:c.jsx(mb,{size:16})}),c.jsx("button",{onClick:()=>v("italic"),className:"p-1.5 hover:bg-gray-200 rounded",title:"Cursiva",children:c.jsx(Zb,{size:16})}),c.jsx("button",{onClick:()=>v("strikethrough"),className:"p-1.5 hover:bg-gray-200 rounded",title:"Tachado",children:c.jsx(j4,{size:16})}),c.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),c.jsxs("label",{className:"p-1.5 hover:bg-gray-200 rounded cursor-pointer",title:"Subir imagen",children:[c.jsx(Jb,{size:16}),c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_,disabled:g})]})]}),c.jsx("textarea",{ref:p,value:i,onChange:C=>o(C.target.value),className:"w-full p-3 h-40 focus:outline-none resize-none",placeholder:"Escribe tu mensaje aqu..."})]})]}),g&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(Pn,{className:"animate-spin",size:16})," Subiendo imagen..."]}),h&&c.jsxs("div",{className:"relative inline-block border rounded-lg overflow-hidden group",children:[c.jsx("img",{src:h,alt:"Adjunto",className:"h-32 w-auto object-cover"}),c.jsx("button",{onClick:()=>x(""),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(Ut,{size:12})})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:[c.jsx("h4",{className:"text-xs font-semibold text-green-800 uppercase mb-2",children:"Vista previa del mensaje"}),c.jsxs("div",{className:"text-sm text-gray-800 whitespace-pre-wrap font-sans",children:[a&&c.jsx("div",{className:"font-bold mb-2",children:a}),i||c.jsx("span",{className:"text-gray-400 italic",children:"Tu mensaje aparecer aqu..."}),h&&c.jsx("div",{className:"mt-2 text-blue-600 text-xs break-all",children:h})]}),c.jsxs("button",{onClick:S,className:"mt-3 flex items-center gap-1 text-xs text-green-700 hover:text-green-800 font-medium",children:[l?c.jsx(Nh,{size:12}):c.jsx(Ob,{size:12}),l?"Copiado":"Copiar texto completo"]})]})]})}),c.jsxs("div",{className:"w-1/2 p-6 bg-gray-50 overflow-y-auto",children:[c.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center justify-between",children:["Destinatarios (",w,")",c.jsx("span",{className:"text-xs font-normal text-gray-500",children:"Se abrir WhatsApp Web"})]}),c.jsxs("div",{className:"space-y-2",children:[y.map(C=>{const A=C.whatsapp_line||C.phone;return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border shadow-sm hover:shadow-md transition-shadow",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:C.full_name||C.name}),c.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[c.jsx(Vm,{size:12})," ",A]})]}),c.jsxs("a",{href:E(A),target:"_blank",rel:"noopener noreferrer",className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${i.trim()||a.trim()||h?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,onClick:U=>!(i.trim()||a.trim()||h)&&U.preventDefault(),children:["Enviar ",c.jsx(Ub,{size:14})]})]},C.id)}),y.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500 bg-white rounded-lg border border-dashed",children:"No hay destinatarios seleccionados con nmero de telfono vlido."})]})]})]}),c.jsx("div",{className:"p-6 border-t bg-white rounded-b-lg flex justify-end",children:c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cerrar"})})]})})}function H3({isOpen:e,onClose:t,lead:r}){const[n,a]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState({title:"",description:"",due_date:"",type:"task",tags:"",notes:""});N.useEffect(()=>{e&&r&&u()},[e,r]);const u=async()=>{i(!0);const{data:p,error:y}=await xe.from("lead_tasks").select("*").eq("lead_id",r.id).order("due_date",{ascending:!0});y?console.error("Error fetching tasks:",y):a(p||[]),i(!1)},f=async p=>{if(p.preventDefault(),!o.title)return;const y=o.tags.split(",").map(k=>k.trim()).filter(k=>k),w={lead_id:r.id,title:o.title,description:o.description,due_date:o.due_date||null,type:o.type,tags:y,notes:o.notes,status:"pending"},{data:v,error:_}=await xe.from("lead_tasks").insert([w]).select();_?(console.error("Error adding task:",_),alert("Error al crear la tarea")):(a([...n,v[0]]),l({title:"",description:"",due_date:"",type:"task",tags:""}))},d=async p=>{window.confirm("Aplicar esta automatizacin? Se crearn varias tareas.");const y=new Date;let w=[];if(w=[{lead_id:r.id,title:"Llamada de seguimiento 1",type:"task",due_date:new Date(y.setDate(y.getDate()+1)).toISOString(),tags:["seguimiento","llamada"],notes:"",status:"pending"},{lead_id:r.id,title:"Enviar correo de informacin",type:"task",due_date:new Date(y.setDate(y.getDate()+2)).toISOString(),tags:["seguimiento","email"],notes:"",status:"pending"},{lead_id:r.id,title:"Llamada de cierre",type:"alert",due_date:new Date(y.setDate(y.getDate()+4)).toISOString(),tags:["cierre","importante"],notes:"",status:"pending"}],w.length>0){const{data:v,error:_}=await xe.from("lead_tasks").insert(w).select();_?console.error("Error applying automation:",_):a([...n,...v])}},h=async p=>{const y=p.status==="pending"?"completed":"pending",{error:w}=await xe.from("lead_tasks").update({status:y}).eq("id",p.id);w?console.error("Error updating task:",w):a(n.map(v=>v.id===p.id?{...v,status:y}:v))},x=async p=>{if(!window.confirm("Eliminar esta tarea?"))return;const{error:y}=await xe.from("lead_tasks").delete().eq("id",p);y?console.error("Error deleting task:",y):a(n.filter(w=>w.id!==p))};if(!e||!r)return null;const g=p=>{switch(p){case"alert":return c.jsx(L4,{size:16,className:"text-red-500"});case"reminder":return c.jsx(hb,{size:16,className:"text-yellow-500"});default:return c.jsx(lu,{size:16,className:"text-blue-500"})}},m=p=>{switch(p){case"alert":return"Alerta";case"reminder":return"Recordatorio";default:return"Tarea"}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tareas y Recordatorios"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Para: ",r.full_name||r.name]})]}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})})]}),c.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[c.jsx("div",{className:"flex justify-end mb-4",children:c.jsxs("button",{onClick:()=>d(),className:"text-xs flex items-center gap-1 px-3 py-1.5 bg-indigo-50 text-indigo-700 rounded-full border border-indigo-100 hover:bg-indigo-100",children:[c.jsx(tl,{size:12}),"Aplicar Plan de Seguimiento (Automtico)"]})}),c.jsxs("form",{onSubmit:f,className:"space-y-3",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"text",placeholder:"Ttulo de la tarea...",className:"flex-1 p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none",value:o.title,onChange:p=>l({...o,title:p.target.value}),required:!0}),c.jsxs("select",{className:"p-2 border rounded-lg bg-white",value:o.type,onChange:p=>l({...o,type:p.target.value}),children:[c.jsx("option",{value:"task",children:"Tarea"}),c.jsx("option",{value:"reminder",children:"Recordatorio"}),c.jsx("option",{value:"alert",children:"Alerta"})]})]}),c.jsx("textarea",{placeholder:"Notas internas...",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none",rows:"2",value:o.notes,onChange:p=>l({...o,notes:p.target.value})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"datetime-local",className:"p-2 border rounded-lg bg-white",value:o.due_date,onChange:p=>l({...o,due_date:p.target.value})}),c.jsx("input",{type:"text",placeholder:"Etiquetas (sep. por comas)",className:"flex-1 p-2 border rounded-lg",value:o.tags,onChange:p=>l({...o,tags:p.target.value})}),c.jsxs("button",{type:"submit",className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 flex items-center gap-2",children:[c.jsx(In,{size:18})," Aadir"]})]})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:s?c.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cargando tareas..."}):n.length===0?c.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay tareas pendientes para este lead."}):n.map(p=>c.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border ${p.status==="completed"?"bg-gray-50 opacity-75":"bg-white hover:shadow-sm"}`,children:[c.jsx("button",{onClick:()=>h(p),className:`mt-1 ${p.status==="completed"?"text-green-500":"text-gray-300 hover:text-green-500"}`,children:p.status==="completed"?c.jsx(lu,{size:20}):c.jsx(jb,{size:20})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full flex items-center gap-1 border ${p.type==="alert"?"bg-red-50 text-red-700 border-red-100":p.type==="reminder"?"bg-yellow-50 text-yellow-700 border-yellow-100":"bg-blue-50 text-blue-700 border-blue-100"}`,children:[g(p.type),m(p.type)]}),c.jsx("h3",{className:`font-medium ${p.status==="completed"?"line-through text-gray-500":"text-gray-800"}`,children:p.title})]}),p.description&&c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:p.description}),p.notes&&c.jsxs("p",{className:"text-sm text-gray-500 italic mb-1",children:["Notas: ",p.notes]}),p.due_date&&c.jsxs("div",{className:`text-xs flex items-center gap-1 mb-1 ${new Date(p.due_date)<new Date&&p.status!=="completed"?"text-red-600 font-medium":"text-gray-500"}`,children:[c.jsx(tl,{size:12}),new Date(p.due_date).toLocaleString()]}),p.tags&&p.tags.length>0&&c.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:p.tags.map((y,w)=>c.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded flex items-center gap-0.5",children:[c.jsx(Ku,{size:8})," ",y]},w))})]}),c.jsx("button",{onClick:()=>x(p.id),className:"text-gray-400 hover:text-red-500 p-1",children:c.jsx($i,{size:16})})]},p.id))})]})})}function V3({lead:e,isSelected:t,onToggleSelect:r,onDragStart:n,openDropdownId:a,setOpenDropdownId:s,onEdit:i,onDelete:o,onAddTask:l}){return c.jsxs("div",{draggable:!0,onDragStart:u=>n(u,e),className:`bg-white p-3 rounded-lg shadow-sm border hover:shadow-md cursor-grab active:cursor-grabbing transition-all group relative ${t?"ring-2 ring-teal-500 border-teal-500":""}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("button",{onClick:u=>{u.stopPropagation(),r(e.id)},className:"mt-1 text-gray-400 hover:text-teal-600",children:t?c.jsx(Gu,{size:16,className:"text-teal-600"}):c.jsx(uy,{size:16})}),c.jsx("h3",{className:"font-semibold text-gray-900",children:e.full_name||e.name})]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:u=>{u.stopPropagation(),s(a===e.id?null:e.id)},className:"text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Opciones",children:c.jsx(Mb,{size:16})}),a===e.id&&c.jsxs("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg z-10 border",children:[c.jsx("button",{onClick:()=>{l(e),s(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Tareas y Alertas"}),c.jsx("button",{onClick:()=>{i(e),s(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),c.jsx("button",{onClick:()=>o(e.id),className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:"Eliminar"})]})]})]}),c.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[e.service&&c.jsxs("div",{className:"flex items-center gap-1.5 text-teal-600 font-medium bg-teal-50 p-1.5 rounded",children:[c.jsx(Ku,{size:12})," ",e.service]}),e.assigned_therapist_name&&e.assigned_therapist_name!=="N/A"&&c.jsxs("div",{className:"flex items-center gap-1.5 text-purple-600 font-medium bg-purple-50 p-1.5 rounded",children:[c.jsx(na,{size:12})," ",e.assigned_therapist_name]}),e.source&&c.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600 font-medium bg-gray-50 p-1.5 rounded",children:[c.jsx(ny,{size:12})," ",e.source]}),e.whatsapp_line&&c.jsxs("div",{className:"flex items-center gap-1.5 text-green-700 font-medium bg-green-50 p-1.5 rounded border border-green-100",children:[c.jsx(Ai,{size:12})," ",e.whatsapp_line]}),e.facebook_account&&c.jsxs("div",{className:"flex items-center gap-1.5 text-blue-700 font-medium bg-blue-50 p-1.5 rounded border border-blue-100",children:[c.jsx(td,{size:12})," ",e.facebook_account]}),c.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.value>0&&c.jsxs("div",{className:"flex items-center gap-1 font-semibold text-gray-700",children:[c.jsx(Ha,{size:12})," ",e.value]}),c.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[c.jsx(On,{size:12})," ",new Date(e.created_at).toLocaleDateString()]})]}),(e.phone||e.email)&&c.jsxs("div",{className:"pt-2 border-t flex flex-col gap-1",children:[e.phone&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx(Ai,{size:12})," ",e.phone]}),e.email&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx(jl,{size:12})," ",e.email]})]})]})]})}function G3(){const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,s]=N.useState(null),[i,o]=N.useState(null),[l,u]=N.useState(null),[f,d]=N.useState(!1),[h,x]=N.useState(!1),[g,m]=N.useState(!1),[p,y]=N.useState(!1),[w,v]=N.useState(null),[_,k]=N.useState([]),[E,S]=N.useState(null),[C,A]=N.useState(null),[U,H]=N.useState([{id:"new",name:"Nuevo",color:"bg-teal-100 text-teal-800"},{id:"scheduled",name:"Agendado",color:"bg-purple-100 text-purple-800"},{id:"paid",name:"Pagado",color:"bg-green-100 text-green-800"},{id:"lost",name:"Perdido",color:"bg-red-100 text-red-800"},{id:"partners",name:"Aliados/Proveedores",color:"bg-blue-100 text-blue-800"},{id:"px_agpro",name:"Px AgPro",color:"bg-indigo-100 text-indigo-800"},{id:"general_base",name:"Base General",color:"bg-gray-100 text-gray-800"}]);N.useEffect(()=>{b()},[]);const b=async()=>{try{n(!0),s(null);try{const{data:O,error:P}=await xe.from("leads").select("*, therapists(name)").order("created_at",{ascending:!1});if(P)throw P;if(O){const K=O.map(re=>({...re,assigned_therapist_name:re.therapists?re.therapists.name:"N/A"}));t(K)}else t([])}catch(O){console.warn("Error fetching leads with relation, trying simple fetch:",O);const{data:P,error:K}=await xe.from("leads").select("*").order("created_at",{ascending:!1});if(K)throw K;if(P){const re=P.map(oe=>({...oe,assigned_therapist_name:"N/A (Error de carga)"}));t(re)}else t([])}}catch(O){console.error("Critical error fetching leads:",O),s("Error al cargar los leads. Por favor, verifica tu conexin o contacta soporte.")}finally{n(!1)}},V=(O,P)=>{O.stopPropagation(),o(P),O.dataTransfer.effectAllowed="move"},J=(O,P)=>{u(P),O.dataTransfer.effectAllowed="move"},W=O=>{O.preventDefault(),O.dataTransfer.dropEffect="move"},Z=async(O,P)=>{if(O.preventDefault(),O.stopPropagation(),i){if(i.status===P)return;const K=e.map(oe=>oe.id===i.id?{...oe,status:P}:oe);t(K);const{error:re}=await xe.from("leads").update({status:P}).eq("id",i.id);re&&(console.error("Error updating lead status:",re),b(),alert("Error al mover el lead. Se revertirn los cambios.")),o(null)}else if(l){if(l.id===P)return;const K=[...U],re=K.findIndex(ie=>ie.id===l.id),oe=K.findIndex(ie=>ie.id===P),[le]=K.splice(re,1);K.splice(oe,0,le),H(K),u(null)}},ee=async O=>{try{if(E){const{data:P,error:K}=await xe.from("leads").update(O).eq("id",E.id).select("*, therapists(name)");if(K)throw K;const re={...P[0],assigned_therapist_name:P[0].therapists?P[0].therapists.name:"N/A"};t(e.map(oe=>oe.id===re.id?re:oe)),S(null)}else{const{data:P,error:K}=await xe.from("leads").insert([{...O,status:"new"}]).select("*, therapists(name)");if(K)throw K;const re={...P[0],assigned_therapist_name:P[0].therapists?P[0].therapists.name:"N/A"};t([re,...e])}return!0}catch(P){throw console.error("Error saving lead:",P),alert("Error al guardar el lead: "+P.message),P}},G=async O=>{if(window.confirm("Ests seguro de que quieres eliminar este lead?"))try{const{error:P}=await xe.from("leads").delete().eq("id",O);if(P)throw P;t(e.filter(K=>K.id!==O)),A(null)}catch(P){console.error("Error deleting lead:",P),alert("Error al eliminar el lead.")}},B=O=>{S(O),d(!0)},ae=O=>{v(O),y(!0)},de=()=>{d(!1),S(null)},R=O=>{k(P=>P.includes(O)?P.filter(K=>K!==O):[...P,O])},z=O=>{const P=e.filter(re=>re.status===O).map(re=>re.id),K=P.every(re=>_.includes(re));k(K?re=>re.filter(oe=>!P.includes(oe)):re=>[...new Set([...re,...P])])};return N.useEffect(()=>{const O=P=>{C&&!P.target.closest(".relative")&&A(null)};return document.addEventListener("mousedown",O),()=>{document.removeEventListener("mousedown",O)}},[C]),c.jsxs("div",{className:"h-full flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Eutymia Ventas"}),_.length>0&&c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[c.jsx(Ai,{size:18}),"Enviar WhatsApp (",_.length,")"]}),c.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[c.jsx(jl,{size:18}),"Enviar Correo (",_.length,")"]})]})]}),c.jsx($3,{isOpen:f,onClose:de,onSave:ee,initialData:E}),c.jsx(z3,{isOpen:h,onClose:()=>x(!1),selectedLeads:_,leads:e}),c.jsx(W3,{isOpen:g,onClose:()=>m(!1),selectedLeads:_,leads:e}),c.jsx(H3,{isOpen:p,onClose:()=>y(!1),lead:w}),r&&c.jsx("div",{className:"flex-1 flex items-center justify-center",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}),a&&c.jsx("div",{className:"flex-1 flex items-center justify-center text-red-600 text-lg font-medium p-4 bg-red-50 rounded-lg m-4 border border-red-200",children:a}),!r&&!a&&c.jsx("div",{className:"flex-1 overflow-x-scroll pb-4",children:c.jsx("div",{className:"flex gap-4 h-full min-w-[1000px]",children:U.map(O=>c.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 rounded-lg border min-w-[280px]",onDragOver:W,onDrop:P=>Z(P,O.id),children:[c.jsxs("div",{className:`p-3 font-semibold text-sm uppercase tracking-wide border-b flex justify-between items-center ${O.color.replace("bg-","border-").replace("text-","text-")} cursor-move`,draggable:!0,onDragStart:P=>J(P,O),children:[c.jsxs("div",{className:"flex items-center gap-2 pointer-events-none",children:[c.jsx("button",{onClick:P=>{P.stopPropagation(),z(O.id)},className:"pointer-events-auto text-gray-500 hover:text-gray-700",children:e.filter(P=>P.status===O.id).length>0&&e.filter(P=>P.status===O.id).every(P=>_.includes(P.id))?c.jsx(Gu,{size:16,className:"text-teal-600"}):c.jsx(uy,{size:16})}),O.name,c.jsx("span",{className:"bg-white px-2 py-0.5 rounded-full text-xs shadow-sm border",children:e.filter(P=>P.status===O.id).length})]}),O.id==="new"&&c.jsx("button",{onClick:P=>{P.stopPropagation(),d(!0)},className:"p-1 hover:bg-white rounded-full transition-colors text-gray-600 hover:text-teal-600 pointer-events-auto",title:"Aadir nuevo lead",children:c.jsx(In,{size:18})})]}),c.jsx("div",{className:"flex-1 p-2 overflow-y-auto space-y-2",children:e.filter(P=>P.status===O.id).map(P=>c.jsx(V3,{lead:P,isSelected:_.includes(P.id),onToggleSelect:R,onDragStart:V,openDropdownId:C,setOpenDropdownId:A,onEdit:B,onDelete:G,onAddTask:ae},P.id))})]},O.id))})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var hu={};hu.version="0.18.5";var Cy=1252,K3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Dh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lh=function(e){K3.indexOf(e)!=-1&&(Cy=Dh[0]=e)};function X3(){Lh(1252)}var pn=function(e){Lh(e)};function Mh(){pn(1200),X3()}function mx(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function q3(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Ay(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var mo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?q3(e.slice(2)):t==254&&r==255?Ay(e.slice(2)):t==65279?e.slice(1):e},dc=function(t){return String.fromCharCode(t)},xx=function(t){return String.fromCharCode(t)},ll,Sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cl(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Sa.charAt(s)+Sa.charAt(i)+Sa.charAt(o)+Sa.charAt(l);return t}function Mr(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Sa.indexOf(e.charAt(u++)),i=Sa.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Sa.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Sa.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var De=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),la=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function La(e){return De?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function gx(e){return De?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Or=function(t){return De?la(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ju(e){if(typeof ArrayBuffer>"u")return Or(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Va(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Y3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Bh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Bh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Lt=De?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:la(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function J3(e){for(var t=[],r=0,n=e.length+250,a=La(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=La(65535),n=65530)}return t.push(a.slice(0,r)),Lt(t)}var hr=/\u0000/g,xo=/[\u0001-\u0006]/g;function vi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function mn(e,t){var r=""+e;return r.length>=t?r:xt("0",t-r.length)+r}function Uh(e,t){var r=""+e;return r.length>=t?r:xt(" ",t-r.length)+r}function pu(e,t){var r=""+e;return r.length>=t?r:r+xt(" ",t-r.length)}function Q3(e,t){var r=""+Math.round(e);return r.length>=t?r:xt("0",t-r.length)+r}function Z3(e,t){var r=""+e;return r.length>=t?r:xt("0",t-r.length)+r}var vx=Math.pow(2,32);function Hs(e,t){if(e>vx||e<-vx)return Q3(e,t);var r=Math.round(e);return Z3(r,t)}function mu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var yx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},wx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xu(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*i+s,f=d*u+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=s):(f=u,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Ea(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=oC(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var jy=new Date(1899,11,31,0,0,0),rC=jy.getTime(),nC=new Date(1900,2,1,0,0,0);function Fy(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=nC&&(r+=24*60*60*1e3),(r-(rC+(e.getTimezoneOffset()-jy.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $h(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function aC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sC(e){var t=e<0?12:11,r=$h(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iC(e){var t=$h(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ul(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=sC(e):t===10?r=e.toFixed(10).substr(0,12):r=iC(e),$h(aC(r.toUpperCase()))}function _s(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ul(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Br(14,Fy(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function oC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function lC(e,t,r,n){var a="",s=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return V0[r.m-1][1];case 5:return V0[r.m-1][0];default:return V0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return yx[r.q][0];default:return yx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?mn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=mn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?mn(l,u):"";return f}function ba(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Ry=/%/g;function cC(e,t,r){var n=t.replace(Ry,""),a=t.length-n.length;return Yn(e,n,r*Math.pow(10,2*a))+xt("%",a)}function uC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Yn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Oy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Oy(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Py=/# (\?+)( ?)\/( ?)(\d+)/;function fC(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?xt(" ",e[1].length+1+e[4].length):Uh(i,e[1].length)+e[2]+"/"+e[3]+mn(o,e[4].length))}function dC(e,t,r){return r+(t===0?"":""+t)+xt(" ",e[1].length+2+e[4].length)}var Iy=/^#*0*\.([0#]+)/,Dy=/\).*[0#]/,Ly=/\(###\) ###\\?-####/;function ur(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function _x(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function kx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function hC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function pC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Dy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vr("n",n,r):"("+Vr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uC(e,t,r);if(t.indexOf("%")!==-1)return cC(e,t,r);if(t.indexOf("E")!==-1)return Oy(t,r);if(t.charCodeAt(0)===36)return"$"+Vr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Hs(l,t.length);if(t.match(/^[#?]+$/))return a=Hs(r,0),a==="0"&&(a=""),a.length>t.length?a:ur(t.substr(0,t.length-a.length))+a;if(s=t.match(Py))return fC(s,l,u);if(t.match(/^#+0+$/))return u+Hs(l,t.length-t.indexOf("0"));if(s=t.match(Iy))return a=_x(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ur(s[1])).replace(/\.$/,"."+ur(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+xt("0",ur(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+_x(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ba(Hs(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vr(e,t,-r):ba(""+(Math.floor(r)+hC(r,s[1].length)))+"."+mn(kx(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Vr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vi(Vr(e,t.replace(/[\\-]/g,""),r)),i=0,vi(vi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(Ly))return a=Vr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=xu(l,Math.pow(10,i)-1,!1),a=""+u,f=Yn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=pu(o[2],i),f.length<s[4].length&&(f=ur(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=xu(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Uh(o[1],i)+s[2]+"/"+s[3]+pu(o[2],i):xt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Hs(r,0),t.length<=a.length?a:ur(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return ur(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=kx(r,s[1].length),r<0?"-"+Vr(e,t,-r):ba(pC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?mn(0,3-g.length):"")+g})+"."+mn(i,s[1].length);switch(t){case"###,##0.00":return Vr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=ba(Hs(l,0));return x!=="0"?u+x:"";case"###,###.00":return Vr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Yn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xC(e,t,r){var n=t.replace(Ry,""),a=t.length-n.length;return Yn(e,n,r*Math.pow(10,2*a))+xt("%",a)}function My(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+My(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function bn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Dy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bn("n",n,r):"("+bn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return mC(e,t,r);if(t.indexOf("%")!==-1)return xC(e,t,r);if(t.indexOf("E")!==-1)return My(t,r);if(t.charCodeAt(0)===36)return"$"+bn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+mn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ur(t.substr(0,t.length-a.length))+a;if(s=t.match(Py))return dC(s,l,u);if(t.match(/^#+0+$/))return u+mn(l,t.length-t.indexOf("0"));if(s=t.match(Iy))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ur(s[1])).replace(/\.$/,"."+ur(s[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+xt("0",ur(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ba(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bn(e,t,-r):ba(""+r)+"."+xt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return bn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vi(bn(e,t.replace(/[\\-]/g,""),r)),i=0,vi(vi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(Ly))return a=bn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=xu(l,Math.pow(10,i)-1,!1),a=""+u,f=Yn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=pu(o[2],i),f.length<s[4].length&&(f=ur(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=xu(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Uh(o[1],i)+s[2]+"/"+s[3]+pu(o[2],i):xt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ur(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return ur(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+bn(e,t,-r):ba(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?mn(0,3-g.length):"")+g})+"."+mn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=ba(""+l);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return bn(e,t.slice(0,t.lastIndexOf(".")),r)+ur(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Yn(e,t,r){return(r|0)===r?bn(e,t,r):Vr(e,t,r)}function gC(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var By=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function js(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":mu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(By))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function vC(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",u,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!mu(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var x=e.charAt(++i),g=x==="("||x===")"?x:"t";a[a.length]={t:g,v:x},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ea(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ea(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=Ea(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),u==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(By)){if(u==null&&(u=Ea(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",js(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var p=0,y=0,w;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",p<1&&(p=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&a[i].v.match(/[Hh]/)&&(p=1),p<2&&a[i].v.match(/[Mm]/)&&(p=2),p<3&&a[i].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",_;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=lC(a[i].t.charCodeAt(0),a[i].v,u,y),a[i].t="t";break;case"n":case"?":for(_=i+1;a[_]!=null&&((o=a[_].t)==="?"||o==="D"||(o===" "||o==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[i].v+=a[_].v,a[_]={v:"",t:";"},++_;v+=a[i].v,i=_-1;break;case"G":a[i].t="t",a[i].v=_s(t,r);break}var k="",E,S;if(v.length>0){v.charCodeAt(0)==40?(E=t<0&&v.charCodeAt(0)===45?-t:t,S=Yn("n",v,E)):(E=t<0&&n>1?-t:t,S=Yn("n",v,E),E<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),_=S.length-1;var C=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){C=i;break}var A=a.length;if(C===a.length&&S.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(_>=a[i].v.length-1?(_-=a[i].v.length,a[i].v=S.substr(_+1,a[i].v.length)):_<0?a[i].v="":(a[i].v=S.substr(0,_+1),_=-1),a[i].t="t",A=i);_>=0&&A<a.length&&(a[A].v=S.substr(0,_+1)+a[A].v)}else if(C!==a.length&&S.indexOf("E")===-1){for(_=S.indexOf(".")-1,i=C;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===C?a[i].v.indexOf(".")-1:a[i].v.length-1,k=a[i].v.substr(f+1);f>=0;--f)_>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(k=S.charAt(_--)+k);a[i].v=k,a[i].t="t",A=i}for(_>=0&&A<a.length&&(a[A].v=S.substr(0,_+1)+a[A].v),_=S.indexOf(".")+1,i=C;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==C)){for(f=a[i].v.indexOf(".")>-1&&i===C?a[i].v.indexOf(".")+1:0,k=a[i].v.substr(0,f);f<a[i].v.length;++f)_<S.length&&(k+=S.charAt(_++));a[i].v=k,a[i].t="t",A=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(E=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Yn(a[i].t,a[i].v,E),a[i].t="t");var U="";for(i=0;i!==a.length;++i)a[i]!=null&&(U+=a[i].v);return U}var Sx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ex(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function yC(e,t){var r=gC(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Sx),o=r[1].match(Sx);return Ex(t,i)?[n,r[0]]:Ex(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Br(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:be)[e],n==null&&(n=r.table&&r.table[wx[e]]||be[wx[e]]),n==null&&(n=tC[e]||"General");break}if(mu(n,0))return _s(t,r);t instanceof Date&&(t=Fy(t,r.date1904));var a=yC(n,t);if(mu(a[1]))return _s(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return vC(a[1],t,r,a[0])}function Rn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(be[r]==null){t<0&&(t=r);continue}if(be[r]==e){t=r;break}}t<0&&(t=391)}return be[t]=e,t}function Rl(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Rn(e[t],t)}function zi(){be=eC()}var Uy={format:Br,load:Rn,_table:be,load_table:Rl,parse_date_code:Ea,is_date:js,get_table:function(){return Uy._table=be}},wC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},$y=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _C(e){var t=typeof e=="number"?be[e]:e;return t=t.replace($y,"(\\d+)"),new RegExp("^"+t+"$")}function kC(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match($y)||[]).forEach(function(d,h){var x=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":i=x;break;case"s":l=x;break;case"m":i>=0?o=x:a=x;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&s==-1?f:u+"T"+f}var SC=function(){var e={};e.version="1.2.0";function t(){for(var S=0,C=new Array(256),A=0;A!=256;++A)S=A,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,C[A]=S;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(S){var C=0,A=0,U=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)H[U]=S[U];for(U=0;U!=256;++U)for(A=S[U],C=256+U;C<4096;C+=256)A=H[C]=A>>>8^S[A&255];var b=[];for(U=1;U!=16;++U)b[U-1]=typeof Int32Array<"u"?H.subarray(U*256,U*256+256):H.slice(U*256,U*256+256);return b}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],u=a[4],f=a[5],d=a[6],h=a[7],x=a[8],g=a[9],m=a[10],p=a[11],y=a[12],w=a[13],v=a[14];function _(S,C){for(var A=C^-1,U=0,H=S.length;U<H;)A=A>>>8^r[(A^S.charCodeAt(U++))&255];return~A}function k(S,C){for(var A=C^-1,U=S.length-15,H=0;H<U;)A=v[S[H++]^A&255]^w[S[H++]^A>>8&255]^y[S[H++]^A>>16&255]^p[S[H++]^A>>>24]^m[S[H++]]^g[S[H++]]^x[S[H++]]^h[S[H++]]^d[S[H++]]^f[S[H++]]^u[S[H++]]^l[S[H++]]^o[S[H++]]^i[S[H++]]^s[S[H++]]^r[S[H++]];for(U+=15;H<U;)A=A>>>8^r[(A^S[H++])&255];return~A}function E(S,C){for(var A=C^-1,U=0,H=S.length,b=0,V=0;U<H;)b=S.charCodeAt(U++),b<128?A=A>>>8^r[(A^b)&255]:b<2048?(A=A>>>8^r[(A^(192|b>>6&31))&255],A=A>>>8^r[(A^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,V=S.charCodeAt(U++)&1023,A=A>>>8^r[(A^(240|b>>8&7))&255],A=A>>>8^r[(A^(128|b>>2&63))&255],A=A>>>8^r[(A^(128|V>>6&15|(b&3)<<4))&255],A=A>>>8^r[(A^(128|V&63))&255]):(A=A>>>8^r[(A^(224|b>>12&15))&255],A=A>>>8^r[(A^(128|b>>6&63))&255],A=A>>>8^r[(A^(128|b&63))&255]);return~A}return e.table=r,e.bstr=_,e.buf=k,e.str=E,e}(),Ee=function(){var t={};t.version="1.2.1";function r(T,D){for(var j=T.split("/"),F=D.split("/"),L=0,M=0,q=Math.min(j.length,F.length);L<q;++L){if(M=j[L].length-F[L].length)return M;if(j[L]!=F[L])return j[L]<F[L]?-1:1}return j.length-F.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var D=T.lastIndexOf("/");return D===-1?T:T.slice(0,D+1)}function a(T){if(T.charAt(T.length-1)=="/")return a(T.slice(0,-1));var D=T.lastIndexOf("/");return D===-1?T:T.slice(D+1)}function s(T,D){typeof D=="string"&&(D=new Date(D));var j=D.getHours();j=j<<6|D.getMinutes(),j=j<<5|D.getSeconds()>>>1,T.write_shift(2,j);var F=D.getFullYear()-1980;F=F<<4|D.getMonth()+1,F=F<<5|D.getDate(),T.write_shift(2,F)}function i(T){var D=T.read_shift(2)&65535,j=T.read_shift(2)&65535,F=new Date,L=j&31;j>>>=5;var M=j&15;j>>>=4,F.setMilliseconds(0),F.setFullYear(j+1980),F.setMonth(M-1),F.setDate(L);var q=D&31;D>>>=5;var ne=D&63;return D>>>=6,F.setHours(D),F.setMinutes(ne),F.setSeconds(q<<1),F}function o(T){Vt(T,0);for(var D={},j=0;T.l<=T.length-4;){var F=T.read_shift(2),L=T.read_shift(2),M=T.l+L,q={};switch(F){case 21589:j=T.read_shift(1),j&1&&(q.mtime=T.read_shift(4)),L>5&&(j&2&&(q.atime=T.read_shift(4)),j&4&&(q.ctime=T.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}T.l=M,D[F]=q}return D}var l;function u(){return l||(l={})}function f(T,D){if(T[0]==80&&T[1]==75)return Tp(T,D);if((T[0]|32)==109&&(T[1]|32)==105)return X2(T,D);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var j=3,F=512,L=0,M=0,q=0,ne=0,X=0,Y=[],Q=T.slice(0,512);Vt(Q,0);var ue=d(Q);switch(j=ue[0],j){case 3:F=512;break;case 4:F=4096;break;case 0:if(ue[1]==0)return Tp(T,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}F!==512&&(Q=T.slice(0,F),Vt(Q,28));var ve=T.slice(0,F);h(Q,j);var we=Q.read_shift(4,"i");if(j===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);Q.l+=4,q=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),ne=Q.read_shift(4,"i"),L=Q.read_shift(4,"i"),X=Q.read_shift(4,"i"),M=Q.read_shift(4,"i");for(var he=-1,ye=0;ye<109&&(he=Q.read_shift(4,"i"),!(he<0));++ye)Y[ye]=he;var Fe=x(T,F);p(X,M,Fe,F,Y);var it=w(Fe,q,Y,F);it[q].name="!Directory",L>0&&ne!==V&&(it[ne].name="!MiniFAT"),it[Y[0]].name="!FAT",it.fat_addrs=Y,it.ssz=F;var ot={},qt=[],Ki=[],Xi=[];v(q,it,Fe,qt,L,ot,Ki,ne),g(Ki,Xi,qt),qt.shift();var qi={FileIndex:Ki,FullPaths:Xi};return D&&D.raw&&(qi.raw={header:ve,sectors:Fe}),qi}function d(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(J,"Header Signature: "),T.l+=16;var D=T.read_shift(2,"u");return[T.read_shift(2,"u"),D]}function h(T,D){var j=9;switch(T.l+=2,j=T.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function x(T,D){for(var j=Math.ceil(T.length/D)-1,F=[],L=1;L<j;++L)F[L-1]=T.slice(L*D,(L+1)*D);return F[j-1]=T.slice(j*D),F}function g(T,D,j){for(var F=0,L=0,M=0,q=0,ne=0,X=j.length,Y=[],Q=[];F<X;++F)Y[F]=Q[F]=F,D[F]=j[F];for(;ne<Q.length;++ne)F=Q[ne],L=T[F].L,M=T[F].R,q=T[F].C,Y[F]===F&&(L!==-1&&Y[L]!==L&&(Y[F]=Y[L]),M!==-1&&Y[M]!==M&&(Y[F]=Y[M])),q!==-1&&(Y[q]=F),L!==-1&&F!=Y[F]&&(Y[L]=Y[F],Q.lastIndexOf(L)<ne&&Q.push(L)),M!==-1&&F!=Y[F]&&(Y[M]=Y[F],Q.lastIndexOf(M)<ne&&Q.push(M));for(F=1;F<X;++F)Y[F]===F&&(M!==-1&&Y[M]!==M?Y[F]=Y[M]:L!==-1&&Y[L]!==L&&(Y[F]=Y[L]));for(F=1;F<X;++F)if(T[F].type!==0){if(ne=F,ne!=Y[ne])do ne=Y[ne],D[F]=D[ne]+"/"+D[F];while(ne!==0&&Y[ne]!==-1&&ne!=Y[ne]);Y[F]=-1}for(D[0]+="/",F=1;F<X;++F)T[F].type!==2&&(D[F]+="/")}function m(T,D,j){for(var F=T.start,L=T.size,M=[],q=F;j&&L>0&&q>=0;)M.push(D.slice(q*b,q*b+b)),L-=b,q=as(j,q*4);return M.length===0?te(0):Lt(M).slice(0,T.size)}function p(T,D,j,F,L){var M=V;if(T===V){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var q=j[T],ne=(F>>>2)-1;if(!q)return;for(var X=0;X<ne&&(M=as(q,X*4))!==V;++X)L.push(M);p(as(q,F-4),D-1,j,F,L)}}function y(T,D,j,F,L){var M=[],q=[];L||(L=[]);var ne=F-1,X=0,Y=0;for(X=D;X>=0;){L[X]=!0,M[M.length]=X,q.push(T[X]);var Q=j[Math.floor(X*4/F)];if(Y=X*4&ne,F<4+Y)throw new Error("FAT boundary crossed: "+X+" 4 "+F);if(!T[Q])break;X=as(T[Q],Y)}return{nodes:M,data:Dx([q])}}function w(T,D,j,F){var L=T.length,M=[],q=[],ne=[],X=[],Y=F-1,Q=0,ue=0,ve=0,we=0;for(Q=0;Q<L;++Q)if(ne=[],ve=Q+D,ve>=L&&(ve-=L),!q[ve]){X=[];var he=[];for(ue=ve;ue>=0;){he[ue]=!0,q[ue]=!0,ne[ne.length]=ue,X.push(T[ue]);var ye=j[Math.floor(ue*4/F)];if(we=ue*4&Y,F<4+we)throw new Error("FAT boundary crossed: "+ue+" 4 "+F);if(!T[ye]||(ue=as(T[ye],we),he[ue]))break}M[ve]={nodes:ne,data:Dx([X])}}return M}function v(T,D,j,F,L,M,q,ne){for(var X=0,Y=F.length?2:0,Q=D[T].data,ue=0,ve=0,we;ue<Q.length;ue+=128){var he=Q.slice(ue,ue+128);Vt(he,64),ve=he.read_shift(2),we=Xh(he,0,ve-Y),F.push(we);var ye={name:we,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Fe=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Fe!==0&&(ye.ct=_(he,he.l-8));var it=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);it!==0&&(ye.mt=_(he,he.l-8)),ye.start=he.read_shift(4,"i"),ye.size=he.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=V,ye.name=""),ye.type===5?(X=ye.start,L>0&&X!==V&&(D[X].name="!StreamData")):ye.size>=4096?(ye.storage="fat",D[ye.start]===void 0&&(D[ye.start]=y(j,ye.start,D.fat_addrs,D.ssz)),D[ye.start].name=ye.name,ye.content=D[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:X!==V&&ye.start!==V&&D[X]&&(ye.content=m(ye,D[X].data,(D[ne]||{}).data))),ye.content&&Vt(ye.content,0),M[we]=ye,q.push(ye)}}function _(T,D){return new Date((jr(T,D+4)/1e7*Math.pow(2,32)+jr(T,D)/1e7-11644473600)*1e3)}function k(T,D){return u(),f(l.readFileSync(T),D)}function E(T,D){var j=D&&D.type;switch(j||De&&Buffer.isBuffer(T)&&(j="buffer"),j||"base64"){case"file":return k(T,D);case"base64":return f(Or(Mr(T)),D);case"binary":return f(Or(T),D)}return f(T,D)}function S(T,D){var j=D||{},F=j.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=F+"/",T.FileIndex[0]={name:F,type:5}),j.CLSID&&(T.FileIndex[0].clsid=j.CLSID),C(T)}function C(T){var D="Sh33tJ5";if(!Ee.find(T,"/"+D)){var j=te(4);j[0]=55,j[1]=j[3]=50,j[2]=54,T.FileIndex.push({name:D,type:2,content:j,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+D),A(T)}}function A(T,D){S(T);for(var j=!1,F=!1,L=T.FullPaths.length-1;L>=0;--L){var M=T.FileIndex[L];switch(M.type){case 0:F?j=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(M.R*M.L*M.C)&&(j=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!D)){var q=new Date(1987,1,19),ne=0,X=Object.create?Object.create(null):{},Y=[];for(L=0;L<T.FullPaths.length;++L)X[T.FullPaths[L]]=!0,T.FileIndex[L].type!==0&&Y.push([T.FullPaths[L],T.FileIndex[L]]);for(L=0;L<Y.length;++L){var Q=n(Y[L][0]);F=X[Q],F||(Y.push([Q,{name:a(Q).replace("/",""),type:1,clsid:Z,ct:q,mt:q,content:null}]),X[Q]=!0)}for(Y.sort(function(we,he){return r(we[0],he[0])}),T.FullPaths=[],T.FileIndex=[],L=0;L<Y.length;++L)T.FullPaths[L]=Y[L][0],T.FileIndex[L]=Y[L][1];for(L=0;L<Y.length;++L){var ue=T.FileIndex[L],ve=T.FullPaths[L];if(ue.name=a(ve).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||Z,L===0)ue.C=Y.length>1?1:-1,ue.size=0,ue.type=5;else if(ve.slice(-1)=="/"){for(ne=L+1;ne<Y.length&&n(T.FullPaths[ne])!=ve;++ne);for(ue.C=ne>=Y.length?-1:ne,ne=L+1;ne<Y.length&&n(T.FullPaths[ne])!=n(ve);++ne);ue.R=ne>=Y.length?-1:ne,ue.type=1}else n(T.FullPaths[L+1]||"")==n(ve)&&(ue.R=L+1),ue.type=2}}}function U(T,D){var j=D||{};if(j.fileType=="mad")return q2(T,j);switch(A(T),j.fileType){case"zip":return z2(T,j)}var F=function(we){for(var he=0,ye=0,Fe=0;Fe<we.FileIndex.length;++Fe){var it=we.FileIndex[Fe];if(it.content){var ot=it.content.length;ot>0&&(ot<4096?he+=ot+63>>6:ye+=ot+511>>9)}}for(var qt=we.FullPaths.length+3>>2,Ki=he+7>>3,Xi=he+127>>7,qi=Ki+ye+qt+Xi,qa=qi+127>>7,i0=qa<=109?0:Math.ceil((qa-109)/127);qi+qa+i0+127>>7>qa;)i0=++qa<=109?0:Math.ceil((qa-109)/127);var $n=[1,i0,qa,Xi,qt,ye,he,0];return we.FileIndex[0].size=he<<6,$n[7]=(we.FileIndex[0].start=$n[0]+$n[1]+$n[2]+$n[3]+$n[4]+$n[5])+($n[6]+7>>3),$n}(T),L=te(F[7]<<9),M=0,q=0;{for(M=0;M<8;++M)L.write_shift(1,W[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:V),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:V),L.write_shift(4,F[1]),M=0;M<109;++M)L.write_shift(-4,M<F[2]?F[1]+M:-1)}if(F[1])for(q=0;q<F[1];++q){for(;M<236+q*127;++M)L.write_shift(-4,M<F[2]?F[1]+M:-1);L.write_shift(-4,q===F[1]-1?V:q+1)}var ne=function(we){for(q+=we;M<q-1;++M)L.write_shift(-4,M+1);we&&(++M,L.write_shift(-4,V))};for(q=M=0,q+=F[1];M<q;++M)L.write_shift(-4,ee.DIFSECT);for(q+=F[2];M<q;++M)L.write_shift(-4,ee.FATSECT);ne(F[3]),ne(F[4]);for(var X=0,Y=0,Q=T.FileIndex[0];X<T.FileIndex.length;++X)Q=T.FileIndex[X],Q.content&&(Y=Q.content.length,!(Y<4096)&&(Q.start=q,ne(Y+511>>9)));for(ne(F[6]+7>>3);L.l&511;)L.write_shift(-4,ee.ENDOFCHAIN);for(q=M=0,X=0;X<T.FileIndex.length;++X)Q=T.FileIndex[X],Q.content&&(Y=Q.content.length,!(!Y||Y>=4096)&&(Q.start=q,ne(Y+63>>6)));for(;L.l&511;)L.write_shift(-4,ee.ENDOFCHAIN);for(M=0;M<F[4]<<2;++M){var ue=T.FullPaths[M];if(!ue||ue.length===0){for(X=0;X<17;++X)L.write_shift(4,0);for(X=0;X<3;++X)L.write_shift(4,-1);for(X=0;X<12;++X)L.write_shift(4,0);continue}Q=T.FileIndex[M],M===0&&(Q.start=Q.size?Q.start-1:V);var ve=M===0&&j.root||Q.name;if(Y=2*(ve.length+1),L.write_shift(64,ve,"utf16le"),L.write_shift(2,Y),L.write_shift(1,Q.type),L.write_shift(1,Q.color),L.write_shift(-4,Q.L),L.write_shift(-4,Q.R),L.write_shift(-4,Q.C),Q.clsid)L.write_shift(16,Q.clsid,"hex");else for(X=0;X<4;++X)L.write_shift(4,0);L.write_shift(4,Q.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Q.start),L.write_shift(4,Q.size),L.write_shift(4,0)}for(M=1;M<T.FileIndex.length;++M)if(Q=T.FileIndex[M],Q.size>=4096)if(L.l=Q.start+1<<9,De&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+511&-512;else{for(X=0;X<Q.size;++X)L.write_shift(1,Q.content[X]);for(;X&511;++X)L.write_shift(1,0)}for(M=1;M<T.FileIndex.length;++M)if(Q=T.FileIndex[M],Q.size>0&&Q.size<4096)if(De&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+63&-64;else{for(X=0;X<Q.size;++X)L.write_shift(1,Q.content[X]);for(;X&63;++X)L.write_shift(1,0)}if(De)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function H(T,D){var j=T.FullPaths.map(function(X){return X.toUpperCase()}),F=j.map(function(X){var Y=X.split("/");return Y[Y.length-(X.slice(-1)=="/"?2:1)]}),L=!1;D.charCodeAt(0)===47?(L=!0,D=j[0].slice(0,-1)+D):L=D.indexOf("/")!==-1;var M=D.toUpperCase(),q=L===!0?j.indexOf(M):F.indexOf(M);if(q!==-1)return T.FileIndex[q];var ne=!M.match(xo);for(M=M.replace(hr,""),ne&&(M=M.replace(xo,"!")),q=0;q<j.length;++q)if((ne?j[q].replace(xo,"!"):j[q]).replace(hr,"")==M||(ne?F[q].replace(xo,"!"):F[q]).replace(hr,"")==M)return T.FileIndex[q];return null}var b=64,V=-2,J="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(T,D,j){u();var F=U(T,j);l.writeFileSync(D,F)}function B(T){for(var D=new Array(T.length),j=0;j<T.length;++j)D[j]=String.fromCharCode(T[j]);return D.join("")}function ae(T,D){var j=U(T,D);switch(D&&D.type||"buffer"){case"file":return u(),l.writeFileSync(D.filename,j),j;case"binary":return typeof j=="string"?j:B(j);case"base64":return cl(typeof j=="string"?j:B(j));case"buffer":if(De)return Buffer.isBuffer(j)?j:la(j);case"array":return typeof j=="string"?Or(j):j}return j}var de;function R(T){try{var D=T.InflateRaw,j=new D;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)de=T;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function z(T,D){if(!de)return Ep(T,D);var j=de.InflateRaw,F=new j,L=F._processChunk(T.slice(T.l),F._finishFlushFlag);return T.l+=F.bytesRead,L}function O(T){return de?de.deflateRawSync(T):Le(T)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(T){var D=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(D>>16|D>>8|D)&255}for(var le=typeof Uint8Array<"u",ie=le?new Uint8Array(256):[],ce=0;ce<256;++ce)ie[ce]=oe(ce);function I(T,D){var j=ie[T&255];return D<=8?j>>>8-D:(j=j<<8|ie[T>>8&255],D<=16?j>>>16-D:(j=j<<8|ie[T>>16&255],j>>>24-D))}function je(T,D){var j=D&7,F=D>>>3;return(T[F]|(j<=6?0:T[F+1]<<8))>>>j&3}function Re(T,D){var j=D&7,F=D>>>3;return(T[F]|(j<=5?0:T[F+1]<<8))>>>j&7}function He(T,D){var j=D&7,F=D>>>3;return(T[F]|(j<=4?0:T[F+1]<<8))>>>j&15}function Oe(T,D){var j=D&7,F=D>>>3;return(T[F]|(j<=3?0:T[F+1]<<8))>>>j&31}function ge(T,D){var j=D&7,F=D>>>3;return(T[F]|(j<=1?0:T[F+1]<<8))>>>j&127}function nt(T,D,j){var F=D&7,L=D>>>3,M=(1<<j)-1,q=T[L]>>>F;return j<8-F||(q|=T[L+1]<<8-F,j<16-F)||(q|=T[L+2]<<16-F,j<24-F)||(q|=T[L+3]<<24-F),q&M}function xr(T,D,j){var F=D&7,L=D>>>3;return F<=5?T[L]|=(j&7)<<F:(T[L]|=j<<F&255,T[L+1]=(j&7)>>8-F),D+3}function _n(T,D,j){var F=D&7,L=D>>>3;return j=(j&1)<<F,T[L]|=j,D+1}function Bn(T,D,j){var F=D&7,L=D>>>3;return j<<=F,T[L]|=j&255,j>>>=8,T[L+1]=j,D+8}function Vi(T,D,j){var F=D&7,L=D>>>3;return j<<=F,T[L]|=j&255,j>>>=8,T[L+1]=j&255,T[L+2]=j>>>8,D+16}function fa(T,D){var j=T.length,F=2*j>D?2*j:D+5,L=0;if(j>=D)return T;if(De){var M=gx(F);if(T.copy)T.copy(M);else for(;L<T.length;++L)M[L]=T[L];return M}else if(le){var q=new Uint8Array(F);if(q.set)q.set(T);else for(;L<j;++L)q[L]=T[L];return q}return T.length=F,T}function br(T){for(var D=new Array(T),j=0;j<T;++j)D[j]=0;return D}function Un(T,D,j){var F=1,L=0,M=0,q=0,ne=0,X=T.length,Y=le?new Uint16Array(32):br(32);for(M=0;M<32;++M)Y[M]=0;for(M=X;M<j;++M)T[M]=0;X=T.length;var Q=le?new Uint16Array(X):br(X);for(M=0;M<X;++M)Y[L=T[M]]++,F<L&&(F=L),Q[M]=0;for(Y[0]=0,M=1;M<=F;++M)Y[M+16]=ne=ne+Y[M-1]<<1;for(M=0;M<X;++M)ne=T[M],ne!=0&&(Q[M]=Y[ne+16]++);var ue=0;for(M=0;M<X;++M)if(ue=T[M],ue!=0)for(ne=I(Q[M],F)>>F-ue,q=(1<<F+4-ue)-1;q>=0;--q)D[ne|q<<ue]=ue&15|M<<4;return F}var da=le?new Uint16Array(512):br(512),Gi=le?new Uint16Array(32):br(32);if(!le){for(var lr=0;lr<512;++lr)da[lr]=0;for(lr=0;lr<32;++lr)Gi[lr]=0}(function(){for(var T=[],D=0;D<32;D++)T.push(5);Un(T,Gi,32);var j=[];for(D=0;D<=143;D++)j.push(8);for(;D<=255;D++)j.push(9);for(;D<=279;D++)j.push(7);for(;D<=287;D++)j.push(8);Un(j,da,288)})();var kn=function(){for(var D=le?new Uint8Array(32768):[],j=0,F=0;j<re.length-1;++j)for(;F<re[j+1];++F)D[F]=j;for(;F<32768;++F)D[F]=29;var L=le?new Uint8Array(259):[];for(j=0,F=0;j<K.length-1;++j)for(;F<K[j+1];++F)L[F]=j;function M(ne,X){for(var Y=0;Y<ne.length;){var Q=Math.min(65535,ne.length-Y),ue=Y+Q==ne.length;for(X.write_shift(1,+ue),X.write_shift(2,Q),X.write_shift(2,~Q&65535);Q-- >0;)X[X.l++]=ne[Y++]}return X.l}function q(ne,X){for(var Y=0,Q=0,ue=le?new Uint16Array(32768):[];Q<ne.length;){var ve=Math.min(65535,ne.length-Q);if(ve<10){for(Y=xr(X,Y,+(Q+ve==ne.length)),Y&7&&(Y+=8-(Y&7)),X.l=Y/8|0,X.write_shift(2,ve),X.write_shift(2,~ve&65535);ve-- >0;)X[X.l++]=ne[Q++];Y=X.l*8;continue}Y=xr(X,Y,+(Q+ve==ne.length)+2);for(var we=0;ve-- >0;){var he=ne[Q];we=(we<<5^he)&32767;var ye=-1,Fe=0;if((ye=ue[we])&&(ye|=Q&-32768,ye>Q&&(ye-=32768),ye<Q))for(;ne[ye+Fe]==ne[Q+Fe]&&Fe<250;)++Fe;if(Fe>2){he=L[Fe],he<=22?Y=Bn(X,Y,ie[he+1]>>1)-1:(Bn(X,Y,3),Y+=5,Bn(X,Y,ie[he-23]>>5),Y+=3);var it=he<8?0:he-4>>2;it>0&&(Vi(X,Y,Fe-K[he]),Y+=it),he=D[Q-ye],Y=Bn(X,Y,ie[he]>>3),Y-=3;var ot=he<4?0:he-2>>1;ot>0&&(Vi(X,Y,Q-ye-re[he]),Y+=ot);for(var qt=0;qt<Fe;++qt)ue[we]=Q&32767,we=(we<<5^ne[Q])&32767,++Q;ve-=Fe-1}else he<=143?he=he+48:Y=_n(X,Y,1),Y=Bn(X,Y,ie[he]),ue[we]=Q&32767,++Q}Y=Bn(X,Y,0)-1}return X.l=(Y+7)/8|0,X.l}return function(X,Y){return X.length<8?M(X,Y):q(X,Y)}}();function Le(T){var D=te(50+Math.floor(T.length*1.1)),j=kn(T,D);return D.slice(0,j)}var yt=le?new Uint16Array(32768):br(32768),Wr=le?new Uint16Array(32768):br(32768),At=le?new Uint16Array(128):br(128),Xa=1,Sp=1;function B2(T,D){var j=Oe(T,D)+257;D+=5;var F=Oe(T,D)+1;D+=5;var L=He(T,D)+4;D+=4;for(var M=0,q=le?new Uint8Array(19):br(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,Y=le?new Uint8Array(8):br(8),Q=le?new Uint8Array(8):br(8),ue=q.length,ve=0;ve<L;++ve)q[P[ve]]=M=Re(T,D),X<M&&(X=M),Y[M]++,D+=3;var we=0;for(Y[0]=0,ve=1;ve<=X;++ve)Q[ve]=we=we+Y[ve-1]<<1;for(ve=0;ve<ue;++ve)(we=q[ve])!=0&&(ne[ve]=Q[we]++);var he=0;for(ve=0;ve<ue;++ve)if(he=q[ve],he!=0){we=ie[ne[ve]]>>8-he;for(var ye=(1<<7-he)-1;ye>=0;--ye)At[we|ye<<he]=he&7|ve<<3}var Fe=[];for(X=1;Fe.length<j+F;)switch(we=At[ge(T,D)],D+=we&7,we>>>=3){case 16:for(M=3+je(T,D),D+=2,we=Fe[Fe.length-1];M-- >0;)Fe.push(we);break;case 17:for(M=3+Re(T,D),D+=3;M-- >0;)Fe.push(0);break;case 18:for(M=11+ge(T,D),D+=7;M-- >0;)Fe.push(0);break;default:Fe.push(we),X<we&&(X=we);break}var it=Fe.slice(0,j),ot=Fe.slice(j);for(ve=j;ve<286;++ve)it[ve]=0;for(ve=F;ve<30;++ve)ot[ve]=0;return Xa=Un(it,yt,286),Sp=Un(ot,Wr,30),D}function U2(T,D){if(T[0]==3&&!(T[1]&3))return[La(D),2];for(var j=0,F=0,L=gx(D||1<<18),M=0,q=L.length>>>0,ne=0,X=0;!(F&1);){if(F=Re(T,j),j+=3,F>>>1)F>>1==1?(ne=9,X=5):(j=B2(T,j),ne=Xa,X=Sp);else{j&7&&(j+=8-(j&7));var Y=T[j>>>3]|T[(j>>>3)+1]<<8;if(j+=32,Y>0)for(!D&&q<M+Y&&(L=fa(L,M+Y),q=L.length);Y-- >0;)L[M++]=T[j>>>3],j+=8;continue}for(;;){!D&&q<M+32767&&(L=fa(L,M+32767),q=L.length);var Q=nt(T,j,ne),ue=F>>>1==1?da[Q]:yt[Q];if(j+=ue&15,ue>>>=4,!(ue>>>8&255))L[M++]=ue;else{if(ue==256)break;ue-=257;var ve=ue<8?0:ue-4>>2;ve>5&&(ve=0);var we=M+K[ue];ve>0&&(we+=nt(T,j,ve),j+=ve),Q=nt(T,j,X),ue=F>>>1==1?Gi[Q]:Wr[Q],j+=ue&15,ue>>>=4;var he=ue<4?0:ue-2>>1,ye=re[ue];for(he>0&&(ye+=nt(T,j,he),j+=he),!D&&q<we&&(L=fa(L,we+100),q=L.length);M<we;)L[M]=L[M-ye],++M}}}return D?[L,j+7>>>3]:[L.slice(0,M),j+7>>>3]}function Ep(T,D){var j=T.slice(T.l||0),F=U2(j,D);return T.l+=F[1],F[0]}function bp(T,D){if(T)typeof console<"u"&&console.error(D);else throw new Error(D)}function Tp(T,D){var j=T;Vt(j,0);var F=[],L=[],M={FileIndex:F,FullPaths:L};S(M,{root:D.root});for(var q=j.length-4;(j[q]!=80||j[q+1]!=75||j[q+2]!=5||j[q+3]!=6)&&q>=0;)--q;j.l=q+4,j.l+=4;var ne=j.read_shift(2);j.l+=6;var X=j.read_shift(4);for(j.l=X,q=0;q<ne;++q){j.l+=20;var Y=j.read_shift(4),Q=j.read_shift(4),ue=j.read_shift(2),ve=j.read_shift(2),we=j.read_shift(2);j.l+=8;var he=j.read_shift(4),ye=o(j.slice(j.l+ue,j.l+ue+ve));j.l+=ue+ve+we;var Fe=j.l;j.l=he+4,$2(j,Y,Q,M,ye),j.l=Fe}return M}function $2(T,D,j,F,L){T.l+=2;var M=T.read_shift(2),q=T.read_shift(2),ne=i(T);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var X=T.read_shift(4),Y=T.read_shift(4),Q=T.read_shift(4),ue=T.read_shift(2),ve=T.read_shift(2),we="",he=0;he<ue;++he)we+=String.fromCharCode(T[T.l++]);if(ve){var ye=o(T.slice(T.l,T.l+ve));(ye[21589]||{}).mt&&(ne=ye[21589].mt),((L||{})[21589]||{}).mt&&(ne=L[21589].mt)}T.l+=ve;var Fe=T.slice(T.l,T.l+Y);switch(q){case 8:Fe=z(T,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var it=!1;M&8&&(X=T.read_shift(4),X==134695760&&(X=T.read_shift(4),it=!0),Y=T.read_shift(4),Q=T.read_shift(4)),Y!=D&&bp(it,"Bad compressed size: "+D+" != "+Y),Q!=j&&bp(it,"Bad uncompressed size: "+j+" != "+Q),s0(F,we,Fe,{unsafe:!0,mt:ne})}function z2(T,D){var j=D||{},F=[],L=[],M=te(1),q=j.compression?8:0,ne=0,X=0,Y=0,Q=0,ue=0,ve=T.FullPaths[0],we=ve,he=T.FileIndex[0],ye=[],Fe=0;for(X=1;X<T.FullPaths.length;++X)if(we=T.FullPaths[X].slice(ve.length),he=T.FileIndex[X],!(!he.size||!he.content||we=="Sh33tJ5")){var it=Q,ot=te(we.length);for(Y=0;Y<we.length;++Y)ot.write_shift(1,we.charCodeAt(Y)&127);ot=ot.slice(0,ot.l),ye[ue]=SC.buf(he.content,0);var qt=he.content;q==8&&(qt=O(qt)),M=te(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,ne),M.write_shift(2,q),he.mt?s(M,he.mt):M.write_shift(4,0),M.write_shift(-4,ye[ue]),M.write_shift(4,qt.length),M.write_shift(4,he.content.length),M.write_shift(2,ot.length),M.write_shift(2,0),Q+=M.length,F.push(M),Q+=ot.length,F.push(ot),Q+=qt.length,F.push(qt),M=te(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,ne),M.write_shift(2,q),M.write_shift(4,0),M.write_shift(-4,ye[ue]),M.write_shift(4,qt.length),M.write_shift(4,he.content.length),M.write_shift(2,ot.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,it),Fe+=M.l,L.push(M),Fe+=ot.length,L.push(ot),++ue}return M=te(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ue),M.write_shift(2,ue),M.write_shift(4,Fe),M.write_shift(4,Q),M.write_shift(2,0),Lt([Lt(F),Lt(L),M])}var $l={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function W2(T,D){if(T.ctype)return T.ctype;var j=T.name||"",F=j.match(/\.([^\.]+)$/);return F&&$l[F[1]]||D&&(F=(j=D).match(/[\.\\]([^\.\\])+$/),F&&$l[F[1]])?$l[F[1]]:"application/octet-stream"}function H2(T){for(var D=cl(T),j=[],F=0;F<D.length;F+=76)j.push(D.slice(F,F+76));return j.join(`\r
`)+`\r
`}function V2(T){var D=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Q=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],F=D.split(`\r
`),L=0;L<F.length;++L){var M=F[L];if(M.length==0){j.push("");continue}for(var q=0;q<M.length;){var ne=76,X=M.slice(q,q+ne);X.charAt(ne-1)=="="?ne--:X.charAt(ne-2)=="="?ne-=2:X.charAt(ne-3)=="="&&(ne-=3),X=M.slice(q,q+ne),q+=ne,q<M.length&&(X+="="),j.push(X)}}return j.join(`\r
`)}function G2(T){for(var D=[],j=0;j<T.length;++j){for(var F=T[j];j<=T.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+T[++j];D.push(F)}for(var L=0;L<D.length;++L)D[L]=D[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Or(D.join(`\r
`))}function K2(T,D,j){for(var F="",L="",M="",q,ne=0;ne<10;++ne){var X=D[ne];if(!X||X.match(/^\s*$/))break;var Y=X.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":F=Y[2].trim();break;case"content-type":M=Y[2].trim();break;case"content-transfer-encoding":L=Y[2].trim();break}}switch(++ne,L.toLowerCase()){case"base64":q=Or(Mr(D.slice(ne).join("")));break;case"quoted-printable":q=G2(D.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Q=s0(T,F.slice(j.length),q,{unsafe:!0});M&&(Q.ctype=M)}function X2(T,D){if(B(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=D&&D.root||"",F=(De&&Buffer.isBuffer(T)?T.toString("binary"):B(T)).split(`\r
`),L=0,M="";for(L=0;L<F.length;++L)if(M=F[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),j||(j=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),M.slice(0,j.length)!=j););var q=(F[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var ne="--"+(q[1]||""),X=[],Y=[],Q={FileIndex:X,FullPaths:Y};S(Q);var ue,ve=0;for(L=0;L<F.length;++L){var we=F[L];we!==ne&&we!==ne+"--"||(ve++&&K2(Q,F.slice(ue,L),j),ue=L)}return Q}function q2(T,D){var j=D||{},F=j.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],M=T.FullPaths[0],q=M,ne=T.FileIndex[0],X=1;X<T.FullPaths.length;++X)if(q=T.FullPaths[X].slice(M.length),ne=T.FileIndex[X],!(!ne.size||!ne.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var Y=ne.content,Q=De&&Buffer.isBuffer(Y)?Y.toString("binary"):B(Y),ue=0,ve=Math.min(1024,Q.length),we=0,he=0;he<=ve;++he)(we=Q.charCodeAt(he))>=32&&we<128&&++ue;var ye=ue>=ve*4/5;L.push(F),L.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+q),L.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),L.push("Content-Type: "+W2(ne,q)),L.push(""),L.push(ye?V2(Q):H2(Q))}return L.push(F+`--\r
`),L.join(`\r
`)}function Y2(T){var D={};return S(D,T),D}function s0(T,D,j,F){var L=F&&F.unsafe;L||S(T);var M=!L&&Ee.find(T,D);if(!M){var q=T.FullPaths[0];D.slice(0,q.length)==q?q=D:(q.slice(-1)!="/"&&(q+="/"),q=(q+D).replace("//","/")),M={name:a(D),type:2},T.FileIndex.push(M),T.FullPaths.push(q),L||Ee.utils.cfb_gc(T)}return M.content=j,M.size=j?j.length:0,F&&(F.CLSID&&(M.clsid=F.CLSID),F.mt&&(M.mt=F.mt),F.ct&&(M.ct=F.ct)),M}function J2(T,D){S(T);var j=Ee.find(T,D);if(j){for(var F=0;F<T.FileIndex.length;++F)if(T.FileIndex[F]==j)return T.FileIndex.splice(F,1),T.FullPaths.splice(F,1),!0}return!1}function Q2(T,D,j){S(T);var F=Ee.find(T,D);if(F){for(var L=0;L<T.FileIndex.length;++L)if(T.FileIndex[L]==F)return T.FileIndex[L].name=a(j),T.FullPaths[L]=j,!0}return!1}function Z2(T){A(T,!0)}return t.find=H,t.read=E,t.parse=f,t.write=ae,t.writeFile=G,t.utils={cfb_new:Y2,cfb_add:s0,cfb_del:J2,cfb_mov:Q2,cfb_gc:Z2,ReadShift:Ao,CheckField:cw,prep_blob:Vt,bconcat:Lt,use_zlib:R,_deflateRaw:Le,_inflateRaw:Ep,consts:ee},t}();function EC(e){return typeof e=="string"?Ju(e):Array.isArray(e)?Y3(e):e}function Ol(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ju(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?An(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([EC(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Va(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function bC(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function vt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function bx(e,t){for(var r=[],n=vt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Qu(e){for(var t=[],r=vt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Zu(e){for(var t=[],r=vt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function TC(e){for(var t=[],r=vt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var gu=new Date(1899,11,30,0,0,0);function Pt(e,t){var r=e.getTime(),n=gu.getTime()+(e.getTimezoneOffset()-gu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var zy=new Date,NC=gu.getTime()+(zy.getTimezoneOffset()-gu.getTimezoneOffset())*6e4,Tx=zy.getTimezoneOffset();function e0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+NC),t.getTimezoneOffset()!==Tx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Tx)*6e4),t}function CC(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Nx=new Date("2017-02-19T19:06:09.000Z"),Wy=isNaN(Nx.getFullYear())?new Date("2/19/17"):Nx,AC=Wy.getFullYear()==2017;function tt(e,t){var r=new Date(e);if(AC)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Wy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ks(e,t){if(De&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return An(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return An(Ay(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return An(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return An(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function rt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=rt(e[r]));return t}function xt(e,t){for(var r="";r.length<t;)r+=e;return r}function vn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var jC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&jC.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var FC=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function Hy(e){return e?e.content&&e.type?ks(e.content,!0):e.data?mo(e.data):e.asNodeBuffer&&De?mo(e.asNodeBuffer().toString("binary")):e.asBinary?mo(e.asBinary()):e._data&&e._data.getContent?mo(ks(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Vy(e){if(!e)return null;if(e.data)return mx(e.data);if(e.asNodeBuffer&&De)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?mx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function RC(e){return e&&e.name.slice(-4)===".bin"?Vy(e):Hy(e)}function Xr(e,t){for(var r=e.FullPaths||vt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function zh(e,t){var r=Xr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function bt(e,t,r){if(!r)return RC(zh(e,t));if(!t)return null;try{return bt(e,t)}catch{return null}}function Pr(e,t,r){if(!r)return Hy(zh(e,t));if(!t)return null;try{return Pr(e,t)}catch{return null}}function OC(e,t,r){return Vy(zh(e,t))}function Cx(e){for(var t=e.FullPaths||vt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ie(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return De?n=la(r):n=J3(r),Ee.utils.cfb_add(e,t,n)}Ee.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wh(){return Ee.utils.cfb_new()}function Gy(e,t){switch(t.type){case"base64":return Ee.read(e,{type:"base64"});case"binary":return Ee.read(e,{type:"binary"});case"buffer":case"array":return Ee.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function go(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var St=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,PC=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ax=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,IC=/<[^>]*>/g,or=St.match(Ax)?Ax:IC,DC=/<\w*:/,LC=/<(\/?)\w+:/;function Ae(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(PC),o=0,l="",u=0,f="",d="",h=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var x=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[x]&&f.slice(o-3,o)=="ext")continue;n[x]=l,n[x.toLowerCase()]=l}}return n}function Ln(e){return e.replace(LC,"<$1")}var Ky={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Hh=Qu(Ky),$e=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return Ky[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Vh=/[&<>'"]/g,MC=/[\u0000-\u0008\u000b-\u001f]/g;function Ke(e){var t=e+"";return t.replace(Vh,function(r){return Hh[r]}).replace(MC,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jx(e){return Ke(e).replace(/ /g,"_x0020_")}var Xy=/[\u0000-\u001f]/g;function Gh(e){var t=e+"";return t.replace(Vh,function(r){return Hh[r]}).replace(/\n/g,"<br/>").replace(Xy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function BC(e){var t=e+"";return t.replace(Vh,function(r){return Hh[r]}).replace(Xy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Fx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function UC(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ze(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function G0(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Rx(e){var t=La(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Ox(e){return la(e,"binary").toString("utf8")}var hc="foo bar baz",qe=De&&(Ox(hc)==G0(hc)&&Ox||Rx(hc)==G0(hc)&&Rx)||G0,An=De?function(e){return la(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},fl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),qy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),$C=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),zC=/<\/?(?:vt:)?variant>/g,WC=/<(?:vt:)([^>]*)>([\s\S]*)</;function Px(e,t){var r=Ae(e),n=e.match($C(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(zC,"").match(WC);i&&a.push({v:qe(i[2]),t:i[1]})}),a}var Yy=/(^\s|\s$|\n)/;function Gt(e,t){return"<"+e+(t.match(Yy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function dl(e){return vt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pe(e,t,r){return"<"+e+(r!=null?dl(r):"")+(t!=null?(t.match(Yy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function hd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HC(e,t){switch(typeof e){case"string":var r=pe("vt:lpwstr",Ke(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return pe((e|0)==e?"vt:i4":"vt:r8",Ke(String(e)));case"boolean":return pe("vt:bool",e?"true":"false")}if(e instanceof Date)return pe("vt:filetime",hd(e));throw new Error("Unable to serialize "+e)}function Kh(e){if(De&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qe(Va(Bh(e)));throw new Error("Bad input format: expected Buffer or string")}var hl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function VC(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function GC(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Ix=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Dx=De?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:la(t)})):Ix(e)}:Ix,Lx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Kn(e,a)));return n.join("").replace(hr,"")},Xh=De?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(hr,""):Lx(e,t,r)}:Lx,Mx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Jy=De?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Mx(e,t,r)}:Mx,Bx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ys(e,a)));return n.join("")},Pl=De?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Bx(t,r,n)}:Bx,Qy=function(e,t){var r=jr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},Zy=Qy,ew=function(e,t){var r=jr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},tw=ew,rw=function(e,t){var r=2*jr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},nw=rw,aw=function(t,r){var n=jr(t,r);return n>0?Xh(t,r+4,r+4+n):""},sw=aw,iw=function(e,t){var r=jr(e,t);return r>0?Pl(e,t+4,t+4+r):""},ow=iw,lw=function(e,t){return VC(e,t)},vu=lw,qh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};De&&(Zy=function(t,r){if(!Buffer.isBuffer(t))return Qy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},tw=function(t,r){if(!Buffer.isBuffer(t))return ew(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},nw=function(t,r){if(!Buffer.isBuffer(t))return rw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},sw=function(t,r){if(!Buffer.isBuffer(t))return aw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},ow=function(t,r){if(!Buffer.isBuffer(t))return iw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):lw(t,r)},qh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ys=function(e,t){return e[t]},Kn=function(e,t){return e[t+1]*256+e[t]},KC=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},jr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},as=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},XC=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ao(e,t){var r="",n,a,s=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,De&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Kn(this,u)),u+=2;e*=2;break;case"utf8":r=Pl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Xh(this,this.l,this.l+e);break;case"wstr":return Ao.call(this,e,"dbcs");case"lpstr-ansi":r=Zy(this,this.l),e=4+jr(this,this.l);break;case"lpstr-cp":r=tw(this,this.l),e=4+jr(this,this.l);break;case"lpwstr":r=nw(this,this.l),e=4+2*jr(this,this.l);break;case"lpp4":e=4+jr(this,this.l),r=sw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+jr(this,this.l),r=ow(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ys(this,this.l+e++))!==0;)s.push(dc(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Kn(this,this.l+e))!==0;)s.push(dc(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ys(this,u),this.l=u+1,o=Ao.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(Kn(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ys(this,u),this.l=u+1,o=Ao.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(Ys(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Ys(this,this.l),this.l++,n;case 2:return n=(t==="i"?KC:Kn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?as:XC)(this,this.l),this.l+=4,n):(a=jr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=vu(this,this.l):a=vu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Jy(this,this.l,e);break}}return this.l+=e,r}var qC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},YC=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},JC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function QC(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)JC(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,qC(this,t,this.l);break;case 8:if(n=8,r==="f"){GC(this,t,this.l);break}case 16:break;case-4:n=4,YC(this,t,this.l);break}return this.l+=n,this}function cw(e,t){var r=Jy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Vt(e,t){e.l=t,e.read_shift=Ao,e.chk=cw,e.write_shift=QC}function ir(e,t){e.l+=t}function te(e){var t=La(e);return Vt(t,0),t}function ca(e,t,r){if(e){var n,a,s;Vt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=yl[o]||yl[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=u.f&&u.f(e,s,r);if(e.l=l,t(f,u,o))return}}}function Sr(){var e=[],t=De?256:2048,r=function(u){var f=te(u);return Vt(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),Lt(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function se(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=yl[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&qh(r)&&e.push(r)}}function jo(e,t,r){var n=rt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ux(e,t,r){var n=rt(e);return n.s=jo(n.s,t.s,r),n.e=jo(n.e,t.s,r),n}function Fo(e,t){if(e.cRel&&e.c<0)for(e=rt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=rt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ce(e);return!e.cRel&&e.cRel!=null&&(r=tA(r)),!e.rRel&&e.rRel!=null&&(r=ZC(r)),r}function K0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ut(e.s.c)+":"+(e.e.cRel?"":"$")+ut(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kt(e.s.r)+":"+(e.e.rRel?"":"$")+kt(e.e.r):Fo(e.s,t.biff)+":"+Fo(e.e,t.biff)}function Yh(e){return parseInt(eA(e),10)-1}function kt(e){return""+(e+1)}function ZC(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eA(e){return e.replace(/\$(\d+)$/,"$1")}function Jh(e){for(var t=rA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ut(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tA(e){return e.replace(/^([A-Z])/,"$$$1")}function rA(e){return e.replace(/^\$([A-Z])/,"$1")}function nA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ft(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ce(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Er(e){var t=e.indexOf(":");return t==-1?{s:ft(e),e:ft(e)}:{s:ft(e.slice(0,t)),e:ft(e.slice(t+1))}}function Pe(e,t){return typeof t>"u"||typeof t=="number"?Pe(e.s,e.e):(typeof e!="string"&&(e=Ce(e)),typeof t!="string"&&(t=Ce(t)),e==t?e:e+":"+t)}function ze(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function $x(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Br(e.z,r?Pt(t):t)}catch{}try{return e.w=Br((e.XF||{}).numFmtId||(r?14:0),r?Pt(t):t)}catch{return""+t}}function aa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ua[e.v]||e.v:t==null?$x(e,e.v):$x(e,t))}function Ga(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function uw(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ze(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var x={v:t[d][h]},g=i+d,m=o+h;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))x=t[d][h];else if(Array.isArray(x.v)&&(x.f=t[d][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||be[14],n.cellDates?(x.t="d",x.w=Br(x.z,Pt(x.v))):(x.t="n",x.v=Pt(x.v),x.w=Br(x.z,x.v))):x.t="s";if(a)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(x.z=s[g][m].z),s[g][m]=x;else{var p=Ce({c:m,r:g});s[p]&&s[p].z&&(x.z=s[p].z),s[p]=x}}}return u.s.c<1e7&&(s["!ref"]=Pe(u)),s}function Wi(e,t){return uw(null,e,t)}function aA(e){return e.read_shift(4,"i")}function yn(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function ar(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Mt(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function sA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function iA(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Qh(e,t){var r=e.l,n=e.read_shift(1),a=ar(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(sA(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function oA(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),Mt(e.t,t),r?t.slice(0,t.l):t}var lA=Qh;function cA(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),Mt(e.t,t),t.write_shift(4,1),iA({},t),r?t.slice(0,t.l):t}function an(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Rs(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Os(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ps(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var uA=ar,fw=Mt;function Zh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yu(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fA=ar,pd=Zh,ep=yu;function tp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?vu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):as(t,0)>>2;return r?a/100:a}function dw(e,t){t==null&&(t=te(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function hw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function dA(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Is=hw,Hi=dA;function nr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ss(e,t){return(t||te(8)).write_shift(8,e,"f")}function hA(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=ds[a];u&&(t.rgb=ml(u));break;case 2:t.rgb=ml([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function wu(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function pA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function mA(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function pw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function xA(e){return pw(e,1)}function gA(e){return pw(e,2)}var rp=2,gr=3,pc=11,zx=12,_u=19,mc=64,vA=65,yA=71,wA=4108,_A=4126,It=80,mw=81,kA=[It,mw],md={1:{n:"CodePage",t:rp},2:{n:"Category",t:It},3:{n:"PresentationFormat",t:It},4:{n:"ByteCount",t:gr},5:{n:"LineCount",t:gr},6:{n:"ParagraphCount",t:gr},7:{n:"SlideCount",t:gr},8:{n:"NoteCount",t:gr},9:{n:"HiddenCount",t:gr},10:{n:"MultimediaClipCount",t:gr},11:{n:"ScaleCrop",t:pc},12:{n:"HeadingPairs",t:wA},13:{n:"TitlesOfParts",t:_A},14:{n:"Manager",t:It},15:{n:"Company",t:It},16:{n:"LinksUpToDate",t:pc},17:{n:"CharacterCount",t:gr},19:{n:"SharedDoc",t:pc},22:{n:"HyperlinksChanged",t:pc},23:{n:"AppVersion",t:gr,p:"version"},24:{n:"DigSig",t:vA},26:{n:"ContentType",t:It},27:{n:"ContentStatus",t:It},28:{n:"Language",t:It},29:{n:"Version",t:It},255:{},2147483648:{n:"Locale",t:_u},2147483651:{n:"Behavior",t:_u},1919054434:{}},xd={1:{n:"CodePage",t:rp},2:{n:"Title",t:It},3:{n:"Subject",t:It},4:{n:"Author",t:It},5:{n:"Keywords",t:It},6:{n:"Comments",t:It},7:{n:"Template",t:It},8:{n:"LastAuthor",t:It},9:{n:"RevNumber",t:It},10:{n:"EditTime",t:mc},11:{n:"LastPrinted",t:mc},12:{n:"CreatedDate",t:mc},13:{n:"ModifiedDate",t:mc},14:{n:"PageCount",t:gr},15:{n:"WordCount",t:gr},16:{n:"CharCount",t:gr},17:{n:"Thumbnail",t:yA},18:{n:"Application",t:It},19:{n:"DocSecurity",t:gr},255:{},2147483648:{n:"Locale",t:_u},2147483651:{n:"Behavior",t:_u},1919054434:{}},Wx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},SA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function EA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var bA=EA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ds=rt(bA),ua={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function np(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function TA(e){var t=np();if(!e||!e.match)return t;var r={};if((e.match(or)||[]).forEach(function(n){var a=Ae(n);switch(a[0].replace(DC,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[gd[a.ContentType]]!==void 0&&t[gd[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Rt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function gw(e,t){var r=TC(gd),n=[],a;n[n.length]=St,n[n.length]=pe("Types",null,{xmlns:Rt.CT,"xmlns:xsd":Rt.xsd,"xmlns:xsi":Rt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return pe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=pe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:xc[l][t.bookType]||xc[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(u){n[n.length]=pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:xc[l][t.bookType]||xc[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Me={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function pl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ro(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(or)||[]).forEach(function(a){var s=Ae(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:go(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function yi(e){var t=[St,pe("Relationships",null,{xmlns:Rt.RELS})];return vt(e["!id"]).forEach(function(r){t[t.length]=pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ge(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Me.HLINK,Me.XPATH,Me.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var NA="application/vnd.oasis.opendocument.spreadsheet";function CA(e,t){for(var r=Kh(e),n,a;n=hl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ae(n[0],!1),a.path=="/"&&a.type!==NA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function AA(e){var t=[St];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Hx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jA(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function FA(e){var t=[St];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Hx(e[r][0],e[r][1])),t.push(jA("",e[r][0]));return t.push(Hx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function vw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+hu.version+"</meta:generator></office:meta></office:document-meta>"}var en=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RA=function(){for(var e=new Array(en.length),t=0;t<en.length;++t){var r=en[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function yw(e){var t={};e=qe(e);for(var r=0;r<en.length;++r){var n=en[r],a=e.match(RA[r]);a!=null&&a.length>0&&(t[n[1]]=$e(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=tt(t[n[1]]))}return t}function X0(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ke(t),n[n.length]=r?pe(e,t,r):Gt(e,t))}function ww(e,t){var r=t||{},n=[St,pe("cp:coreProperties",null,{"xmlns:cp":Rt.CORE_PROPS,"xmlns:dc":Rt.dc,"xmlns:dcterms":Rt.dcterms,"xmlns:dcmitype":Rt.dcmitype,"xmlns:xsi":Rt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&X0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:hd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&X0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:hd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=en.length;++s){var i=en[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&X0(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_w=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kw(e,t,r,n){var a=[];if(typeof e=="string")a=Px(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Px(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function OA(e,t,r){var n={};return t||(t={}),e=qe(e),hs.forEach(function(a){var s=(e.match(fl(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=$e(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&kw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Sw(e){var t=[],r=pe;return e||(e={}),e.Application="SheetJS",t[t.length]=St,t[t.length]=pe("Properties",null,{xmlns:Rt.EXT_PROPS,"xmlns:vt":Rt.vt}),hs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ke(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ke(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var PA=/<[^>]+>[^<]*/g;function IA(e,t){var r={},n="",a=e.match(PA);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ae(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=$e(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=$e(f);break;case"bool":r[n]=Ze(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=tt(f);break;case"cy":case"error":r[n]=$e(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Ew(e){var t=[St,pe("Properties",null,{xmlns:Rt.CUST_PROPS,"xmlns:vt":Rt.vt})];if(!e)return t.join("");var r=1;return vt(e).forEach(function(a){++r,t[t.length]=pe("property",HC(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ke(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},q0;function DA(e,t,r){q0||(q0=Qu(vd)),t=q0[t]||t,e[t]=r}function LA(e,t){var r=[];return vt(vd).map(function(n){for(var a=0;a<en.length;++a)if(en[a][1]==n)return en[a];for(a=0;a<hs.length;++a)if(hs[a][1]==n)return hs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Gt(vd[n[1]]||n[1],a))}}),pe("DocumentProperties",r.join(""),{xmlns:Ar.o})}function MA(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&vt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<en.length;++i)if(s==en[i][1])return;for(i=0;i<hs.length;++i)if(s==hs[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(pe(jx(s),o,{"dt:dt":l}))}}),t&&vt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(pe(jx(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ar.o+'">'+a.join("")+"</"+n+">"}function ap(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BA(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=te(8);return i.write_shift(4,n),i.write_shift(4,a),i}function bw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Tw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Nw(e,t,r){return t===31?Tw(e):bw(e,t,r)}function yd(e,t,r){return Nw(e,t,r===!1?0:4)}function UA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Nw(e,t,0)}function $A(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(hr,""),e.l-a&2&&(e.l+=2)}return r}function zA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(hr,"");return r}function WA(e){var t=e.l,r=ku(e,mw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ku(e,gr);return[r,n]}function HA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(WA(e));return r}function Vx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(hr,"").replace(xo,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Cw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function VA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ku(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==zx&&n!==t&&kA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===zx?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return bw(e,n,4).replace(hr,"");case 31:return Tw(e);case 64:return ap(e);case 65:return Cw(e);case 71:return VA(e);case 80:return yd(e,n,!s.raw).replace(hr,"");case 81:return UA(e,n).replace(hr,"");case 4108:return HA(e);case 4126:case 4127:return n==4127?$A(e):zA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Gx(e,t){var r=te(4),n=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=te(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=BA(t);break;case 31:case 80:for(n=te(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Lt([r,n])}function Kx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,u={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(w,v){return w[1]-v[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var x=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(x=!1,e.l=s[i][1]),x)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[s[i][0]];if(h[g.n]=ku(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:pn(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[i][0]===1){if(o=h.CodePage=ku(e,rp),pn(o),l!==-1){var m=e.l;e.l=s[l][1],u=Vx(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}u=Vx(e,o)}else{var p=u[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=Cw(e);break;case 30:e.l+=4,y=yd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=yd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=wt(e,4);break;case 64:e.l+=4,y=tt(ap(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=y}}return e.l=r+n,h}var Aw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function GA(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xx(e,t,r){var n=te(8),a=[],s=[],i=8,o=0,l=te(8),u=te(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),a.push(u),i+=8+l.length,!t){u=te(8),u.write_shift(4,0),a.unshift(u);var f=[te(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=te(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Lt(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Aw.indexOf(e[o][0])>-1||_w.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],x=0;if(t){x=+t[e[o][0]];var g=r[x];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}l=Gx(g.t,h)}else{var p=GA(h);p==-1&&(p=31,h=String(h)),l=Gx(p,h)}s.push(l),u=te(8),u.write_shift(4,t?x:2+o),a.push(u),i+=8+l.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),Lt([n].concat(a).concat(s))}function qx(e,t,r){var n=e.content;if(!n)return{};Vt(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Ee.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Kx(n,t),h={SystemIdentifier:u};for(var x in d)h[x]=d[x];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Kx(n,null)}catch{}for(x in g)h[x]=g[x];return h.FMTID=[s,i],h}function Yx(e,t,r,n,a,s){var i=te(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ee.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=Xx(e,r,n);if(o.push(l),a){var u=Xx(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(u)}return Lt(o)}function pa(e,t){return e.read_shift(t),null}function KA(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function XA(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function wt(e,t){return e.read_shift(t)===1}function fr(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function Tt(e){return e.read_shift(2,"u")}function qr(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function jw(e,t){return XA(e,t,Tt)}function qA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Fw(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Il(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function YA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function JA(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=te(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Lt(a)}function Es(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Dl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Es(e,n,r)}function Ds(e,t,r){if(r.biff>5)return Dl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Rw(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function QA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ZA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(hr,"");return n&&(e.l+=24),a}function ej(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(hr,"");return r+i}function tj(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ZA(e);case"0303000000000000c000000000000046":return ej(e);default:throw new Error("Unsupported Moniker "+r)}}function gc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(hr,""):"";return r}function Jx(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function rj(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,u="",f,d;a&16&&(s=gc(e,r-e.l)),a&128&&(i=gc(e,r-e.l)),(a&257)===257&&(o=gc(e,r-e.l)),(a&257)===1&&(l=tj(e,r-e.l)),a&8&&(u=gc(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=ap(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return f&&(x.guid=f),d&&(x.time=d),s&&(x.Tooltip=s),x}function nj(e){var t=te(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),Jx(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Jx(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ow(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Pw(e,t){var r=Ow(e);return r[3]=0,r}function Mn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function bs(e,t,r,n){return n||(n=te(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function aj(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function sj(e,t,r){return t===0?"":Ds(e,t,r)}function ij(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Iw(e){var t=e.read_shift(2),r=tp(e);return[t,r]}function oj(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Il(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function t0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Dw(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Lw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var lj=Lw;function Mw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function cj(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function uj(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Qt(e){e.l+=2,e.l+=e.read_shift(2)}var fj={0:Qt,4:Qt,5:Qt,6:Qt,7:uj,8:Qt,9:Qt,10:Qt,11:Qt,12:Qt,13:cj,14:Qt,15:Qt,16:Qt,17:Qt,18:Qt,19:Qt,20:Qt,21:Mw};function dj(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(fj[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function vc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function sp(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=te(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function hj(e,t){return t===0||e.read_shift(2),1200}function pj(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ds(e,0,r);return e.read_shift(t+n-e.l),a}function mj(e,t){var r=!t||t.biff==8,n=te(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function xj(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gj(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Il(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function vj(e,t){var r=!t||t.biff>=8?2:1,n=te(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function yj(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(YA(e));return s.Count=n,s.Unique=a,s}function wj(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=JA(e[a]);var s=Lt([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function _j(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function kj(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Sj(e){var t=aj(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Ej(e){return e.read_shift(2),e.read_shift(4)}function Qx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function bj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function Tj(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Nj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Cj(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Aj(){}function jj(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Il(e,0,r),n}function Fj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=te(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Rj(e){var t=Mn(e);return t.isst=e.read_shift(4),t}function Oj(e,t,r,n){var a=te(10);return bs(e,t,n,a),a.write_shift(4,r),a}function Pj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Mn(e);r.biff==2&&e.l++;var s=Dl(e,n-e.l,r);return a.val=s,a}function Ij(e,t,r,n,a){var s=!a||a.biff==8,i=te(8+ +s+(1+s)*r.length);return bs(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function Dj(e,t,r){var n=e.read_shift(2),a=Ds(e,0,r);return[n,a]}function Lj(e,t,r,n){var a=r&&r.biff==5;n||(n=te(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var Mj=Ds;function Zx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function Bj(e,t){var r=t.biff==8||!t.biff?4:2,n=te(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Uj(e){var t=e.read_shift(2),r=e.read_shift(2),n=Iw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function $j(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Iw(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function zj(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function Wj(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=SA[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function Hj(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Wj(e,t,n.fStyle,r),n}function eg(e,t,r,n){var a=r&&r.biff==5;n||(n=te(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Vj(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Gj(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function tg(e,t,r){var n=Mn(e);(r.biff==2||t==9)&&++e.l;var a=qA(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Kj(e,t,r,n,a,s){var i=te(8);return bs(e,t,n,i),Fw(r,s,i),i}function Xj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Mn(e),a=nr(e);return n.val=a,n}function qj(e,t,r,n){var a=te(14);return bs(e,t,n,a),Ss(r,a),a}var rg=sj;function Yj(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Es(e,s),o=[];n>e.l;)o.push(Dl(e));return[s,a,i,o]}function ng(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=oj(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var Jj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ag(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Es(e,i,r);a&32&&(u=Jj[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:dR(e,f,r,o);return{chKey:s,Name:u,itab:l,rgce:d}}function Bw(e,t,r){if(r.biff<8)return Qj(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(ij(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Qj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Il(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Zj(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Es(e,n,r),i=Es(e,a,r);return[s,i]}function e6(e,t,r){var n=Lw(e);e.l++;var a=e.read_shift(1);return t-=8,[hR(e,t,r),a,n]}function sg(e,t,r){var n=lj(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,uR(e,t,r)]}function t6(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function r6(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ds(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function n6(e,t,r){return r6(e,t,r)}function a6(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(t0(e));return r}function s6(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Dw(e[r],t);return t}function i6(e,t,r){if(r&&r.biff<8)return l6(e,t,r);var n=Mw(e),a=dj(e,t-22,n[1]);return{cmo:n,ft:a}}var o6={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function l6(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((o6[n]||ir)(e,t,r)),{cmo:[a,n,s],ft:i}}function c6(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=QA(e,6,r);var o=e.read_shift(2);e.read_shift(2),Tt(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=Es(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function u6(e,t){var r=t0(e);e.l+=16;var n=rj(e,t-24);return[r,n]}function f6(e){var t=te(24),r=ft(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Lt([t,nj(e[1])])}function d6(e,t){e.read_shift(2);var r=t0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(hr,""),[r,n]}function h6(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var n=ft(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function p6(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Wx[r]||r,r=e.read_shift(2),t[1]=Wx[r]||r,t}function m6(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function x6(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Pw(e));return r}function g6(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Pw(e));return r}function v6(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Uw(e,t,r){if(!r.cellStyles)return ir(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function y6(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function w6(e,t){var r={};return t<32||(e.l+=16,r.header=nr(e),r.footer=nr(e),e.l+=2),r}function _6(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function k6(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var S6=Mn,E6=jw,b6=Dl;function T6(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function N6(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Mn(e);++e.l;var a=Ds(e,t-7,r);return n.t="str",n.val=a,n}function C6(e){var t=Mn(e);++e.l;var r=nr(e);return t.t="n",t.val=r,t}function A6(e,t,r){var n=te(15);return Ul(n,e,t),n.write_shift(8,r,"f"),n}function j6(e){var t=Mn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function F6(e,t,r){var n=te(9);return Ul(n,e,t),n.write_shift(2,r),n}function R6(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function O6(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function P6(e,t,r){var n=e.l+t,a=Mn(e),s=e.read_shift(2),i=Es(e,s,r);return e.l=n,a.t="str",a.val=i,a}var I6=[2,3,48,49,131,139,140,245],wd=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=La(1);switch(l.type){case"base64":f=Or(Mr(o));break;case"binary":f=Or(o);break;case"buffer":case"array":f=o;break}Vt(f,0);var d=f.read_shift(1),h=!!(d&136),x=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,p=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(p=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],_={},k=Math.min(f.length,d==2?521:p-10-(x?264:0)),E=g?32:11;f.l<k&&f[f.l]!=13;)switch(_={},_.name=ll.utils.decode(w,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,_.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(_.offset=f.read_shift(4)),_.len=f.read_shift(1),d==2&&(_.offset=f.read_shift(2)),_.dec=f.read_shift(1),_.name.length&&v.push(_),d!=2&&(f.l+=g?13:14),_.type){case"B":(!x||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(f[f.l]!==13&&(f.l=p-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=p;var S=0,C=0;for(u[0]=[],C=0;C!=v.length;++C)u[0][C]=v[C].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++S]=[],C=0,C=0;C!=v.length;++C){var A=f.slice(f.l,f.l+v[C].len);f.l+=v[C].len,Vt(A,0);var U=ll.utils.decode(w,A);switch(v[C].type){case"C":U.trim().length&&(u[S][C]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[S][C]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[S][C]=U;break;case"F":u[S][C]=parseFloat(U.trim());break;case"+":case"I":u[S][C]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[S][C]=!0;break;case"N":case"F":u[S][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[S][C]="##MEMO##"+(g?parseInt(U.trim(),10):A.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[S][C]=+U||0);break;case"@":u[S][C]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[S][C]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[S][C]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][C]=-A.read_shift(-8,"f");break;case"B":if(x&&v[C].len==8){u[S][C]=A.read_shift(8,"f");break}case"G":case"P":A.l+=v[C].len;break;case"0":if(v[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[C].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=v,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Wi(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,l){try{return Ga(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&pn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Sr(),d=bu(o,{header:1,raw:!0,cellDates:!0}),h=d[0],x=d.slice(1),g=o["!cols"]||[],m=0,p=0,y=0,w=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++y;continue}if(h[m]!=null){if(++y,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(p=0;p<1024;++p)if(h.indexOf(h[m]+"_"+p)==-1){h[m]+="_"+p;break}}}}var v=ze(o["!ref"]),_=[],k=[],E=[];for(m=0;m<=v.e.c-v.s.c;++m){var S="",C="",A=0,U=[];for(p=0;p<x.length;++p)x[p][m]!=null&&U.push(x[p][m]);if(U.length==0||h[m]==null){_[m]="?";continue}for(p=0;p<U.length;++p){switch(typeof U[p]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=U[p]instanceof Date?"D":"C";break;default:C="C"}A=Math.max(A,String(U[p]).length),S=S&&S!=C?"C":C}A>250&&(A=250),C=((g[m]||{}).DBF||{}).type,C=="C"&&g[m].DBF.len>A&&(A=g[m].DBF.len),S=="B"&&C=="N"&&(S="N",E[m]=g[m].DBF.dec,A=g[m].DBF.len),k[m]=S=="C"||C=="N"?A:s[S]||0,w+=k[m],_[m]=S}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,x.length),H.write_shift(2,296+32*y),H.write_shift(2,w),m=0;m<4;++m)H.write_shift(4,0);for(H.write_shift(4,0|(+t[Cy]||3)<<8),m=0,p=0;m<h.length;++m)if(h[m]!=null){var b=f.next(32),V=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,V,"sbcs"),b.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),b.write_shift(4,p),b.write_shift(1,k[m]||s[_[m]]||0),b.write_shift(1,E[m]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),p+=k[m]||s[_[m]]||0}var J=f.next(264);for(J.write_shift(4,13),m=0;m<65;++m)J.write_shift(4,0);for(m=0;m<x.length;++m){var W=f.next(w);for(W.write_shift(1,0),p=0;p<h.length;++p)if(h[p]!=null)switch(_[p]){case"L":W.write_shift(1,x[m][p]==null?63:x[m][p]?84:70);break;case"B":W.write_shift(8,x[m][p]||0,"f");break;case"N":var Z="0";for(typeof x[m][p]=="number"&&(Z=x[m][p].toFixed(E[p]||0)),y=0;y<k[p]-Z.length;++y)W.write_shift(1,32);W.write_shift(1,Z,"sbcs");break;case"D":x[m][p]?(W.write_shift(4,("0000"+x[m][p].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(x[m][p].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+x[m][p].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(x[m][p]!=null?x[m][p]:"").slice(0,k[p]);for(W.write_shift(1,ee,"sbcs"),y=0;y<k[p]-ee.length;++y)W.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),$w=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+vt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,x){var g=e[x];return typeof g=="number"?xx(g):g},n=function(h,x,g){var m=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:xx(m)};e["|"]=254;function a(h,x){switch(x.type){case"base64":return s(Mr(h),x);case"binary":return s(h,x);case"buffer":return s(De&&Buffer.isBuffer(h)?h.toString("binary"):Va(h),x);case"array":return s(ks(h),x)}throw new Error("Unrecognized type "+x.type)}function s(h,x){var g=h.split(/[\n\r]+/),m=-1,p=-1,y=0,w=0,v=[],_=[],k=null,E={},S=[],C=[],A=[],U=0,H;for(+x.codepage>=0&&pn(+x.codepage);y!==g.length;++y){U=0;var b=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=b.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),J=V[0],W;if(b.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&_.push(b.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ee=!1,G=!1,B=!1,ae=-1,de=-1;for(w=1;w<V.length;++w)switch(V[w].charAt(0)){case"A":break;case"X":p=parseInt(V[w].slice(1))-1,ee=!0;break;case"Y":for(m=parseInt(V[w].slice(1))-1,ee||(p=0),H=v.length;H<=m;++H)v[H]=[];break;case"K":W=V[w].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(vn(W))?isNaN(Fi(W).getDate())||(W=tt(W)):(W=vn(W),k!==null&&js(k)&&(W=e0(W))),Z=!0;break;case"E":B=!0;var R=wi(V[w].slice(1),{r:m,c:p});v[m][p]=[v[m][p],R];break;case"S":G=!0,v[m][p]=[v[m][p],"S5S"];break;case"G":break;case"R":ae=parseInt(V[w].slice(1))-1;break;case"C":de=parseInt(V[w].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}if(Z&&(v[m][p]&&v[m][p].length==2?v[m][p][0]=W:v[m][p]=W,k=null),G){if(B)throw new Error("SYLK shared formula cannot have own formula");var z=ae>-1&&v[ae][de];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");v[m][p][1]=s2(z[1],{r:m-ae,c:p-de})}break;case"F":var O=0;for(w=1;w<V.length;++w)switch(V[w].charAt(0)){case"X":p=parseInt(V[w].slice(1))-1,++O;break;case"Y":for(m=parseInt(V[w].slice(1))-1,H=v.length;H<=m;++H)v[H]=[];break;case"M":U=parseInt(V[w].slice(1))/20;break;case"F":break;case"G":break;case"P":k=_[parseInt(V[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=V[w].slice(1).split(" "),H=parseInt(A[0],10);H<=parseInt(A[1],10);++H)U=parseInt(A[2],10),C[H-1]=U===0?{hidden:!0}:{wch:U},Ma(C[H-1]);break;case"C":p=parseInt(V[w].slice(1))-1,C[p]||(C[p]={});break;case"R":m=parseInt(V[w].slice(1))-1,S[m]||(S[m]={}),U>0?(S[m].hpt=U,S[m].hpx=Oi(U)):U===0&&(S[m].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}O<1&&(k=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}}return S.length>0&&(E["!rows"]=S),C.length>0&&(E["!cols"]=C),x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),[v,E]}function i(h,x){var g=a(h,x),m=g[0],p=g[1],y=Wi(m,x);return vt(p).forEach(function(w){y[w]=p[w]}),y}function o(h,x){return Ga(i(h,x),x)}function l(h,x,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":p+=h.v||0,h.f&&!h.F&&(p+=";E"+fp(h.f,{r:g,c:m}));break;case"b":p+=h.v?"TRUE":"FALSE";break;case"e":p+=h.w||h.v;break;case"d":p+='"'+(h.w||h.v)+'"';break;case"s":p+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function u(h,x){x.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=xl(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=gl(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&h.push(p)})}function f(h,x){x.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*vl(g.hpx)+";"),p.length>2&&h.push(p+"R"+(m+1))})}function d(h,x){var g=["ID;PWXL;N;E"],m=[],p=ze(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&f(g,h["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var _=p.s.r;_<=p.e.r;++_)for(var k=p.s.c;k<=p.e.c;++k){var E=Ce({r:_,c:k});y=w?(h[_]||[])[k]:h[E],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,h,_,k))}return g.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),zw=function(){function e(s,i){switch(i.type){case"base64":return t(Mr(s),i);case"binary":return t(s,i);case"buffer":return t(De&&Buffer.isBuffer(s)?s.toString("binary"):Va(s),i);case"array":return t(ks(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var h=o[f].trim().split(","),x=h[0],g=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+x){case-1:if(m==="BOT"){d[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][u]=!0:m==="FALSE"?d[l][u]=!1:isNaN(vn(g))?isNaN(Fi(g).getDate())?d[l][u]=g:d[l][u]=tt(g):d[l][u]=vn(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return Wi(e(s,i),i)}function n(s,i){return Ga(r(s,i),i)}var a=function(){var s=function(l,u,f,d,h){l.push(u),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=ze(l["!ref"]),d,h=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){i(u,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var m=Ce({r:x,c:g});if(d=h?(l[x]||[])[g]:l[m],!d){i(u,1,0,"");continue}switch(d.t){case"n":var p=d.w;!p&&d.v!=null&&(p=d.v),p==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,p,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Br(d.z||be[14],Pt(tt(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Ww=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var x=d.split(`
`),g=-1,m=-1,p=0,y=[];p!==x.length;++p){var w=x[p].trim().split(":");if(w[0]==="cell"){var v=ft(w[1]);if(y.length<=v.r)for(g=y.length;g<=v.r;++g)y[g]||(y[g]=[]);switch(g=v.r,m=v.c,w[2]){case"t":y[g][m]=e(w[3]);break;case"v":y[g][m]=+w[3];break;case"vtf":var _=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[g][m]=!!+w[4];break;default:y[g][m]=+w[4];break}w[2]=="vtf"&&(y[g][m]=[y[g][m],_])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(d,h){return Wi(r(d,h),h)}function a(d,h){return Ga(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],x=[],g,m="",p=Er(d["!ref"]),y=Array.isArray(d),w=p.s.r;w<=p.e.r;++w)for(var v=p.s.c;v<=p.e.c;++v)if(m=Ce({r:w,c:v}),g=y?(d[w]||[])[v]:d[m],!(!g||g.v==null||g.t==="z")){switch(x=["cell",m,"t"],g.t){case"s":case"str":x.push(t(g.v));break;case"n":g.f?(x[2]="vtf",x[3]="n",x[4]=g.v,x[5]=t(g.f)):(x[2]="v",x[3]=g.v);break;case"b":x[2]="vt"+(g.f?"f":"c"),x[3]="nl",x[4]=g.v?"1":"0",x[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var _=Pt(tt(g.v));x[2]="vtc",x[3]="nd",x[4]=""+_,x[5]=g.w||Br(g.z||be[14],_);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,u(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Ri=function(){function e(f,d,h,x,g){g.raw?d[h][x]=f:f===""||(f==="TRUE"?d[h][x]=!0:f==="FALSE"?d[h][x]=!1:isNaN(vn(f))?isNaN(Fi(f).getDate())?d[h][x]=f:d[h][x]=tt(f):d[h][x]=vn(f))}function t(f,d){var h=d||{},x=[];if(!f||f.length===0)return x;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,y=0,w=0;w<=m;++w)y=g[w].indexOf(" "),y==-1?y=g[w].length:y++,p=Math.max(p,y);for(w=0;w<=m;++w){x[w]=[];var v=0;for(e(g[w].slice(0,p).trim(),x,w,v,h),v=1;v<=(g[w].length-p)/10+1;++v)e(g[w].slice(p+(v-1)*10,p+v*10).trim(),x,w,v,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,x=0,g=0;x<f.length;++x)(g=f.charCodeAt(x))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(x in d)Object.prototype.hasOwnProperty.call(d,x)&&g.push([d[x],x]);if(!g.length){d=n;for(x in d)Object.prototype.hasOwnProperty.call(d,x)&&g.push([d[x],x])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(f,d){var h=d||{},x="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=a(f.slice(0,1024)):h&&h.FS?x=h.FS:x=a(f.slice(0,1024));var p=0,y=0,w=0,v=0,_=0,k=x.charCodeAt(0),E=!1,S=0,C=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?_C(h.dateNF):null;function U(){var H=f.slice(v,_),b={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)b.t="z";else if(h.raw)b.t="s",b.v=H;else if(H.trim().length===0)b.t="s",b.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(b.t="s",b.v=H.slice(2,-1).replace(/""/g,'"')):YF(H)?(b.t="n",b.f=H.slice(1)):(b.t="s",b.v=H);else if(H=="TRUE")b.t="b",b.v=!0;else if(H=="FALSE")b.t="b",b.v=!1;else if(!isNaN(w=vn(H)))b.t="n",h.cellText!==!1&&(b.w=H),b.v=w;else if(!isNaN(Fi(H).getDate())||A&&H.match(A)){b.z=h.dateNF||be[14];var V=0;A&&H.match(A)&&(H=kC(H,h.dateNF,H.match(A)||[]),V=1),h.cellDates?(b.t="d",b.v=tt(H,V)):(b.t="n",b.v=Pt(tt(H,V))),h.cellText!==!1&&(b.w=Br(b.z,b.v instanceof Date?Pt(b.v):b.v)),h.cellNF||delete b.z}else b.t="s",b.v=H;if(b.t=="z"||(h.dense?(g[p]||(g[p]=[]),g[p][y]=b):g[Ce({c:y,r:p})]=b),v=_+1,C=f.charCodeAt(v),m.e.c<y&&(m.e.c=y),m.e.r<p&&(m.e.r=p),S==k)++y;else if(y=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;_<f.length;++_)switch(S=f.charCodeAt(_)){case 34:C===34&&(E=!E);break;case k:case 10:case 13:if(!E&&U())break e;break}return _-v>0&&U(),g["!ref"]=Pe(m),g}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Wi(t(f,d),d)}function o(f,d){var h="",x=d.type=="string"?[0,0,0,0]:yp(f,d);switch(d.type){case"base64":h=Mr(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof ll<"u"||(h=De&&Buffer.isBuffer(f)?f.toString("binary"):Va(f));break;case"array":h=ks(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=qe(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=qe(h):d.type=="binary"&&typeof ll<"u",h.slice(0,19)=="socialcalc:version:"?Ww.to_sheet(d.type=="string"?h:qe(h),d):i(h,d)}function l(f,d){return Ga(o(f,d),d)}function u(f){for(var d=[],h=ze(f["!ref"]),x,g=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var p=[],y=h.s.c;y<=h.e.c;++y){var w=Ce({r:m,c:y});if(x=g?(f[m]||[])[y]:f[w],!x||x.v==null){p.push("          ");continue}for(var v=(x.w||(aa(x),x.w)||"").slice(0,10);v.length<10;)v+=" ";p.push(v+(y===0?" ":""))}d.push(p.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function D6(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=$w.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ri.to_workbook(e,t)}}var ps=function(){function e(R,z,O){if(R){Vt(R,R.l||0);for(var P=O.Enum||ae;R.l<R.length;){var K=R.read_shift(2),re=P[K]||P[65535],oe=R.read_shift(2),le=R.l+oe,ie=re.f&&re.f(R,oe,O);if(R.l=le,z(ie,re,K))return}}}function t(R,z){switch(z.type){case"base64":return r(Or(Mr(R)),z);case"binary":return r(Or(R),z);case"buffer":case"array":return r(R,z)}throw"Unsupported type "+z.type}function r(R,z){if(!R)return R;var O=z||{},P=O.dense?[]:{},K="Sheet1",re="",oe=0,le={},ie=[],ce=[],I={s:{r:0,c:0},e:{r:0,c:0}},je=O.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)O.Enum=ae,e(R,function(ge,nt,xr){switch(xr){case 0:O.vers=ge,ge>=4096&&(O.qpro=!0);break;case 6:I=ge;break;case 204:ge&&(re=ge);break;case 222:re=ge;break;case 15:case 51:O.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:xr==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=O.dateNF||be[14],O.cellDates&&(ge[1].t="d",ge[1].v=e0(ge[1].v))),O.qpro&&ge[3]>oe&&(P["!ref"]=Pe(I),le[K]=P,ie.push(K),P=O.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},oe=ge[3],K=re||"Sheet"+(oe+1),re="");var _n=O.dense?(P[ge[0].r]||[])[ge[0].c]:P[Ce(ge[0])];if(_n){_n.t=ge[1].t,_n.v=ge[1].v,ge[1].z!=null&&(_n.z=ge[1].z),ge[1].f!=null&&(_n.f=ge[1].f);break}O.dense?(P[ge[0].r]||(P[ge[0].r]=[]),P[ge[0].r][ge[0].c]=ge[1]):P[Ce(ge[0])]=ge[1];break}},O);else if(R[2]==26||R[2]==14)O.Enum=de,R[2]==14&&(O.qpro=!0,R.l=0),e(R,function(ge,nt,xr){switch(xr){case 204:K=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>oe&&(P["!ref"]=Pe(I),le[K]=P,ie.push(K),P=O.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},oe=ge[3],K="Sheet"+(oe+1)),je>0&&ge[0].r>=je)break;O.dense?(P[ge[0].r]||(P[ge[0].r]=[]),P[ge[0].r][ge[0].c]=ge[1]):P[Ce(ge[0])]=ge[1],I.e.c<ge[0].c&&(I.e.c=ge[0].c),I.e.r<ge[0].r&&(I.e.r=ge[0].r);break;case 27:ge[14e3]&&(ce[ge[14e3][0]]=ge[14e3][1]);break;case 1537:ce[ge[0]]=ge[1],ge[0]==oe&&(K=ge[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(P["!ref"]=Pe(I),le[re||K]=P,ie.push(re||K),!ce.length)return{SheetNames:ie,Sheets:le};for(var Re={},He=[],Oe=0;Oe<ce.length;++Oe)le[ie[Oe]]?(He.push(ce[Oe]||ie[Oe]),Re[ce[Oe]]=le[ce[Oe]]||le[ie[Oe]]):(He.push(ce[Oe]),Re[ce[Oe]]={"!ref":"A1"});return{SheetNames:He,Sheets:Re}}function n(R,z){var O=z||{};if(+O.codepage>=0&&pn(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Sr(),K=ze(R["!ref"]),re=Array.isArray(R),oe=[];me(P,0,s(1030)),me(P,6,l(K));for(var le=Math.min(K.e.r,8191),ie=K.s.r;ie<=le;++ie)for(var ce=kt(ie),I=K.s.c;I<=K.e.c;++I){ie===K.s.r&&(oe[I]=ut(I));var je=oe[I]+ce,Re=re?(R[ie]||[])[I]:R[je];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?me(P,13,x(ie,I,Re.v)):me(P,14,m(ie,I,Re.v));else{var He=aa(Re);me(P,15,d(ie,I,He.slice(0,239)))}}return me(P,1),P.end()}function a(R,z){var O=z||{};if(+O.codepage>=0&&pn(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Sr();me(P,0,i(R));for(var K=0,re=0;K<R.SheetNames.length;++K)(R.Sheets[R.SheetNames[K]]||{})["!ref"]&&me(P,27,B(R.SheetNames[K],re++));var oe=0;for(K=0;K<R.SheetNames.length;++K){var le=R.Sheets[R.SheetNames[K]];if(!(!le||!le["!ref"])){for(var ie=ze(le["!ref"]),ce=Array.isArray(le),I=[],je=Math.min(ie.e.r,8191),Re=ie.s.r;Re<=je;++Re)for(var He=kt(Re),Oe=ie.s.c;Oe<=ie.e.c;++Oe){Re===ie.s.r&&(I[Oe]=ut(Oe));var ge=I[Oe]+He,nt=ce?(le[Re]||[])[Oe]:le[ge];if(!(!nt||nt.t=="z"))if(nt.t=="n")me(P,23,U(Re,Oe,oe,nt.v));else{var xr=aa(nt);me(P,22,S(Re,Oe,oe,xr.slice(0,239)))}}++oe}}return me(P,1),P.end()}function s(R){var z=te(2);return z.write_shift(2,R),z}function i(R){var z=te(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var O=0,P=0,K=0,re=0;re<R.SheetNames.length;++re){var oe=R.SheetNames[re],le=R.Sheets[oe];if(!(!le||!le["!ref"])){++K;var ie=Er(le["!ref"]);O<ie.e.r&&(O=ie.e.r),P<ie.e.c&&(P=ie.e.c)}}return O>8191&&(O=8191),z.write_shift(2,O),z.write_shift(1,K),z.write_shift(1,P),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(R,z,O){var P={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&O.qpro?(P.s.c=R.read_shift(1),R.l++,P.s.r=R.read_shift(2),P.e.c=R.read_shift(1),R.l++,P.e.r=R.read_shift(2),P):(P.s.c=R.read_shift(2),P.s.r=R.read_shift(2),z==12&&O.qpro&&(R.l+=2),P.e.c=R.read_shift(2),P.e.r=R.read_shift(2),z==12&&O.qpro&&(R.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(R){var z=te(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function u(R,z,O){var P=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(P[0].c=R.read_shift(1),P[3]=R.read_shift(1),P[0].r=R.read_shift(2),R.l+=2):(P[2]=R.read_shift(1),P[0].c=R.read_shift(2),P[0].r=R.read_shift(2)),P}function f(R,z,O){var P=R.l+z,K=u(R,z,O);if(K[1].t="s",O.vers==20768){R.l++;var re=R.read_shift(1);return K[1].v=R.read_shift(re,"utf8"),K}return O.qpro&&R.l++,K[1].v=R.read_shift(P-R.l,"cstr"),K}function d(R,z,O){var P=te(7+O.length);P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,R),P.write_shift(1,39);for(var K=0;K<P.length;++K){var re=O.charCodeAt(K);P.write_shift(1,re>=128?95:re)}return P.write_shift(1,0),P}function h(R,z,O){var P=u(R,z,O);return P[1].v=R.read_shift(2,"i"),P}function x(R,z,O){var P=te(7);return P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,R),P.write_shift(2,O,"i"),P}function g(R,z,O){var P=u(R,z,O);return P[1].v=R.read_shift(8,"f"),P}function m(R,z,O){var P=te(13);return P.write_shift(1,255),P.write_shift(2,z),P.write_shift(2,R),P.write_shift(8,O,"f"),P}function p(R,z,O){var P=R.l+z,K=u(R,z,O);if(K[1].v=R.read_shift(8,"f"),O.qpro)R.l=P;else{var re=R.read_shift(2);_(R.slice(R.l,R.l+re),K),R.l+=re}return K}function y(R,z,O){var P=z&32768;return z&=-32769,z=(P?R:0)+(z>=8192?z-16384:z),(P?"":"$")+(O?ut(z):kt(z))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(R,z){Vt(R,0);for(var O=[],P=0,K="",re="",oe="",le="";R.l<R.length;){var ie=R[R.l++];switch(ie){case 0:O.push(R.read_shift(8,"f"));break;case 1:re=y(z[0].c,R.read_shift(2),!0),K=y(z[0].r,R.read_shift(2),!1),O.push(re+K);break;case 2:{var ce=y(z[0].c,R.read_shift(2),!0),I=y(z[0].r,R.read_shift(2),!1);re=y(z[0].c,R.read_shift(2),!0),K=y(z[0].r,R.read_shift(2),!1),O.push(ce+I+":"+re+K)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(R.read_shift(2));break;case 6:{for(var je="";ie=R[R.l++];)je+=String.fromCharCode(ie);O.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:le=O.pop(),oe=O.pop(),O.push(["AND","OR"][ie-20]+"("+oe+","+le+")");break;default:if(ie<32&&v[ie])le=O.pop(),oe=O.pop(),O.push(oe+v[ie]+le);else if(w[ie]){if(P=w[ie][1],P==69&&(P=R[R.l++]),P>O.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+O.join("|")+"|");return}var Re=O.slice(-P);O.length-=P,O.push(w[ie][0]+"("+Re.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}O.length==1?z[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function k(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function E(R,z){var O=k(R);return O[1].t="s",O[1].v=R.read_shift(z-4,"cstr"),O}function S(R,z,O,P){var K=te(6+P.length);K.write_shift(2,R),K.write_shift(1,O),K.write_shift(1,z),K.write_shift(1,39);for(var re=0;re<P.length;++re){var oe=P.charCodeAt(re);K.write_shift(1,oe>=128?95:oe)}return K.write_shift(1,0),K}function C(R,z){var O=k(R);O[1].v=R.read_shift(2);var P=O[1].v>>1;if(O[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return O[1].v=P,O}function A(R,z){var O=k(R),P=R.read_shift(4),K=R.read_shift(4),re=R.read_shift(2);if(re==65535)return P===0&&K===3221225472?(O[1].t="e",O[1].v=15):P===0&&K===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var oe=re&32768;return re=(re&32767)-16446,O[1].v=(1-oe*2)*(K*Math.pow(2,re+32)+P*Math.pow(2,re)),O}function U(R,z,O,P){var K=te(14);if(K.write_shift(2,R),K.write_shift(1,O),K.write_shift(1,z),P==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var re=0,oe=0,le=0,ie=0;return P<0&&(re=1,P=-P),oe=Math.log2(P)|0,P/=Math.pow(2,oe-31),ie=P>>>0,ie&2147483648||(P/=2,++oe,ie=P>>>0),P-=ie,ie|=2147483648,ie>>>=0,P*=Math.pow(2,32),le=P>>>0,K.write_shift(4,le),K.write_shift(4,ie),oe+=16383+(re?32768:0),K.write_shift(2,oe),K}function H(R,z){var O=A(R);return R.l+=z-14,O}function b(R,z){var O=k(R),P=R.read_shift(4);return O[1].v=P>>6,O}function V(R,z){var O=k(R),P=R.read_shift(8,"f");return O[1].v=P,O}function J(R,z){var O=V(R);return R.l+=z-10,O}function W(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function Z(R,z){var O=R[R.l++];O>z-1&&(O=z-1);for(var P="";P.length<O;)P+=String.fromCharCode(R[R.l++]);return P}function ee(R,z,O){if(!(!O.qpro||z<21)){var P=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var K=R.read_shift(z-21,"cstr");return[P,K]}}function G(R,z){for(var O={},P=R.l+z;R.l<P;){var K=R.read_shift(2);if(K==14e3){for(O[K]=[0,""],O[K][0]=R.read_shift(2);R[R.l];)O[K][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return O}function B(R,z){var O=te(5+R.length);O.write_shift(2,14e3),O.write_shift(2,z);for(var P=0;P<R.length;++P){var K=R.charCodeAt(P);O[O.l++]=K>127?95:K}return O[O.l++]=0,O}var ae={0:{n:"BOF",f:Tt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function L6(e){var t={},r=e.match(or),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ae(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Dh[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var M6=function(){var e=fl("t"),t=fl("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:$e(i[1])},l=s.match(t);return l&&(o.s=L6(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),B6=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),U6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$6=/<(?:\w+:)?r>/,z6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ip(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=$e(qe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qe(e),r&&(n.h=Gh(n.t))):e.match($6)&&(n.r=qe(e),n.t=$e(qe((e.replace(z6,"").match(U6)||[]).join("").replace(or,""))),r&&(n.h=B6(M6(n.r)))),n):{t:""}}var W6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,H6=/<(?:\w+:)?(?:si|sstItem)>/g,V6=/<\/(?:\w+:)?(?:si|sstItem)>/;function G6(e,t){var r=[],n="";if(!e)return r;var a=e.match(W6);if(a){n=a[2].replace(H6,"").split(V6);for(var s=0;s!=n.length;++s){var i=ip(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ae(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var K6=/^\s|\s$|[\t\n\r]/;function Hw(e,t){if(!t.bookSST)return"";var r=[St];r[r.length]=pe("sst",null,{xmlns:Fs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(K6)&&(s+=' xml:space="preserve"'),s+=">"+Ke(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function X6(e){return[e.read_shift(4),e.read_shift(4)]}function q6(e,t){var r=[],n=!1;return ca(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Y6(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var J6=oA;function Q6(e){var t=Sr();se(t,159,Y6(e));for(var r=0;r<e.length;++r)se(t,19,J6(e[r]));return se(t,160),t.end()}function Vw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Z6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function e5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function t5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e5(e));return t}function r5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function n5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function a5(e){var t=n5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Gw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Kw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function s5(e){var t=Jn(e);switch(t.Minor){case 2:return[t.Minor,i5(e)];case 3:return[t.Minor,o5()];case 4:return[t.Minor,l5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function i5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Gw(e,r),a=Kw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function o5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function l5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(or,function(s){var i=Ae(s);switch(Ln(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function c5(e,t){var r={},n=r.EncryptionVersionInfo=Jn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Gw(e,a),t-=a,r.EncryptionVerifier=Kw(e,t),r}function u5(e){var t={},r=t.EncryptionVersionInfo=Jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function op(e){var t=0,r,n=Vw(e),a=n.length+1,s,i,o,l,u;for(r=La(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var Xw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=Vw(i),l=s(o),u=o.length,f=La(16),d=0;d!=16;++d)f[d]=0;var h,x,g;for((u&1)===1&&(h=l>>8,f[u]=a(e[0],h),--u,h=l&255,x=o[o.length-1],f[u]=a(x,h));u>0;)--u,h=l>>8,f[u]=a(o[u],h),--u,h=l&255,f[u]=a(o[u],h);for(u=15,g=15-o.length;g>0;)h=l>>8,f[u]=a(e[g],h),--u,--g,h=l&255,f[u]=a(o[u],h),--u,--g;return f}}(),f5=function(e,t,r,n,a){a||(a=t),n||(n=Xw(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},d5=function(e){var t=0,r=Xw(e);return function(n){var a=f5("",n,t,r);return t=a[1],a[0]}};function h5(e,t,r,n){var a={key:Tt(e),verificationBytes:Tt(e)};return r.password&&(a.verifier=op(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=d5(r.password)),a}function p5(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=u5(e):n.Data=c5(e,t),n}function m5(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?p5(e,t-2,n):h5(e,r.biff>=8?t:t-2,r,n),n}var qw=function(){function e(a,s){switch(s.type){case"base64":return t(Mr(a),s);case"binary":return t(a,s);case"buffer":return t(De&&Buffer.isBuffer(a)?a.toString("binary"):Va(a),s);case"array":return t(ks(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,x=0,g,m=-1;g=h.exec(f);){switch(g[0]){case"\\cell":var p=f.slice(x,h.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var y={v:p,t:"s"};Array.isArray(o)?o[d][m]=y:o[Ce({r:d,c:m})]=y}break}x=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=Pe(u),o}function r(a,s){return Ga(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ze(a["!ref"]),o,l=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Ce({r:u,c:f});o=l?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(aa(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function x5(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ml(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function g5(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,u=a+s;switch(l=i/(u>1?2-u:u),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function v5(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Su(e,t){if(t===0)return e;var r=g5(x5(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ml(v5(r))}var Yw=6,y5=15,w5=1,rr=Yw;function xl(e){return Math.floor((e+Math.round(128/rr)/256)*rr)}function gl(e){return Math.floor((e-5)/rr*100+.5)/100}function Eu(e){return Math.round((e*rr+5)/rr*256)/256}function Y0(e){return Eu(gl(xl(e)))}function lp(e){var t=Math.abs(e-Y0(e)),r=rr;if(t>.005)for(rr=w5;rr<y5;++rr)Math.abs(e-Y0(e))<=t&&(t=Math.abs(e-Y0(e)),r=rr);rr=r}function Ma(e){e.width?(e.wpx=xl(e.width),e.wch=gl(e.wpx),e.MDW=rr):e.wpx?(e.wch=gl(e.wpx),e.width=Eu(e.wch),e.MDW=rr):typeof e.wch=="number"&&(e.width=Eu(e.wch),e.wpx=xl(e.width),e.MDW=rr),e.customWidth&&delete e.customWidth}var _5=96,Jw=_5;function vl(e){return e*96/Jw}function Oi(e){return e*Jw/96}var k5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function S5(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=Ae(i);switch(Ln(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Ze(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Ze(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function E5(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=Ae(i);switch(Ln(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function b5(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=Ae(i);switch(Ln(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=qe(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Ze(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Ze(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Ze(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Ze(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Ze(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Ze(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Ze(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Dh[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Ze(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=ds[a.color.index];a.color.index==81&&(l=ds[1]),l||(l=ds[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Su(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function T5(e,t,r){t.NumberFmt=[];for(var n=vt(be),a=0;a<n.length;++a)t.NumberFmt[n[a]]=be[n[a]];var s=e[0].match(or);if(s)for(a=0;a<s.length;++a){var i=Ae(s[a]);switch(Ln(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=$e(qe(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Rn(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function N5(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=pe("numFmt",null,{numFmtId:n,formatCode:Ke(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var yc=["numFmtId","fillId","fontId","borderId","xfId"],wc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function C5(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(or)||[]).forEach(function(s){var i=Ae(s),o=0;switch(Ln(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<yc.length;++o)n[yc[o]]&&(n[yc[o]]=parseInt(n[yc[o]],10));for(o=0;o<wc.length;++o)n[wc[o]]&&(n[wc[o]]=Ze(n[wc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Ze(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function A5(e){var t=[];return t[t.length]=pe("cellXfs",null),e.forEach(function(r){t[t.length]=pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var j5=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&T5(d,f,u),(d=o.match(a))&&b5(d,f,l,u),(d=o.match(n))&&E5(d,f,l,u),(d=o.match(s))&&S5(d,f,l,u),(d=o.match(r))&&C5(d,f,u),f}}();function Qw(e,t){var r=[St,pe("styleSheet",null,{xmlns:Fs[0],"xmlns:vt":Rt.vt})],n;return e.SSF&&(n=N5(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=A5(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function F5(e,t){var r=e.read_shift(2),n=ar(e);return[r,n]}function R5(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),Mt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function O5(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=pA(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=hA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ar(e),n}function P5(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),mA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wu(e.color,t);var n=0;return n=2,t.write_shift(1,n),Mt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var I5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],J0,D5=ir;function ig(e,t){t||(t=te(4*3+8*7+16*1)),J0||(J0=Qu(I5));var r=J0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(wu({auto:1},t),wu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function L5(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Zw(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function lo(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var M5=ir;function B5(e,t){return t||(t=te(51)),t.write_shift(1,0),lo(null,t),lo(null,t),lo(null,t),lo(null,t),lo(null,t),t.length>t.l?t.slice(0,t.l):t}function U5(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function $5(e,t,r){var n=te(2052);return n.write_shift(4,e),yu(t,n),yu(r,n),n.length>n.l?n.slice(0,n.l):n}function z5(e,t,r){var n={};n.NumberFmt=[];for(var a in be)n.NumberFmt[a]=be[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ca(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Rn(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Su(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function W5(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(se(e,615,yn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&se(e,44,R5(a,t[a]))}),se(e,616))}}function H5(e){var t=1;se(e,611,yn(t)),se(e,43,P5({sz:12,color:{theme:1},name:"Calibri",family:2})),se(e,612)}function V5(e){var t=2;se(e,603,yn(t)),se(e,45,ig({patternType:"none"})),se(e,45,ig({patternType:"gray125"})),se(e,604)}function G5(e){var t=1;se(e,613,yn(t)),se(e,46,B5()),se(e,614)}function K5(e){var t=1;se(e,626,yn(t)),se(e,47,Zw({numFmtId:0},65535)),se(e,627)}function X5(e,t){se(e,617,yn(t.length)),t.forEach(function(r){se(e,47,Zw(r,0))}),se(e,618)}function q5(e){var t=1;se(e,619,yn(t)),se(e,48,U5({xfId:0,name:"Normal"})),se(e,620)}function Y5(e){var t=0;se(e,505,yn(t)),se(e,506)}function J5(e){var t=0;se(e,508,$5(t,"TableStyleMedium9","PivotStyleMedium4")),se(e,509)}function Q5(e,t){var r=Sr();return se(r,278),W5(r,e.SSF),H5(r),V5(r),G5(r),K5(r),X5(r,t.cellXfs),q5(r),Y5(r),J5(r),se(r,279),r.end()}var Z5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function eF(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(or)||[]).forEach(function(a){var s=Ae(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[Z5.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function tF(){}function rF(){}var nF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,aF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,sF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function iF(e,t,r){t.themeElements={};var n;[["clrScheme",nF,eF],["fontScheme",aF,tF],["fmtScheme",sF,rF]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var oF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function e2(e,t){(!e||e.length===0)&&(e=cp());var r,n={};if(!(r=e.match(oF)))throw new Error("themeElements not found in theme");return iF(r[0],n,t),n.raw=e,n}function cp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[St];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function lF(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Gy(s,{type:"array"})}catch{return}var o=Pr(i,"theme/theme/theme1.xml",!0);if(o)return e2(o,r)}}function cF(e){return e.read_shift(4)}function uF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=fF(e,4);break;case 2:t.xclrValue=Ow(e);break;case 3:t.xclrValue=cF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function fF(e,t){return ir(e,t)}function dF(e,t){return ir(e,t)}function hF(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=uF(e);break;case 6:n[1]=dF(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function pF(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(hF(e,r-e.l));return{ixfe:n,ext:s}}function mF(e,t){t.forEach(function(r){switch(r[0]){}})}function xF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ar(e)}}function gF(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Mt(e.name,t),t.slice(0,t.l)}function vF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function yF(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function wF(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),Mt(t,r),r.slice(0,r.l)}function _F(e){return e.l+=4,e.read_shift(4)!=0}function kF(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function SF(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return ca(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function EF(){var e=Sr();return se(e,332),se(e,334,yn(1)),se(e,335,gF({name:"XLDAPR",version:12e4,flags:3496657072})),se(e,336),se(e,339,wF(1,"XLDAPR")),se(e,52),se(e,35,yn(514)),se(e,4096,yn(0)),se(e,4097,qr(1)),se(e,36),se(e,53),se(e,340),se(e,337,kF(1)),se(e,51,yF([[1,0]])),se(e,338),se(e,333),e.end()}function bF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(or,function(o){var l=Ae(o);switch(Ln(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function t2(){var e=[St];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function TF(e){var t=[];if(!e)return t;var r=1;return(e.match(or)||[]).forEach(function(n){var a=Ae(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function NF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ce(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function CF(e,t,r){var n=[];return ca(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function AF(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ca(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function jF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ui=1024;function r2(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[pe("xml",null,{"xmlns:v":Ar.v,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:mv":Ar.mv}).replace(/\/>/,">"),pe("o:shapelayout",pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),pe("v:shapetype",[pe("v:stroke",null,{joinstyle:"miter"}),pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ui<e*1e3;)ui+=1e3;return t.forEach(function(s){var i=ft(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=pe("v:fill",l,o),f={on:"t",obscured:"t"};++ui,a=a.concat(["<v:shape"+dl({id:"_x0000_s"+ui,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,pe("v:shadow",null,f),pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Gt("x:AutoFill","False"),Gt("x:Row",String(i.r)),Gt("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function og(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=ft(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=ze(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=Pe(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function FF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ae(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=ft(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&ip(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function n2(e){var t=[St,pe("comments",null,{xmlns:Fs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Ke(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(Ke(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Gt("t",Ke(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(Gt("t",Ke(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RF(e,t){var r=[],n=!1,a={},s=0;return e.replace(or,function(o,l){var u=Ae(o);switch(Ln(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function OF(e,t,r){var n=[St,pe("ThreadedComments",null,{xmlns:Rt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(pe("threadedComment",Gt("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function PF(e,t){var r=[],n=!1;return e.replace(or,function(s){var i=Ae(s);switch(Ln(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function IF(e){var t=[St,pe("personList",null,{xmlns:Rt.TCMNT,"xmlns:x":Fs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function DF(e){var t={};t.iauthor=e.read_shift(4);var r=Is(e);return t.rfx=r.s,t.ref=Ce(r.s),e.l+=16,t}function LF(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),Hi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var MF=ar;function BF(e){return Mt(e.slice(0,54))}function UF(e,t){var r=[],n=[],a={},s=!1;return ca(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function $F(e){var t=Sr(),r=[];return se(t,628),se(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),se(t,632,BF(a.a)))})}),se(t,631),se(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:ft(n[0]),e:ft(n[0])};se(t,635,LF([s,a])),a.t&&a.t.length>0&&se(t,637,cA(a)),se(t,636),delete a.iauthor})}),se(t,634),se(t,629),t.end()}var zF="application/vnd.ms-office.vbaProject";function WF(e){var t=Ee.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ee.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ee.write(t)}function HF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ee.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var a2=["xlsb","xlsm","xlam","biff8","xla"];function VF(){return{"!type":"dialog"}}function GF(){return{"!type":"dialog"}}function KF(){return{"!type":"macro"}}function XF(){return{"!type":"macro"}}var wi=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,a+(o?"":"$")+ut(f)+(l?"":"$")+kt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),up=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fp=function(){return function(t,r){return t.replace(up,function(n,a,s,i,o,l){var u=Jh(i)-(s?0:r.c),f=Yh(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+d+"C"+h})}}();function s2(e,t){return e.replace(up,function(r,n,a,s,i,o){return n+(a=="$"?a+s:ut(Jh(s)+t.c))+(i=="$"?i+o:kt(Yh(o)+t.r))})}function qF(e,t,r){var n=Er(t),a=n.s,s=ft(r),i={r:s.r-a.r,c:s.c-a.c};return s2(e,i)}function YF(e){return e.length!=1}function lg(e){return e.replace(/_xlfn\./g,"")}function Et(e){e.l+=1}function Ba(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function i2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return o2(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Ba(e),o=Ba(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function o2(e){var t=Ba(e),r=Ba(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function JF(e,t,r){if(r.biff<8)return o2(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Ba(e),i=Ba(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function l2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return QF(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ba(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function QF(e){var t=Ba(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function ZF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function e8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return t8(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function t8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function r8(e,t,r){var n=(e[e.l++]&96)>>5,a=i2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function n8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=i2(e,s,r);return[n,a,i]}function a8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function s8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function i8(e,t,r){var n=(e[e.l++]&96)>>5,a=JF(e,t-1,r);return[n,a]}function o8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function cg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function l8(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function c8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function u8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function f8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function d8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function c2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function h8(e){return e.read_shift(2),c2(e)}function p8(e){return e.read_shift(2),c2(e)}function m8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=l2(e,0,r);return[n,a]}function x8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e8(e,0,r);return[n,a]}function g8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=l2(e,0,r);return[n,a,s]}function v8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[_R[a],d2[a],n]}function y8(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:w8(e);return[a,(s[0]===0?d2:wR)[s[1]]]}function w8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function _8(e,t,r){e.l+=r&&r.biff==2?3:4}function k8(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function S8(e){return e.l++,ua[e.read_shift(1)]}function E8(e){return e.l++,e.read_shift(2)}function b8(e){return e.l++,e.read_shift(1)!==0}function T8(e){return e.l++,nr(e)}function N8(e,t,r){return e.l++,Il(e,t-1,r)}function C8(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ua[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=nr(e);break;case 2:r[1]=Ds(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function A8(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Is:t0)(e));return a}function j8(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=C8(e,r.biff);return i}function F8(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function R8(e,t,r){if(r.biff==5)return O8(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function O8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function P8(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function I8(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function D8(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function L8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var M8=ir,B8=ir,U8=ir;function Ll(e,t,r){return e.l+=2,[ZF(e)]}function dp(e){return e.l+=6,[]}var $8=Ll,z8=dp,W8=dp,H8=Ll;function u2(e){return e.l+=2,[Tt(e),e.read_shift(2)&1]}var V8=Ll,G8=u2,K8=dp,X8=Ll,q8=Ll,Y8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function J8(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=Y8[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function Q8(e){return e.l+=2,[e.read_shift(4)]}function Z8(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function eR(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function tR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function rR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nR(e){return e.l+=4,[0,0]}var ug={1:{n:"PtgExp",f:k8},2:{n:"PtgTbl",f:U8},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:N8},26:{n:"PtgSheet",f:Z8},27:{n:"PtgEndSheet",f:eR},28:{n:"PtgErr",f:S8},29:{n:"PtgBool",f:b8},30:{n:"PtgInt",f:E8},31:{n:"PtgNum",f:T8},32:{n:"PtgArray",f:o8},33:{n:"PtgFunc",f:v8},34:{n:"PtgFuncVar",f:y8},35:{n:"PtgName",f:F8},36:{n:"PtgRef",f:m8},37:{n:"PtgArea",f:r8},38:{n:"PtgMemArea",f:P8},39:{n:"PtgMemErr",f:M8},40:{n:"PtgMemNoMem",f:B8},41:{n:"PtgMemFunc",f:I8},42:{n:"PtgRefErr",f:D8},43:{n:"PtgAreaErr",f:a8},44:{n:"PtgRefN",f:x8},45:{n:"PtgAreaN",f:i8},46:{n:"PtgMemAreaN",f:tR},47:{n:"PtgMemNoMemN",f:rR},57:{n:"PtgNameX",f:R8},58:{n:"PtgRef3d",f:g8},59:{n:"PtgArea3d",f:n8},60:{n:"PtgRefErr3d",f:L8},61:{n:"PtgAreaErr3d",f:s8},255:{}},aR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sR={1:{n:"PtgElfLel",f:u2},2:{n:"PtgElfRw",f:X8},3:{n:"PtgElfCol",f:$8},6:{n:"PtgElfRwV",f:q8},7:{n:"PtgElfColV",f:H8},10:{n:"PtgElfRadical",f:V8},11:{n:"PtgElfRadicalS",f:K8},13:{n:"PtgElfColS",f:z8},15:{n:"PtgElfColSV",f:W8},16:{n:"PtgElfRadicalLel",f:G8},25:{n:"PtgList",f:J8},29:{n:"PtgSxName",f:Q8},255:{}},iR={0:{n:"PtgAttrNoop",f:nR},1:{n:"PtgAttrSemi",f:d8},2:{n:"PtgAttrIf",f:u8},4:{n:"PtgAttrChoose",f:l8},8:{n:"PtgAttrGoto",f:c8},16:{n:"PtgAttrSum",f:_8},32:{n:"PtgAttrBaxcel",f:cg},33:{n:"PtgAttrBaxcel",f:cg},64:{n:"PtgAttrSpace",f:h8},65:{n:"PtgAttrSpaceSemi",f:p8},128:{n:"PtgAttrIfError",f:f8},255:{}};function Ml(e,t,r,n){if(n.biff<8)return ir(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=j8(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=A8(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(ir(e,t)),s}function Bl(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=ug[s]||ug[aR[s]],(s===24||s===25)&&(a=(s===24?sR:iR)[e[e.l+1]]),!a||!a.f?ir(e,t):i.push([a.n,a.f(e,t,r)]);return i}function oR(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var lR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cR(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function f2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function fg(e,t,r){var n=f2(e,t,r);return n=="#REF"?n:cR(n,r)}function er(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,d=0,h=0,x,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,p="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:p=xt(" ",e[0][m][1][1]);break;case 1:p=xt("\r",e[0][m][1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+p,m=-1}o.push(u+lR[v[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=jo(v[1][1],i,a),o.push(Fo(f,s));break;case"PtgRefN":f=r?jo(v[1][1],r,a):v[1][1],o.push(Fo(f,s));break;case"PtgRef3d":d=v[1][1],f=jo(v[1][2],i,a),g=fg(n,d,a),o.push(g+"!"+Fo(f,s));break;case"PtgFunc":case"PtgFuncVar":var _=v[1][0],k=v[1][1];_||(_=0),_&=127;var E=_==0?[]:o.slice(-_);o.length-=_,k==="User"&&(k=E.shift()),o.push(k+"("+E.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":x=Ux(v[1][1],r?{s:r}:i,a),o.push(K0(x,a));break;case"PtgArea":x=Ux(v[1][1],i,a),o.push(K0(x,a));break;case"PtgArea3d":d=v[1][1],x=v[1][2],g=fg(n,d,a),o.push(g+"!"+K0(x,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],C=S?S.Name:"SH33TJSNAME"+String(h);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var A=v[1][1];h=v[1][2];var U;if(a.biff<=5)A<0&&(A=-A),n[A]&&(U=n[A][h]);else{var H="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(H=n.SheetNames[n[A][h].itab-1]+"!"):H=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])H+=n[A][h].Name;else if(n[0]&&n[0][h])H+=n[0][h].Name;else{var b=(f2(n,A,a)||"").split(";;");b[h-1]?H=b[h-1]:H+="SH33TJSERRX"}o.push(H);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var V="(",J=")";if(m>=0){switch(p="",e[0][m][1][0]){case 2:V=xt(" ",e[0][m][1][1])+V;break;case 3:V=xt("\r",e[0][m][1][1])+V;break;case 4:J=xt(" ",e[0][m][1][1])+J;break;case 5:J=xt("\r",e[0][m][1][1])+J;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(V+o.pop()+J);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[Ce(f)]){var Z=n.sharedf[Ce(f)];o.push(er(Z,i,W,n,a))}else{var ee=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(er(u[1],i,W,n,a)),ee=!0;break}ee||o.push(v[1])}break;case"PtgArray":o.push("{"+oR(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&G.indexOf(e[0][y][0])==-1){v=e[0][m];var B=!0;switch(v[1][0]){case 4:B=!1;case 0:p=xt(" ",v[1][1]);break;case 5:B=!1;case 1:p=xt("\r",v[1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((B?p:"")+o.pop()+(B?"":p)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function uR(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],ir(e,t-2)];var o=Bl(e,i,r);return t!==i+a&&(s=Ml(e,t-i-a,o,r)),e.l=n,[o,s]}function fR(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],ir(e,t-2)];var o=Bl(e,i,r);return t!==i+a&&(s=Ml(e,t-i-a,o,r)),e.l=n,[o,s]}function dR(e,t,r,n){var a=e.l+t,s=Bl(e,n,r),i;return a!==e.l&&(i=Ml(e,a-e.l,s,r)),[s,i]}function hR(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Bl(e,s,r);return s==65535?[[],ir(e,t-2)]:(t!==s+2&&(a=Ml(e,n-s-2,i,r)),[i,a])}function pR(e){var t;if(Kn(e,e.l+6)!==65535)return[nr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mR(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ss(e);return Ss(0)}function Q0(e,t,r){var n=e.l+t,a=Mn(e);r.biff==2&&++e.l;var s=pR(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=fR(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function xR(e,t,r,n,a){var s=bs(t,r,a),i=mR(e.v),o=te(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=te(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=Lt([s,i,o,u]);return d}function r0(e,t,r){var n=e.read_shift(4),a=Bl(e,n,r),s=e.read_shift(4),i=s>0?Ml(e,s,a,r):null;return[a,i]}var gR=r0,n0=r0,vR=r0,yR=r0,wR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},d2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},_R={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function dg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function kR(e){var t="of:="+e.replace(up,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Z0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function SR(e){return e.replace(/\./,"!")}var Oo={},_i={},Po=typeof Map<"u";function hp(e,t,r){var n=0,a=e.length;if(r){if(Po?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Po?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Po?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function a0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(rr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=gl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Eu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ms(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ka(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Rn(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function h2(e,t,r,n,a,s){try{n.cellNF&&(e.z=be[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=tt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(be[t]==null&&Rn(wC[t]||"General",t),e.t==="e")e.w=e.w||ua[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v);else if(e.t==="d"){var i=Pt(e.v);(i|0)===i?e.w=i.toString(10):e.w=ul(i)}else{if(e.v===void 0)return"";e.w=_s(e.v,_i)}else e.t==="d"?e.w=Br(t,Pt(e.v),_i):e.w=Br(t,e.v,_i)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Su(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Su(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function ER(e,t,r){if(e&&e["!ref"]){var n=ze(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function bR(e,t){var r=ze(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Pe(r))}var TR=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,NR=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,CR=/<(?:\w:)?hyperlink [^>]*>/mg,AR=/"(\w*:\w*)"/,jR=/<(?:\w:)?col\b[^>]*[\/]?>/g,FR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RR=/<(?:\w:)?pageMargins[^>]*\/>/g,p2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,OR=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IR(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(NR);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(p2);h?pp(h[0],o,a,r):(h=u.match(OR))&&LR(h[0],h[1]||"",o,a,r);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var g=u.slice(x,x+50).match(AR);g&&bR(o,g[1])}var m=u.match(PR);m&&m[1]&&YR(m[1],a);var p=[];if(t.cellStyles){var y=u.match(jR);y&&VR(p,y)}d&&ZR(d[1],o,t,l,s,i);var w=f.match(FR);w&&(o["!autofilter"]=KR(w[0]));var v=[],_=f.match(TR);if(_)for(x=0;x!=_.length;++x)v[x]=ze(_[x].slice(_[x].indexOf('"')+1));var k=f.match(CR);k&&zR(o,k,n);var E=f.match(RR);if(E&&(o["!margins"]=WR(Ae(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Pe(l)),t.sheetRows>0&&o["!ref"]){var S=ze(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Pe(S))}return p.length>0&&(o["!cols"]=p),v.length>0&&(o["!merges"]=v),o}function DR(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Pe(e[r])+'"/>';return t+"</mergeCells>"}function pp(e,t,r,n){var a=Ae(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=$e(qe(a.codeName)))}function LR(e,t,r,n,a){pp(e.slice(0,e.indexOf(">")),r,n,a)}function MR(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=An(Ke(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+pe("outlinePr",null,u)}!s&&!o||(a[a.length]=pe("sheetPr",o,i))}var BR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],UR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $R(e){var t={sheet:1};return BR.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),UR.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=op(e.password).toString(16).toUpperCase()),pe("sheetProtection",null,t)}function zR(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ae(qe(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+$e(s.location))):(s.Target="#"+$e(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ze(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=Ce({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function WR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function HR(e){return ms(e),pe("pageMargins",null,e)}function VR(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ae(t[n],!0);a.hidden&&(a.hidden=Ze(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,lp(a.width)),Ma(a);s<=i;)e[s++]=rt(a)}}function GR(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=pe("col",null,a0(a,n)));return r[r.length]="</cols>",r.join("")}function KR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function XR(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Pe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Er(a);i.s.r==i.e.r&&(i.e.r=Er(t["!ref"]).e.r,a=Pe(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pe("autoFilter",null,{ref:a})}var qR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YR(e,t){t.Views||(t.Views=[{}]),(e.match(qR)||[]).forEach(function(r,n){var a=Ae(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Ze(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function JR(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pe("sheetViews",pe("sheetView",null,a),{})}function QR(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ua[e.v];break;case"d":n&&n.cellDates?a=tt(e.v,-1).toISOString():(e=rt(e),e.t="n",a=""+(e.v=Pt(tt(e.v)))),typeof e.z>"u"&&(e.z=be[14]);break;default:a=e.v;break}var o=Gt("v",Ke(a)),l={r:t},u=Ka(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Gt("v",""+hp(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=pe("f",Ke(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),pe("c",o,l)}var ZR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=fl("v"),i=fl("f");return function(l,u,f,d,h,x){for(var g=0,m="",p=[],y=[],w=0,v=0,_=0,k="",E,S,C=0,A=0,U,H,b=0,V=0,J=Array.isArray(x.CellXf),W,Z=[],ee=[],G=Array.isArray(u),B=[],ae={},de=!1,R=!!f.sheetStubs,z=l.split(t),O=0,P=z.length;O!=P;++O){m=z[O].trim();var K=m.length;if(K!==0){var re=0;e:for(g=0;g<K;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(S=Ae(m.slice(re,g),!0),C=S.r!=null?parseInt(S.r,10):C+1,A=-1,f.sheetRows&&f.sheetRows<C)continue;ae={},de=!1,S.ht&&(de=!0,ae.hpt=parseFloat(S.ht),ae.hpx=Oi(ae.hpt)),S.hidden=="1"&&(de=!0,ae.hidden=!0),S.outlineLevel!=null&&(de=!0,ae.level=+S.outlineLevel),de&&(B[C-1]=ae)}break;case"<":re=g;break}if(re>=g)break;if(S=Ae(m.slice(re,g),!0),C=S.r!=null?parseInt(S.r,10):C+1,A=-1,!(f.sheetRows&&f.sheetRows<C)){d.s.r>C-1&&(d.s.r=C-1),d.e.r<C-1&&(d.e.r=C-1),f&&f.cellStyles&&(ae={},de=!1,S.ht&&(de=!0,ae.hpt=parseFloat(S.ht),ae.hpx=Oi(ae.hpt)),S.hidden=="1"&&(de=!0,ae.hidden=!0),S.outlineLevel!=null&&(de=!0,ae.level=+S.outlineLevel),de&&(B[C-1]=ae)),p=m.slice(g).split(e);for(var oe=0;oe!=p.length&&p[oe].trim().charAt(0)=="<";++oe);for(p=p.slice(oe),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(y=m.match(r),w=g,v=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(w=0,k=y[1],v=0;v!=k.length&&!((_=k.charCodeAt(v)-64)<1||_>26);++v)w=26*w+_;--w,A=w}else++A;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,S=Ae(m.slice(0,v),!0),S.r||(S.r=Ce({r:C-1,c:A})),k=m.slice(v),E={t:""},(y=k.match(s))!=null&&y[1]!==""&&(E.v=$e(y[1])),f.cellFormula){if((y=k.match(i))!=null&&y[1]!==""){if(E.f=$e(qe(y[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=lg(E.f)),y[0].indexOf('t="array"')>-1)E.F=(k.match(a)||[])[1],E.F.indexOf(":")>-1&&Z.push([ze(E.F),E.F]);else if(y[0].indexOf('t="shared"')>-1){H=Ae(y[0]);var le=$e(qe(y[1]));f.xlfn||(le=lg(le)),ee[parseInt(H.si,10)]=[H,le,S.r]}}else(y=k.match(/<f[^>]*\/>/))&&(H=Ae(y[0]),ee[H.si]&&(E.f=qF(ee[H.si][1],ee[H.si][2],S.r)));var ie=ft(S.r);for(v=0;v<Z.length;++v)ie.r>=Z[v][0].s.r&&ie.r<=Z[v][0].e.r&&ie.c>=Z[v][0].s.c&&ie.c<=Z[v][0].e.c&&(E.F=Z[v][1])}if(S.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(R)E.t="z";else continue;else E.t=S.t||"n";switch(d.s.c>A&&(d.s.c=A),d.e.c<A&&(d.e.c=A),E.t){case"n":if(E.v==""||E.v==null){if(!R)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!R)continue;E.t="z"}else U=Oo[parseInt(E.v,10)],E.v=U.t,E.r=U.r,f.cellHTML&&(E.h=U.h);break;case"str":E.t="s",E.v=E.v!=null?qe(E.v):"",f.cellHTML&&(E.h=Gh(E.v));break;case"inlineStr":y=k.match(n),E.t="s",y!=null&&(U=ip(y[1]))?(E.v=U.t,f.cellHTML&&(E.h=U.h)):E.v="";break;case"b":E.v=Ze(E.v);break;case"d":f.cellDates?E.v=tt(E.v,1):(E.v=Pt(tt(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=xw[E.v];break}if(b=V=0,W=null,J&&S.s!==void 0&&(W=x.CellXf[S.s],W!=null&&(W.numFmtId!=null&&(b=W.numFmtId),f.cellStyles&&W.fillId!=null&&(V=W.fillId))),h2(E,b,V,f,h,x),f.cellDates&&J&&E.t=="n"&&js(be[b])&&(E.t="d",E.v=e0(E.v)),S.cm&&f.xlmeta){var ce=(f.xlmeta.Cell||[])[+S.cm-1];ce&&ce.type=="XLDAPR"&&(E.D=!0)}if(G){var I=ft(S.r);u[I.r]||(u[I.r]=[]),u[I.r][I.c]=E}else u[S.r]=E}}}}B.length>0&&(u["!rows"]=B)}}();function eO(e,t,r,n){var a=[],s=[],i=ze(e["!ref"]),o="",l,u="",f=[],d=0,h=0,x=e["!rows"],g=Array.isArray(e),m={r:u},p,y=-1;for(h=i.s.c;h<=i.e.c;++h)f[h]=ut(h);for(d=i.s.r;d<=i.e.r;++d){for(s=[],u=kt(d),h=i.s.c;h<=i.e.c;++h){l=f[h]+u;var w=g?(e[d]||[])[h]:e[l];w!==void 0&&(o=QR(w,l,e,t))!=null&&s.push(o)}(s.length>0||x&&x[d])&&(m={r:u},x&&x[d]&&(p=x[d],p.hidden&&(m.hidden=1),y=-1,p.hpx?y=vl(p.hpx):p.hpt&&(y=p.hpt),y>-1&&(m.ht=y,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),a[a.length]=pe("row",s.join(""),m))}if(x)for(;d<x.length;++d)x&&x[d]&&(m={r:d+1},p=x[d],p.hidden&&(m.hidden=1),y=-1,p.hpx?y=vl(p.hpx):p.hpt&&(y=p.hpt),y>-1&&(m.ht=y,m.customHeight=1),p.level&&(m.outlineLevel=p.level),a[a.length]=pe("row","",m));return a.join("")}function m2(e,t,r,n){var a=[St,pe("worksheet",null,{xmlns:Fs[0],"xmlns:r":Rt.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=ze(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Pe(f)}n||(n={}),l["!comments"]=[];var d=[];MR(l,r,e,t,a),a[a.length]=pe("dimension",null,{ref:u}),a[a.length]=JR(l,t,e,r),t.sheetFormat&&(a[a.length]=pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=GR(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=eO(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=$R(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=XR(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=DR(l["!merges"]));var h=-1,x,g=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(x={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Ge(n,-1,Ke(m[1].Target).replace(/#.*$/,""),Me.HLINK),x["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(x.location=Ke(m[1].Target.slice(h+1))),m[1].Tooltip&&(x.tooltip=Ke(m[1].Tooltip)),a[a.length]=pe("hyperlink",null,x))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=HR(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Gt("ignoredErrors",pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(g=Ge(n,-1,"../drawings/drawing"+(e+1)+".xml",Me.DRAW),a[a.length]=pe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=Ge(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Me.VML),a[a.length]=pe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function tO(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function rO(e,t,r){var n=te(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=vl(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,x=f<<10;x<f+1<<10;++x){u.c=x;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ce(u)];g&&(d<0&&(d=x),h=x)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function nO(e,t,r,n){var a=rO(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&se(e,0,a)}var aO=Is,sO=Hi;function iO(){}function oO(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=uA(e),r}function lO(e,t,r){r==null&&(r=te(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return wu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),fw(e,r),r.slice(0,r.l)}function cO(e){var t=an(e);return[t]}function uO(e,t,r){return r==null&&(r=te(8)),Rs(t,r)}function fO(e){var t=Os(e);return[t]}function dO(e,t,r){return r==null&&(r=te(4)),Ps(t,r)}function hO(e){var t=an(e),r=e.read_shift(1);return[t,r,"b"]}function pO(e,t,r){return r==null&&(r=te(9)),Rs(t,r),r.write_shift(1,e.v?1:0),r}function mO(e){var t=Os(e),r=e.read_shift(1);return[t,r,"b"]}function xO(e,t,r){return r==null&&(r=te(5)),Ps(t,r),r.write_shift(1,e.v?1:0),r}function gO(e){var t=an(e),r=e.read_shift(1);return[t,r,"e"]}function vO(e,t,r){return r==null&&(r=te(9)),Rs(t,r),r.write_shift(1,e.v),r}function yO(e){var t=Os(e),r=e.read_shift(1);return[t,r,"e"]}function wO(e,t,r){return r==null&&(r=te(8)),Ps(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function _O(e){var t=an(e),r=e.read_shift(4);return[t,r,"s"]}function kO(e,t,r){return r==null&&(r=te(12)),Rs(t,r),r.write_shift(4,t.v),r}function SO(e){var t=Os(e),r=e.read_shift(4);return[t,r,"s"]}function EO(e,t,r){return r==null&&(r=te(8)),Ps(t,r),r.write_shift(4,t.v),r}function bO(e){var t=an(e),r=nr(e);return[t,r,"n"]}function TO(e,t,r){return r==null&&(r=te(16)),Rs(t,r),Ss(e.v,r),r}function x2(e){var t=Os(e),r=nr(e);return[t,r,"n"]}function NO(e,t,r){return r==null&&(r=te(12)),Ps(t,r),Ss(e.v,r),r}function CO(e){var t=an(e),r=tp(e);return[t,r,"n"]}function AO(e,t,r){return r==null&&(r=te(12)),Rs(t,r),dw(e.v,r),r}function jO(e){var t=Os(e),r=tp(e);return[t,r,"n"]}function FO(e,t,r){return r==null&&(r=te(8)),Ps(t,r),dw(e.v,r),r}function RO(e){var t=an(e),r=Qh(e);return[t,r,"is"]}function OO(e){var t=an(e),r=ar(e);return[t,r,"str"]}function PO(e,t,r){return r==null&&(r=te(12+4*e.v.length)),Rs(t,r),Mt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IO(e){var t=Os(e),r=ar(e);return[t,r,"str"]}function DO(e,t,r){return r==null&&(r=te(8+4*e.v.length)),Ps(t,r),Mt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function LO(e,t,r){var n=e.l+t,a=an(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=n0(e,n-e.l,r);i[3]=er(o,null,a,r.supbooks,r)}else e.l=n;return i}function MO(e,t,r){var n=e.l+t,a=an(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=n0(e,n-e.l,r);i[3]=er(o,null,a,r.supbooks,r)}else e.l=n;return i}function BO(e,t,r){var n=e.l+t,a=an(e);a.r=r["!row"];var s=nr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=n0(e,n-e.l,r);i[3]=er(o,null,a,r.supbooks,r)}else e.l=n;return i}function UO(e,t,r){var n=e.l+t,a=an(e);a.r=r["!row"];var s=ar(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=n0(e,n-e.l,r);i[3]=er(o,null,a,r.supbooks,r)}else e.l=n;return i}var $O=Is,zO=Hi;function WO(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function HO(e,t){var r=e.l+t,n=Is(e),a=Zh(e),s=ar(e),i=ar(e),o=ar(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function VO(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Hi({s:ft(e[0]),e:ft(e[0])},r),ep("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Mt(a||"",r),Mt(e[1].Tooltip||"",r),Mt("",r),r.slice(0,r.l)}function GO(){}function KO(e,t,r){var n=e.l+t,a=hw(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=gR(e,n-e.l,r);i[1]=o}else e.l=n;return i}function XO(e,t,r){var n=e.l+t,a=Is(e),s=[a];if(r.cellFormula){var i=yR(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function qO(e,t,r){r==null&&(r=te(18));var n=a0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var g2=["left","right","top","bottom","header","footer"];function YO(e){var t={};return g2.forEach(function(r){t[r]=nr(e)}),t}function JO(e,t){return t==null&&(t=te(6*8)),ms(e),g2.forEach(function(r){Ss(e[r],t)}),t}function QO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZO(e,t,r){r==null&&(r=te(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function eP(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),Hi(e,t),t}function tP(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?op(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function rP(){}function nP(){}function aP(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,x,g,m,p,y,w,v,_,k,E=[];o.biff=12,o["!row"]=0;var S=0,C=!1,A=[],U={},H=o.supbooks||a.supbooks||[[]];if(H.sharedf=U,H.arrayf=A,H.SheetNames=a.SheetNames||a.Sheets.map(function(G){return G.name}),!o.supbooks&&(o.supbooks=H,a.Names))for(var b=0;b<a.Names.length;++b)H[0][b+1]=a.Names[b];var V=[],J=[],W=!1;yl[16]={n:"BrtShortReal",f:x2};var Z;if(ca(e,function(B,ae,de){if(!h)switch(de){case 148:u=B;break;case 0:x=B,o.sheetRows&&o.sheetRows<=x.r&&(h=!0),_=kt(p=x.r),o["!row"]=x.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=Oi(B.hpt)),J[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:B[2]},B[2]){case"n":g.v=B[1];break;case"s":v=Oo[B[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!B[1];break;case"e":g.v=B[1],o.cellText!==!1&&(g.w=ua[g.v]);break;case"str":g.t="s",g.v=B[1];break;case"is":g.t="s",g.v=B[1].t;break}if((m=i.CellXf[B[0].iStyleRef])&&h2(g,m.numFmtId,null,o,s,i),y=B[0].c==-1?y+1:B[0].c,o.dense?(l[p]||(l[p]=[]),l[p][y]=g):l[ut(y)+_]=g,o.cellFormula){for(C=!1,S=0;S<A.length;++S){var R=A[S];x.r>=R[0].s.r&&x.r<=R[0].e.r&&y>=R[0].s.c&&y<=R[0].e.c&&(g.F=Pe(R[0]),C=!0)}!C&&B.length>3&&(g.f=B[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>y&&(f.s.c=y),f.e.r<x.r&&(f.e.r=x.r),f.e.c<y&&(f.e.c=y),o.cellDates&&m&&g.t=="n"&&js(be[m.numFmtId])){var z=Ea(g.v);z&&(g.t="d",g.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},y=B[0].c==-1?y+1:B[0].c,o.dense?(l[p]||(l[p]=[]),l[p][y]=g):l[ut(y)+_]=g,f.s.r>x.r&&(f.s.r=x.r),f.s.c>y&&(f.s.c=y),f.e.r<x.r&&(f.e.r=x.r),f.e.c<y&&(f.e.c=y),Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 176:E.push(B);break;case 49:Z=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var O=n["!id"][B.relId];for(O?(B.Target=O.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=O):B.relId==""&&(B.Target="#"+B.loc),p=B.rfx.s.r;p<=B.rfx.e.r;++p)for(y=B.rfx.s.c;y<=B.rfx.e.c;++y)o.dense?(l[p]||(l[p]=[]),l[p][y]||(l[p][y]={t:"z",v:void 0}),l[p][y].l=B):(w=Ce({c:y,r:p}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=B);break;case 426:if(!o.cellFormula)break;A.push(B),k=o.dense?l[p][y]:l[ut(y)+_],k.f=er(B[1],f,{r:x.r,c:y},H,o),k.F=Pe(B[0]);break;case 427:if(!o.cellFormula)break;U[Ce(B[0].s)]=B[1],k=o.dense?l[p][y]:l[ut(y)+_],k.f=er(B[1],f,{r:x.r,c:y},H,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)V[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},W||(W=!0,lp(B.w/256)),Ma(V[B.e+1]);break;case 161:l["!autofilter"]={ref:Pe(B)};break;case 476:l["!margins"]=B;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),B.name&&(a.Sheets[r].CodeName=B.name),(B.above||B.left)&&(l["!outline"]={above:B.above,left:B.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),B.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ae.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+de.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Pe(u||f)),o.sheetRows&&l["!ref"]){var ee=ze(l["!ref"]);o.sheetRows<=+ee.e.r&&(ee.e.r=o.sheetRows-1,ee.e.r>f.e.r&&(ee.e.r=f.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>f.e.c&&(ee.e.c=f.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Pe(ee))}return E.length>0&&(l["!merges"]=E),V.length>0&&(l["!cols"]=V),J.length>0&&(l["!rows"]=J),l}function sP(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=rt(t),t.z=t.z||be[14],t.v=Pt(tt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ka(a.cellXfs,t,a),t.l&&s["!links"].push([Ce(l),t.l]),t.c&&s["!comments"].push([Ce(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=hp(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?se(e,18,EO(t,l)):se(e,7,kO(t,l))):(l.t="str",i?se(e,17,DO(t,l)):se(e,6,PO(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?se(e,13,FO(t,l)):se(e,2,AO(t,l)):i?se(e,16,NO(t,l)):se(e,5,TO(t,l)),!0;case"b":return l.t="b",i?se(e,15,xO(t,l)):se(e,4,pO(t,l)),!0;case"e":return l.t="e",i?se(e,14,wO(t,l)):se(e,3,vO(t,l)),!0}return i?se(e,12,dO(t,l)):se(e,1,uO(t,l)),!0}function iP(e,t,r,n){var a=ze(t["!ref"]||"A1"),s,i="",o=[];se(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){i=kt(f),nO(e,t,a,f);var d=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(o[h]=ut(h)),s=o[h]+i;var x=l?(t[f]||[])[h]:t[s];if(!x){d=!1;continue}d=sP(e,x,f,h,n,t,d)}}se(e,146)}function oP(e,t){!t||!t["!merges"]||(se(e,177,WO(t["!merges"].length)),t["!merges"].forEach(function(r){se(e,176,zO(r))}),se(e,178))}function lP(e,t){!t||!t["!cols"]||(se(e,390),t["!cols"].forEach(function(r,n){r&&se(e,60,qO(n,r))}),se(e,391))}function cP(e,t){!t||!t["!ref"]||(se(e,648),se(e,649,eP(ze(t["!ref"]))),se(e,650))}function uP(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ge(r,-1,n[1].Target.replace(/#.*$/,""),Me.HLINK);se(e,494,VO(n,a))}}),delete t["!links"]}function fP(e,t,r,n){if(t["!comments"].length>0){var a=Ge(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Me.VML);se(e,551,ep("rId"+a)),t["!legacy"]=a}}function dP(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Pe(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Er(s);o.s.r==o.e.r&&(o.e.r=Er(t["!ref"]).e.r,s=Pe(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),se(e,161,Hi(ze(s))),se(e,162)}}function hP(e,t,r){se(e,133),se(e,137,ZO(t,r)),se(e,138),se(e,134)}function pP(e,t){t["!protect"]&&se(e,535,tP(t["!protect"]))}function mP(e,t,r,n){var a=Sr(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=ze(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],se(a,129),(r.vbaraw||i["!outline"])&&se(a,147,lO(o,i["!outline"])),se(a,148,sO(l)),hP(a,i,r.Workbook),lP(a,i),iP(a,i,e,t),pP(a,i),dP(a,i,r,e),oP(a,i),uP(a,i,n),i["!margins"]&&se(a,476,JO(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&cP(a,i),fP(a,i,e,n),se(a,130),a.end()}function xP(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=$e((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function gP(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=xP(d);f.s.r=f.s.c=0,f.e.c=o,u=ut(o),h[0].forEach(function(x,g){i[u+kt(g)]={t:"n",v:x,z:h[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Pe(f)),i}function vP(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(p2);return o&&pp(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function yP(e,t){e.l+=10;var r=ar(e);return{name:r}}function wP(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ca(e,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var mp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_P=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],kP=[],SP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hg(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ze(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function pg(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ze(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function v2(e){pg(e.WBProps,mp),pg(e.CalcPr,SP),hg(e.WBView,_P),hg(e.Sheets,kP),_i.date1904=Ze(e.WBProps.date1904)}function EP(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ze(e.Workbook.WBProps.date1904)?"true":"false"}var bP="][*?/\\".split("");function y2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bP.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function TP(e,t,r){e.forEach(function(n,a){y2(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function NP(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];TP(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)ER(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var CP=/<\w+:workbook/;function AP(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(or,function(l,u){var f=Ae(l);switch(Ln(f[0])){case"<?xml":break;case"<workbook":l.match(CP)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":mp.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Ze(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=qe(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=$e(qe(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=qe(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Ze(f.hidden||"0")&&(s.Hidden=!0),i=u+l.length;break;case"</definedName>":s.Ref=$e(qe(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),Fs.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return v2(r),r}function w2(e){var t=[St];t[t.length]=pe("workbook",null,{xmlns:Fs[0],"xmlns:r":Rt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(mp.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=pe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:Ke(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=pe("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=pe("definedName",Ke(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jP(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pd(e),r.name=ar(e),r}function FP(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ep(e.strRelID,t),Mt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function RP(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ar(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function OP(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),fw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function PP(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IP(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=fA(e),i=vR(e,0,r),o=Zh(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function DP(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],yl[16]={n:"BrtFRTArchID$",f:PP},ca(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=er(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),v2(r),r.Names=s,r.supbooks=i,r}function LP(e,t){se(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};se(e,156,FP(a))}se(e,144)}function MP(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Mt("SheetJS",t),Mt(hu.version,t),Mt(hu.version,t),Mt("7262",t),t.length>t.l?t.slice(0,t.l):t}function BP(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function UP(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(se(e,135),se(e,158,BP(a)),se(e,136))}}function $P(e,t){var r=Sr();return se(r,131),se(r,128,MP()),se(r,153,OP(e.Workbook&&e.Workbook.WBProps||null)),UP(r,e),LP(r,e),se(r,132),r.end()}function zP(e,t,r){return t.slice(-4)===".bin"?DP(e,r):AP(e,r)}function WP(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?aP(e,n,r,a,s,i,o):IR(e,n,r,a,s,i,o)}function HP(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?wP(e,n,r,a,s):vP(e,n,r,a,s)}function VP(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?KF():XF()}function GP(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?VF():GF()}function KP(e,t,r,n){return t.slice(-4)===".bin"?z5(e,r,n):j5(e,r,n)}function XP(e,t,r){return e2(e,r)}function qP(e,t,r){return t.slice(-4)===".bin"?q6(e,r):G6(e,r)}function YP(e,t,r){return t.slice(-4)===".bin"?UF(e,r):FF(e,r)}function JP(e,t,r){return t.slice(-4)===".bin"?CF(e):TF(e)}function QP(e,t,r,n){return r.slice(-4)===".bin"?AF(e,t,r,n):void 0}function ZP(e,t,r){return t.slice(-4)===".bin"?SF(e,t,r):bF(e,t,r)}function eI(e,t,r){return(t.slice(-4)===".bin"?$P:w2)(e)}function tI(e,t,r,n,a){return(t.slice(-4)===".bin"?mP:m2)(e,r,n,a)}function rI(e,t,r){return(t.slice(-4)===".bin"?Q5:Qw)(e,r)}function nI(e,t,r){return(t.slice(-4)===".bin"?Q6:Hw)(e,r)}function aI(e,t,r){return(t.slice(-4)===".bin"?$F:n2)(e)}function sI(e){return(e.slice(-4)===".bin"?EF:t2)()}var _2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,k2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function on(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(_2),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(k2),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function iI(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(_2),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(k2),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Io;function oI(e,t){var r=Io[e]||$e(e);return r==="General"?_s(t):Br(r,t)}function lI(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ze(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=tt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[$e(t)]=a}function cI(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ua[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=_s(e.v):e.w=oI(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Io[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&js(n)){var a=Ea(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function uI(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=k5[n.Pattern]||n.Pattern)}e[t.ID]=t}function fI(e,t,r,n,a,s,i,o,l,u){var f="General",d=n.StyleID,h={};u=u||{};var x=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&x.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ze(e);break;case"String":n.t="s",n.r=Fx($e(e)),n.v=e.indexOf("<")>-1?$e(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(tt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=$e(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=xw[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Fx(t||e));break}if(cI(n,f,u),u.cellFormula!==!1)if(n.Formula){var m=$e(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=wi(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=wi("RC:RC",a):n.ArrayRange&&(n.F=wi(n.ArrayRange,a),l.push([ze(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);u.cellStyles&&(x.forEach(function(p){!h.patternType&&p.patternType&&(h.patternType=p.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function dI(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ef(e,t){var r=t||{};zi();var n=mo(Kh(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=qe(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=rt(r);return i.type="string",Ri.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){a.indexOf("<"+nt)>=0&&(s=!0)}),s)return JI(n,r);Io={"General Number":"General","General Date":be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":be[15],"Short Date":be[14],"Long Time":be[19],"Medium Time":be[18],"Short Time":be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:be[2],Standard:be[4],Percent:be[10],Scientific:be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},d=[],h=r.dense?[]:{},x="",g={},m={},p=on('<Data ss:Type="String">'),y=0,w=0,v=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},E={},S="",C=0,A=[],U={},H={},b=0,V=[],J=[],W={},Z=[],ee,G=!1,B=[],ae=[],de={},R=0,z=0,O={Sheets:[],WBProps:{date1904:!1}},P={};hl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=hl.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?fI(n.slice(y,o.index),S,p,l[l.length-1][0]=="comment"?W:g,{c:w,r:v},k,Z[w],m,B,r):(S="",p=on(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(J.length>0&&(g.c=J),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=g):h[ut(w)+kt(v)]=g),g.HRef&&(g.l={Target:$e(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(R=w+(parseInt(g.MergeAcross,10)|0),z=v+(parseInt(g.MergeDown,10)|0),A.push({s:{c:w,r:v},e:{c:R,r:z}})),!r.sheetStubs)g.MergeAcross?w=R+1:++w;else if(g.MergeAcross||g.MergeDown){for(var re=w;re<=R;++re)for(var oe=v;oe<=z;++oe)(re>w||oe>v)&&(r.dense?(h[oe]||(h[oe]=[]),h[oe][re]={t:"z"}):h[ut(re)+kt(oe)]={t:"z"});w=R+1}else++w;else g=iI(o[0]),g.Index&&(w=+g.Index-1),w<_.s.c&&(_.s.c=w),w>_.e.c&&(_.e.c=w),o[0].slice(-2)==="/>"&&++w,J=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<_.s.r&&(_.s.r=v),v>_.e.r&&(_.e.r=v),o[0].slice(-2)==="/>"&&(m=on(o[0]),m.Index&&(v=+m.Index-1)),w=0,++v):(m=on(o[0]),m.Index&&(v=+m.Index-1),de={},(m.AutoFitHeight=="0"||m.Height)&&(de.hpx=parseInt(m.Height,10),de.hpt=vl(de.hpx),ae[v]=de),m.Hidden=="1"&&(de.hidden=!0,ae[v]=de));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(x),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Pe(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Pe(_))),A.length&&(h["!merges"]=A),Z.length>0&&(h["!cols"]=Z),ae.length>0&&(h["!rows"]=ae),f[x]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,l.push([o[3],!1]),u=on(o[0]),x=$e(u.Name),h=r.dense?[]:{},A=[],B=[],ae=[],P={name:x,Hidden:0},O.Sheets.push(P);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Z=[],G=!1}break;case"style":o[1]==="/"?uI(k,E,r):E=on(o[0]);break;case"numberformat":E.nf=$e(on(o[0]).Format||"General"),Io[E.nf]&&(E.nf=Io[E.nf]);for(var le=0;le!=392&&be[le]!=E.nf;++le);if(le==392){for(le=57;le!=392;++le)if(be[le]==null){Rn(E.nf,le);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ee=on(o[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!G&&ee.wpx>10){G=!0,rr=Yw;for(var ie=0;ie<Z.length;++ie)Z[ie]&&Ma(Z[ie])}G&&Ma(ee),Z[ee.Index-1||Z.length]=ee;for(var ce=0;ce<+ee.Span;++ce)Z[Z.length]=rt(ee);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var I=Ae(o[0]),je={Name:I.Name,Ref:wi(I.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(je.Sheet=O.Sheets.length-1),O.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=on(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?DA(U,K,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));dI(W),J.push(W)}else l.push([o[3],!1]),u=on(o[0]),W={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Re=on(o[0]);h["!autofilter"]={ref:wi(Re.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return yg(n,r);var He=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else b=o.index+o[0].length;break;case"header":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(h["!margins"].header=+Ae(o[0]).Margin);break;case"footer":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(h["!margins"].footer=+Ae(o[0]).Margin);break;case"pagemargins":var Oe=Ae(o[0]);h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Oe.Top)||(h["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(h["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(h["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(h["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?lI(H,K,V,n.slice(b,o.index)):(V=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ge={};return!r.bookSheets&&!r.bookProps&&(ge.Sheets=f),ge.SheetNames=d,ge.Workbook=O,ge.SSF=rt(be),ge.Props=U,ge.Custprops=H,ge}function _d(e,t){switch(gp(t=t||{}),t.type||"base64"){case"base64":return ef(Mr(e),t);case"binary":case"buffer":case"file":return ef(e,t);case"array":return ef(Va(e),t)}}function hI(e,t){var r=[];return e.Props&&r.push(LA(e.Props,t)),e.Custprops&&r.push(MA(e.Props,e.Custprops)),r.join("")}function pI(){return""}function mI(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(pe("NumberFormat",null,{"ss:Format":Ke(be[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(pe("Style",s.join(""),i))}),pe("Styles",r.join(""))}function S2(e){return pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+fp(e.Ref,{r:0,c:0})})}function xI(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(S2(a)))}return pe("Names",r.join(""))}function gI(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(S2(o)))}return s.join("")}function vI(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(pe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Gt("ProtectContents","True")),e["!protect"].objects&&a.push(Gt("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Gt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Gt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Gt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":pe("WorksheetOptions",a.join(""),{xmlns:Ar.x})}function yI(e){return e.map(function(t){var r=UC(t.t||""),n=pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return pe("Comment",n,{"ss:Author":t.a})}).join("")}function wI(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ke(fp(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=ft(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ke(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ke(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ua[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||be[14]);break;case"s":d="String",h=BC(e.v||"");break}var x=Ka(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=i.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=yI(e.c)),pe("Cell",m,o)}function _I(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Oi(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function kI(e,t,r,n){if(!e["!ref"])return"";var a=ze(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(p,y){Ma(p);var w=!!p.width,v=a0(y,p),_={"ss:Index":y+1};w&&(_["ss:Width"]=xl(v.width)),p.hidden&&(_["ss:Hidden"]="1"),o.push(pe("Column",null,_))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[_I(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>u)&&!(s[i].e.c<d)&&!(s[i].e.r<u)){(s[i].s.c!=d||s[i].s.r!=u)&&(h=!0);break}if(!h){var x={r:u,c:d},g=Ce(x),m=l?(e[u]||[])[d]:e[g];f.push(wI(m,g,e,t,r,n,x))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function SI(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?gI(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?kI(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(vI(s,t,e,r)),n.join("")}function EI(e,t){t||(t={}),e.SSF||(e.SSF=rt(be)),e.SSF&&(zi(),Rl(e.SSF),t.revssf=Zu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(hI(e,t)),r.push(pI()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(pe("Worksheet",SI(n,t,e),{"ss:Name":Ke(e.SheetNames[n])}));return r[2]=mI(e,t),r[3]=xI(e),St+pe("Workbook",r.join(""),{xmlns:Ar.ss,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:ss":Ar.ss,"xmlns:dt":Ar.dt,"xmlns:html":Ar.html})}function bI(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=xA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=gA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var TI=[60,1084,2066,2165,2175];function NI(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Kn(r,r.l),u=kd[l],f=0;u!=null&&TI.indexOf(l)>-1;)s=Kn(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,u=kd[l=Kn(r,r.l)];var d=Lt(i);Vt(d,0);var h=0;d.lens=[];for(var x=0;x<i.length;++x)d.lens.push(h),h+=i[x].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function En(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=be[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ua[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=_s(e.v):e.w=Br(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&js(be[n]||String(n))){var a=Ea(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function _c(e,t,r){return{v:e,ixfe:t,t:r}}function CI(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],u="",f={},d,h="",x,g,m,p,y={},w=[],v,_,k=[],E=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},A=function(Le){return Le<8?ds[Le]:Le<64&&E[Le-8]||ds[Le]},U=function(Le,yt,Wr){var At=yt.XF.data;if(!(!At||!At.patternType||!Wr||!Wr.cellStyles)){yt.s={},yt.s.patternType=At.patternType;var Xa;(Xa=ml(A(At.icvFore)))&&(yt.s.fgColor={rgb:Xa}),(Xa=ml(A(At.icvBack)))&&(yt.s.bgColor={rgb:Xa})}},H=function(Le,yt,Wr){if(!(de>1)&&!(Wr.sheetRows&&Le.r>=Wr.sheetRows)){if(Wr.cellStyles&&yt.XF&&yt.XF.data&&U(Le,yt,Wr),delete yt.ixfe,delete yt.XF,d=Le,h=Ce(Le),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<i.s.r&&(i.s.r=Le.r),Le.c<i.s.c&&(i.s.c=Le.c),Le.r+1>i.e.r&&(i.e.r=Le.r+1),Le.c+1>i.e.c&&(i.e.c=Le.c+1),Wr.cellFormula&&yt.f){for(var At=0;At<w.length;++At)if(!(w[At][0].s.c>Le.c||w[At][0].s.r>Le.r)&&!(w[At][0].e.c<Le.c||w[At][0].e.r<Le.r)){yt.F=Pe(w[At][0]),(w[At][0].s.c!=Le.c||w[At][0].s.r!=Le.r)&&delete yt.f,yt.f&&(yt.f=""+er(w[At][1],i,Le,B,b));break}}Wr.dense?(a[Le.r]||(a[Le.r]=[]),a[Le.r][Le.c]=yt):a[h]=yt}},b={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var V,J=[],W=[],Z=[],ee=[],G=!1,B=[];B.SheetNames=b.snames,B.sharedf=b.sharedf,B.arrayf=b.arrayf,B.names=[],B.XTI=[];var ae=0,de=0,R=0,z=[],O=[],P;b.codepage=1200,pn(1200);for(var K=!1;e.l<e.length-1;){var re=e.l,oe=e.read_shift(2);if(oe===0&&ae===10)break;var le=e.l===e.length?0:e.read_shift(2),ie=kd[oe];if(ie&&ie.f){if(t.bookSheets&&ae===133&&oe!==133)break;if(ae=oe,ie.r===2||ie.r==12){var ce=e.read_shift(2);if(le-=2,!b.enc&&ce!==oe&&((ce&255)<<8|ce>>8)!==oe)throw new Error("rt mismatch: "+ce+"!="+oe);ie.r==12&&(e.l+=10,le-=10)}var I={};if(oe===10?I=ie.f(e,le,b):I=NI(oe,ie,e,le,b),de==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(oe){case 34:r.opts.Date1904=S.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=I;break;case 66:var je=Number(I);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}pn(b.codepage=je),K=!0;break;case 317:b.rrtabid=I;break;case 25:b.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:b.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:k.push(I);break;case 430:B.push([I]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(I);break;case 24:case 536:P={Name:I.Name,Ref:er(I.rgce,i,null,B,b)},I.itab>0&&(P.Sheet=I.itab-1),B.names.push(P),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(O[I.itab-1]={ref:Pe(I.rgce[0][0][1][2])});break;case 22:b.ExternCount=I;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(I),B.XTI=B.XTI.concat(I);break;case 2196:if(b.biff<8)break;P!=null&&(P.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&b.WTF&&console.error("Password verifier: "+I);break;case 133:s[I.pos]=I,b.snames.push(I.name);break;case 10:{if(--de)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Pe(i),t.sheetRows&&t.sheetRows<=i.e.r){var Re=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Pe(i),i.e.r=Re}i.e.r++,i.e.c++}J.length>0&&(a["!merges"]=J),W.length>0&&(a["!objects"]=W),Z.length>0&&(a["!cols"]=Z),ee.length>0&&(a["!rows"]=ee),S.Sheets.push(C)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),b.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(b.biff=5,K=!0,pn(b.codepage=28591)),b.biff==8&&I.BIFFVer==0&&I.dt==16&&(b.biff=2),de++)break;if(a=t.dense?[]:{},b.biff<8&&!K&&(K=!0,pn(b.codepage=t.codepage||1252)),b.biff<5||I.BIFFVer==0&&I.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-le,name:u};s[He.pos]=He,b.snames.push(u)}else u=(s[re]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),J=[],W=[],b.arrayf=w=[],Z=[],ee=[],G=!1,C={Hidden:(s[re]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[I.r]||[])[I.c]:a[Ce({c:I.c,r:I.r})])&&++I.c,v={ixfe:I.ixfe,XF:k[I.ixfe]||{},v:I.val,t:"n"},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t);break;case 5:case 517:v={ixfe:I.ixfe,XF:k[I.ixfe],v:I.val,t:I.t},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t);break;case 638:v={ixfe:I.ixfe,XF:k[I.ixfe],v:I.rknum,t:"n"},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t);break;case 189:for(var Oe=I.c;Oe<=I.C;++Oe){var ge=I.rkrec[Oe-I.c][0];v={ixfe:ge,XF:k[ge],v:I.rkrec[Oe-I.c][1],t:"n"},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:Oe,r:I.r},v,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){o=I;break}if(v=_c(I.val,I.cell.ixfe,I.tt),v.XF=k[v.ixfe],t.cellFormula){var nt=I.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var xr=nt[0][0][1][0],_n=nt[0][0][1][1],Bn=Ce({r:xr,c:_n});y[Bn]?v.f=""+er(I.formula,i,I.cell,B,b):v.F=((t.dense?(a[xr]||[])[_n]:a[Bn])||{}).F}else v.f=""+er(I.formula,i,I.cell,B,b)}R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H(I.cell,v,t),o=I}break;case 7:case 519:if(o)o.val=I,v=_c(I,o.cell.ixfe,"s"),v.XF=k[v.ixfe],t.cellFormula&&(v.f=""+er(o.formula,i,o.cell,B,b)),R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(I);var Vi=Ce(I[0].s);if(x=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[Vi],t.cellFormula&&x){if(!o||!Vi||!x)break;x.f=""+er(I[1],i,I[0],B,b),x.F=Pe(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[Ce(o.cell)]=I[0],x=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ce(o.cell)],(x||{}).f=""+er(I[0],i,d,B,b)}}break;case 253:v=_c(l[I.isst].t,I.ixfe,"s"),l[I.isst].h&&(v.h=l[I.isst].h),v.XF=k[v.ixfe],R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:I.ixfe,XF:k[I.ixfe],t:"z"},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t));break;case 190:if(t.sheetStubs)for(var fa=I.c;fa<=I.C;++fa){var br=I.ixfe[fa-I.c];v={ixfe:br,XF:k[br],t:"z"},R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:fa,r:I.r},v,t)}break;case 214:case 516:case 4:v=_c(I.val,I.ixfe,"s"),v.XF=k[v.ixfe],R>0&&(v.z=z[v.ixfe>>8&63]),En(v,t,r.opts.Date1904),H({c:I.c,r:I.r},v,t);break;case 0:case 512:de===1&&(i=I);break;case 252:l=I;break;case 1054:if(b.biff==4){z[R++]=I[1];for(var Un=0;Un<R+163&&be[Un]!=I[1];++Un);Un>=163&&Rn(I[1],R+163)}else Rn(I[1],I[0]);break;case 30:{z[R++]=I;for(var da=0;da<R+163&&be[da]!=I;++da);da>=163&&Rn(I,R+163)}break;case 229:J=J.concat(I);break;case 93:W[I.cmo[0]]=b.lastobj=I;break;case 438:b.lastobj.TxO=I;break;case 127:b.lastobj.ImData=I;break;case 440:for(p=I[0].s.r;p<=I[0].e.r;++p)for(m=I[0].s.c;m<=I[0].e.c;++m)x=t.dense?(a[p]||[])[m]:a[Ce({c:m,r:p})],x&&(x.l=I[1]);break;case 2048:for(p=I[0].s.r;p<=I[0].e.r;++p)for(m=I[0].s.c;m<=I[0].e.c;++m)x=t.dense?(a[p]||[])[m]:a[Ce({c:m,r:p})],x&&x.l&&(x.l.Tooltip=I[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;x=t.dense?(a[I[0].r]||[])[I[0].c]:a[Ce(I[0])];var Gi=W[I[2]];x||(t.dense?(a[I[0].r]||(a[I[0].r]=[]),x=a[I[0].r][I[0].c]={t:"z"}):x=a[Ce(I[0])]={t:"z"},i.e.r=Math.max(i.e.r,I[0].r),i.s.r=Math.min(i.s.r,I[0].r),i.e.c=Math.max(i.e.c,I[0].c),i.s.c=Math.min(i.s.c,I[0].c)),x.c||(x.c=[]),g={a:I[1],t:Gi.TxO.t},x.c.push(g)}break;case 2173:mF(k[I.ixfe],I.ext);break;case 125:{if(!b.cellStyles)break;for(;I.e>=I.s;)Z[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},G||(G=!0,lp(I.w/256)),Ma(Z[I.e+1])}break;case 520:{var lr={};I.level!=null&&(ee[I.r]=lr,lr.level=I.level),I.hidden&&(ee[I.r]=lr,lr.hidden=!0),I.hpt&&(ee[I.r]=lr,lr.hpt=I.hpt,lr.hpx=Oi(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ms(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=I;break;case 161:a["!margins"]||ms(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(S.Views[0].RTL=!0);break;case 146:E=I;break;case 2198:V=I;break;case 140:_=I;break;case 442:u?C.CodeName=I||C.name:S.WBProps.CodeName=I||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=le}return r.SheetNames=vt(s).sort(function(kn,Le){return Number(kn)-Number(Le)}).map(function(kn){return s[kn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&O.forEach(function(kn,Le){r.Sheets[r.SheetNames[Le]]["!autofilter"]=kn}),r.Strings=l,r.SSF=rt(be),b.enc&&(r.Encryption=b.enc),V&&(r.Themes=V),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),B.names.length>0&&(S.Names=B.names),r.Workbook=S,r}var Do={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AI(e,t,r){var n=Ee.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=qx(n,md,Do.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=Ee.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=qx(i,xd,Do.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(kw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function jI(e,t){var r=[],n=[],a=[],s=0,i,o=bx(md,"n"),l=bx(xd,"n");if(e.Props)for(i=vt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=vt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)Aw.indexOf(a[s][0])>-1||_w.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Ee.utils.cfb_add(t,"/SummaryInformation",Yx(n,Do.SI,l,xd)),(r.length||u.length)&&Ee.utils.cfb_add(t,"/DocumentSummaryInformation",Yx(r,Do.DSI,o,md,u.length?u:null,Do.UDI))}function E2(e,t){t||(t={}),gp(t),Mh(),t.codepage&&Lh(t.codepage);var r,n;if(e.FullPaths){if(Ee.find(e,"/encryption"))throw new Error("File is password-protected");r=Ee.find(e,"!CompObj"),n=Ee.find(e,"/Workbook")||Ee.find(e,"/Book")}else{switch(t.type){case"base64":e=Or(Mr(e));break;case"binary":e=Or(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Vt(e,0),n={content:e}}var a,s;if(r&&bI(r),t.bookProps&&!t.bookSheets)a={};else{var i=De?"buffer":"array";if(n&&n.content)a=CI(n.content,t);else if((s=Ee.find(e,"PerfectOffice_MAIN"))&&s.content)a=ps.to_workbook(s.content,(t.type=i,t));else if((s=Ee.find(e,"NativeContent_MAIN"))&&s.content)a=ps.to_workbook(s.content,(t.type=i,t));else throw(s=Ee.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ee.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=WF(e))}var o={};return e.FullPaths&&AI(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function FI(e,t){var r=t||{},n=Ee.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ee.utils.cfb_add(n,a,b2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&jI(e,n),r.biff==8&&e.vbaraw&&HF(n,Ee.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var yl={0:{f:tO},1:{f:cO},2:{f:CO},3:{f:gO},4:{f:hO},5:{f:bO},6:{f:OO},7:{f:_O},8:{f:UO},9:{f:BO},10:{f:LO},11:{f:MO},12:{f:fO},13:{f:jO},14:{f:yO},15:{f:mO},16:{f:x2},17:{f:IO},18:{f:SO},19:{f:Qh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IP},40:{},42:{},43:{f:O5},44:{f:F5},45:{f:D5},46:{f:M5},47:{f:L5},48:{},49:{f:aA},50:{},51:{f:vF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uw},62:{f:RO},63:{f:NF},64:{f:rP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ir,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:QO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oO},148:{f:aO,p:16},151:{f:GO},152:{},153:{f:RP},154:{},155:{},156:{f:jP},157:{},158:{},159:{T:1,f:X6},160:{T:-1},161:{T:1,f:Is},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$O},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xF},336:{T:-1},337:{f:_F,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Bw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KO},427:{f:XO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:MF},633:{T:1},634:{T:-1},635:{T:1,f:DF},636:{T:-1},637:{f:lA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:nP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kd={6:{f:Q0},10:{f:pa},12:{f:Tt},13:{f:Tt},14:{f:wt},15:{f:wt},16:{f:nr},17:{f:wt},18:{f:wt},19:{f:Tt},20:{f:rg},21:{f:rg},23:{f:Bw},24:{f:ag},25:{f:wt},26:{},27:{},28:{f:n6},29:{},34:{f:wt},35:{f:ng},38:{f:nr},39:{f:nr},40:{f:nr},41:{f:nr},42:{f:wt},43:{f:wt},47:{f:m5},49:{f:jj},51:{f:Tt},60:{},61:{f:bj},64:{f:wt},65:{f:Aj},66:{f:Tt},77:{},80:{},81:{},82:{},85:{f:Tt},89:{},90:{},91:{},92:{f:pj},93:{f:i6},94:{},95:{f:wt},96:{},97:{},99:{f:wt},125:{f:Uw},128:{f:Vj},129:{f:xj},130:{f:Tt},131:{f:wt},132:{f:wt},133:{f:gj},134:{},140:{f:p6},141:{f:Tt},144:{},146:{f:g6},151:{},152:{},153:{},154:{},155:{},156:{f:Tt},157:{},158:{},160:{f:E6},161:{f:w6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$j},190:{f:zj},193:{f:pa},197:{},198:{},199:{},200:{},201:{},202:{f:wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tt},220:{},221:{f:wt},222:{},224:{f:Hj},225:{f:hj},226:{f:pa},227:{},229:{f:a6},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yj},253:{f:Rj},255:{f:_j},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wt},353:{f:pa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Yj},431:{f:wt},432:{},433:{},434:{},437:{},438:{f:c6},439:{f:wt},440:{f:u6},441:{},442:{f:Dl},443:{},444:{f:Tt},445:{},446:{},448:{f:pa},449:{f:Ej,r:2},450:{f:pa},512:{f:Zx},513:{f:S6},515:{f:Xj},516:{f:Pj},517:{f:tg},519:{f:b6},520:{f:kj},523:{},545:{f:sg},549:{f:Qx},566:{},574:{f:Nj},638:{f:Uj},659:{},1048:{},1054:{f:Dj},1084:{},1212:{f:e6},2048:{f:d6},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:v6,r:12},2173:{f:pF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Zj,r:12},2197:{},2198:{f:lF,r:12},2199:{},2200:{},2201:{},2202:{f:t6,r:12},2203:{f:pa},2204:{},2205:{},2206:{},2207:{},2211:{f:Sj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:x6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zx},1:{},2:{f:j6},3:{f:C6},4:{f:N6},5:{f:tg},7:{f:R6},8:{},9:{f:vc},11:{},22:{f:Tt},30:{f:Mj},31:{},32:{},33:{f:sg},36:{},37:{f:Qx},50:{f:O6},62:{},52:{},67:{},68:{f:Tt},69:{},86:{},126:{},127:{f:T6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:P6},223:{},234:{},354:{},421:{},518:{f:Q0},521:{f:vc},536:{f:ag},547:{f:ng},561:{},579:{},1030:{f:Q0},1033:{f:vc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function me(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&qh(r)&&e.push(r)}}function RI(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return me(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Ul(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function OI(e,t,r,n){var a=te(9);return Ul(a,e,t),Fw(r,n||"b",a),a}function PI(e,t,r){var n=te(8+2*r.length);return Ul(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function II(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Pt(tt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?me(e,2,F6(r,n,a)):me(e,3,A6(r,n,a));return;case"b":case"e":me(e,5,OI(r,n,t.v,t.t));return;case"s":case"str":me(e,4,PI(r,n,(t.v||"").slice(0,255)));return}me(e,1,Ul(null,r,n))}function DI(e,t,r,n){var a=Array.isArray(t),s=ze(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Pe(s)}for(var u=s.s.r;u<=s.e.r;++u){o=kt(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=ut(f)),i=l[f]+o;var d=a?(t[u]||[])[f]:t[i];d&&II(e,d,u,f)}}}function LI(e,t){for(var r=t||{},n=Sr(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return me(n,r.biff==4?1033:r.biff==3?521:9,sp(e,16,r)),DI(n,e.Sheets[e.SheetNames[a]],a,r),me(n,10),n.end()}function MI(e,t,r){me(e,49,Fj({sz:12,name:"Arial"},r))}function BI(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&me(e,1054,Lj(a,t[a],r))})}function UI(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),me(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Dw(ze(t["!ref"]||"A1"),r),r.write_shift(4,4),me(e,2152,r)}function $I(e,t){for(var r=0;r<16;++r)me(e,224,eg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){me(e,224,eg(n,0,t))})}function zI(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];me(e,440,f6(n)),n[1].Tooltip&&me(e,2048,h6(n))}delete t["!links"]}function WI(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&me(e,125,y6(a0(a,n),a))})}}function HI(e,t,r,n,a){var s=16+Ka(a.cellXfs,t,a);if(t.v==null&&!t.bf){me(e,513,bs(r,n,s));return}if(t.bf)me(e,6,xR(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?Pt(tt(t.v)):t.v;me(e,515,qj(r,n,i,s));break;case"b":case"e":me(e,517,Kj(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=hp(a.Strings,t.v,a.revStrings);me(e,253,Oj(r,n,o,s))}else me(e,516,Ij(r,n,(t.v||"").slice(0,255),s,a));break;default:me(e,513,bs(r,n,s))}}function VI(e,t,r){var n=Sr(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,f,d="",h=[],x=ze(s["!ref"]||"A1"),g=u?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,g-1)}me(n,2057,sp(r,16,t)),me(n,13,qr(1)),me(n,12,qr(100)),me(n,15,fr(!0)),me(n,17,fr(!1)),me(n,16,Ss(.001)),me(n,95,fr(!0)),me(n,42,fr(!1)),me(n,43,fr(!1)),me(n,130,qr(1)),me(n,128,Gj()),me(n,131,fr(!1)),me(n,132,fr(!1)),u&&WI(n,s["!cols"]),me(n,512,Bj(x,t)),u&&(s["!links"]=[]);for(var m=x.s.r;m<=x.e.r;++m){d=kt(m);for(var p=x.s.c;p<=x.e.c;++p){m===x.s.r&&(h[p]=ut(p)),f=h[p]+d;var y=l?(s[m]||[])[p]:s[f];y&&(HI(n,y,m,p,t),u&&y.l&&s["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||a;return u&&me(n,574,Cj((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&me(n,229,s6(s["!merges"])),u&&zI(n,s),me(n,442,Rw(w)),u&&UI(n,s),me(n,10),n.end()}function GI(e,t,r){var n=Sr(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(me(n,2057,sp(e,5,r)),r.bookType=="xla"&&me(n,135),me(n,225,o?qr(1200):null),me(n,193,KA(2)),l&&me(n,191),l&&me(n,192),me(n,226),me(n,92,mj("SheetJS",r)),me(n,66,qr(o?1200:1252)),o&&me(n,353,qr(0)),o&&me(n,448),me(n,317,k6(e.SheetNames.length)),o&&e.vbaraw&&me(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";me(n,442,Rw(u))}me(n,156,qr(17)),me(n,25,fr(!1)),me(n,18,fr(!1)),me(n,19,qr(0)),o&&me(n,431,fr(!1)),o&&me(n,444,qr(0)),me(n,61,Tj()),me(n,64,fr(!1)),me(n,141,qr(0)),me(n,34,fr(EP(e)=="true")),me(n,14,fr(!0)),o&&me(n,439,fr(!1)),me(n,218,qr(0)),MI(n,e,r),BI(n,e.SSF,r),$I(n,r),o&&me(n,352,fr(!1));var f=n.end(),d=Sr();o&&me(d,140,m6()),o&&r.Strings&&RI(d,252,wj(r.Strings)),me(d,10);var h=d.end(),x=Sr(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var p=f.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var y=s[m]||{};me(x,133,vj({pos:p,hs:y.Hidden||0,dt:0,name:e.SheetNames[m]},r)),p+=t[m].length}var w=x.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var v=[];return f.length&&v.push(f),w.length&&v.push(w),h.length&&v.push(h),Lt(v)}function KI(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=rt(be)),e&&e.SSF&&(zi(),Rl(e.SSF),r.revssf=Zu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vp(r),r.cellXfs=[],Ka(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=VI(a,r,e);return n.unshift(GI(e,n,r)),Lt(n)}function b2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Er(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return KI(e,t);case 4:case 3:case 2:return LI(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function mg(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=FC(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var m=l[i].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(p!="<td"&&p!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,_=0;v.charAt(0)=="<"&&(_=v.indexOf(">"))>-1;)v=v.slice(_+1);for(var k=0;k<g.length;++k){var E=g[k];E.s.c==f&&E.s.r<u&&u<=E.e.r&&(f=E.e.c+1,k=-1)}var S=Ae(w.slice(0,w.indexOf(">")));h=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||h>1)&&g.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var C=S.t||S["data-t"]||"";if(!v.length){f+=h;continue}if(v=qy(v),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>f&&(x.s.c=f),x.e.c<f&&(x.e.c=f),!v.length){f+=h;continue}var A={t:"s",v};r.raw||!v.trim().length||C=="s"||(v==="TRUE"?A={t:"b",v:!0}:v==="FALSE"?A={t:"b",v:!1}:isNaN(vn(v))?isNaN(Fi(v).getDate())||(A={t:"d",v:tt(v)},r.cellDates||(A={t:"n",v:Pt(A.v)}),A.z=r.dateNF||be[14]):A={t:"n",v:vn(v)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=A):n[Ce({r:u,c:f})]=A,f+=h}}}}return n["!ref"]=Pe(x),g.length&&(n["!merges"]=g),n}function XI(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Ce({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||Gh(d.w||(aa(d),d.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(x["data-t"]=d&&d.t||"z",d.v!=null&&(x["data-v"]=d.v),d.z!=null&&(x["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),x.id=(n.id||"sjs")+"-"+f,s.push(pe("td",h,x))}}var g="<tr>";return g+s.join("")+"</tr>"}var qI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YI="</body></html>";function JI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ga(mg(r[0],t),t);var n=_p();return r.forEach(function(a,s){kp(n,mg(a,t),"Sheet"+(s+1))}),n}function QI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function T2(e,t){var r=t||{},n=r.header!=null?r.header:qI,a=r.footer!=null?r.footer:YI,s=[n],i=Er(e["!ref"]);r.dense=Array.isArray(e),s.push(QI(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(XI(e,i,o,r));return s.push("</table>"+a),s.join("")}function N2(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?ft(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Er(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],h=0,x=e["!rows"]||(e["!rows"]=[]),g=0,m=0,p=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<l;++g){var _=o[g];if(xg(_)){if(n.display)continue;x[m]={hidden:!0}}var k=_.children;for(p=y=0;p<k.length;++p){var E=k[p];if(!(n.display&&xg(E))){var S=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):qy(E.innerHTML),C=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<d.length;++h){var A=d[h];A.s.c==y+s&&A.s.r<m+a&&m+a<=A.e.r&&(y=A.e.c+1-s,h=-1)}v=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||v>1)&&d.push({s:{r:m+a,c:y+s},e:{r:m+a+(w||1)-1,c:y+s+(v||1)-1}});var U={t:"s",v:S},H=E.getAttribute("data-t")||E.getAttribute("t")||"";S!=null&&(S.length==0?U.t=H||"z":n.raw||S.trim().length==0||H=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(vn(S))?isNaN(Fi(S).getDate())||(U={t:"d",v:tt(S)},n.cellDates||(U={t:"n",v:Pt(U.v)}),U.z=n.dateNF||be[14]):U={t:"n",v:vn(S)})),U.z===void 0&&C!=null&&(U.z=C);var b="",V=E.getElementsByTagName("A");if(V&&V.length)for(var J=0;J<V.length&&!(V[J].hasAttribute("href")&&(b=V[J].getAttribute("href"),b.charAt(0)!="#"));++J);b&&b.charAt(0)!="#"&&(U.l={Target:b}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][y+s]=U):e[Ce({c:y+s,r:m+a})]=U,u.e.c<y+s&&(u.e.c=y+s),y+=v}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+a),e["!ref"]=Pe(u),m>=l&&(e["!fullref"]=Pe((u.e.r=o.length-g+m-1+a,u))),e}function C2(e,t){var r=t||{},n=r.dense?[]:{};return N2(n,e,t)}function ZI(e,t){return Ga(C2(e,t),t)}function xg(e){var t="",r=eD(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function eD(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function tD(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=$e(t.replace(/<[^>]*>/g,""));return[r]}var gg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function A2(e,t){var r=t||{},n=Kh(e),a=[],s,i,o={name:""},l="",u=0,f,d,h={},x=[],g=r.dense?[]:{},m,p,y={value:""},w="",v=0,_=[],k=-1,E=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,A={},U=[],H={},b=0,V=0,J=[],W=1,Z=1,ee=[],G={Names:[]},B={},ae=["",""],de=[],R={},z="",O=0,P=!1,K=!1,re=0;for(hl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=hl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=Pe(S):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=r.sheetRows-1,g["!ref"]=Pe(S)),U.length&&(g["!merges"]=U),J.length&&(g["!rows"]=J),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),x.push(f.name),h[f.name]=g,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Ae(m[0],!1),k=E=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=r.dense?[]:{},U=[],J=[],K=!0);break;case"table-row-group":m[1]==="/"?--C:++C;break;case"table-row":case"":if(m[1]==="/"){k+=W,W=1;break}if(d=Ae(m[0],!1),d.?k=d.-1:k==-1&&(k=0),W=+d["number-rows-repeated"]||1,W<10)for(re=0;re<W;++re)C>0&&(J[k+re]={level:C});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[k]||(g[k]=[]),g[k][E]={t:"z"}):g[Ce({r:k,c:E})]={t:"z"}),w="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++E,y=Ae(m[0],!1),Z=parseInt(y["number-columns-repeated"]||"1",10),p={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(p.f=dg($e(y.formula))),(y.||y["value-type"])=="string"&&(p.t="s",p.v=$e(y["string-value"]||""),r.dense?(g[k]||(g[k]=[]),g[k][E]=p):g[Ce({r:k,c:E})]=p),E+=Z-1;else if(m[1]!=="/"){++E,w="",v=0,_=[],Z=1;var oe=W?k+W-1:k;if(E>S.e.c&&(S.e.c=E),E<S.s.c&&(S.s.c=E),k<S.s.r&&(S.s.r=k),oe>S.e.r&&(S.e.r=oe),y=Ae(m[0],!1),de=[],R={},p={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=$e(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(b=parseInt(y["number-matrix-rows-spanned"],10)||0,V=parseInt(y["number-matrix-columns-spanned"],10)||0,H={s:{r:k,c:E},e:{r:k+b-1,c:E+V-1}},p.F=Pe(H),ee.push([H,p.F])),y.formula)p.f=dg(y.formula);else for(re=0;re<ee.length;++re)k>=ee[re][0].s.r&&k<=ee[re][0].e.r&&E>=ee[re][0].s.c&&E<=ee[re][0].e.c&&(p.F=ee[re][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(b=parseInt(y["number-rows-spanned"],10)||0,V=parseInt(y["number-columns-spanned"],10)||0,H={s:{r:k,c:E},e:{r:k+b-1,c:E+V-1}},U.push(H)),y["number-columns-repeated"]&&(Z=parseInt(y["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=Ze(y["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(y.value);break;case"percentage":p.t="n",p.v=parseFloat(y.value);break;case"currency":p.t="n",p.v=parseFloat(y.value);break;case"date":p.t="d",p.v=tt(y["date-value"]),r.cellDates||(p.t="n",p.v=Pt(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=CC(y["time-value"])/86400,r.cellDates&&(p.t="d",p.v=e0(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(y.);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",y["string-value"]!=null&&(w=$e(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(P=!1,p.t==="s"&&(p.v=w||"",_.length&&(p.R=_),P=v==0),B.Target&&(p.l=B),de.length>0&&(p.c=de,de=[]),w&&r.cellText!==!1&&(p.w=w),P&&(p.t="z",delete p.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var le=0;le<W;++le){if(Z=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[k+le]||(g[k+le]=[]),g[k+le][E]=le==0?p:rt(p);--Z>0;)g[k+le][E+Z]=rt(p);else for(g[Ce({r:k+le,c:E})]=p;--Z>0;)g[Ce({r:k+le,c:E+Z})]=rt(p);S.e.c<=E&&(S.e.c=E)}Z=parseInt(y["number-columns-repeated"]||"1",10),E+=Z-1,Z=0,p={},w="",_=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;R.t=w,_.length&&(R.R=_),R.a=z,de.push(R)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);z="",O=0,w="",v=0,_=[];break;case"creator":m[1]==="/"?z=n.slice(O,m.index):O=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);w="",v=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(A[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ae(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ae(m[0],!1),l+=gg[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ae(m[0],!1),l+=gg[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":i=Ae(m[0],!1),ae=Z0(i["cell-range-address"]);var ie={Name:i.name,Ref:ae[0]+"!"+ae[1]};K&&(ie.Sheet=x.length),G.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var ce=tD(n.slice(v,m.index));w=(w.length>0?w+`
`:"")+ce[0]}else Ae(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ae=Z0(Ae(m[0])["target-range-address"]),h[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(B=Ae(m[0],!1),!B.href)break;B.Target=$e(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(ae=Z0(B.Target.slice(1)),B.Target="#"+ae[0]+"!"+ae[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var I={Sheets:h,SheetNames:x,Workbook:G};return r.bookSheets&&delete I.Sheets,I}function vg(e,t){t=t||{},Xr(e,"META-INF/manifest.xml")&&CA(bt(e,"META-INF/manifest.xml"),t);var r=Pr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=A2(qe(r),t);return Xr(e,"meta.xml")&&(n.Props=yw(bt(e,"meta.xml"))),n}function yg(e,t){return A2(e,t)}var rD=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return St+t}}(),wg=function(){var e=function(s){return Ke(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+Ke(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=Er(s["!ref"]||"A1"),h=s["!merges"]||[],x=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(u=0;u<d.s.r;++u)m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=d.e.r;++u){for(m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var y=!1,w={},v="";for(x=0;x!=h.length;++x)if(!(h[x].s.c>f)&&!(h[x].s.r>u)&&!(h[x].e.c<f)&&!(h[x].e.r<u)){(h[x].s.c!=f||h[x].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=h[x].e.c-h[x].s.c+1,w["table:number-rows-spanned"]=h[x].e.r-h[x].s.r+1;break}if(y){l.push(r);continue}var _=Ce({r:u,c:f}),k=g?(s[u]||[])[f]:s[_];if(k&&k.f&&(w["table:formula"]=Ke(kR(k.f)),k.F&&k.F.slice(0,_.length)==_)){var E=Er(k.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!k){l.push(t);continue}switch(k.t){case"b":v=k.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=k.v?"true":"false";break;case"n":v=k.w||String(k.v||0),w["office:value-type"]="float",w["office:value"]=k.v||0;break;case"s":case"str":v=k.v==null?"":k.v,w["office:value-type"]="string";break;case"d":v=k.w||tt(k.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=tt(k.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(v);if(k.l&&k.l.Target){var C=k.l.Target;C=C.charAt(0)=="#"?"#"+SR(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),S=pe("text:a",S,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+pe("table:table-cell",pe("text:p",S,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ma(d),d.ods=o;var h=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[St],u=dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(vw().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function j2(e,t){if(t.bookType=="fods")return wg(e,t);var r=Wh(),n="",a=[],s=[];return n="mimetype",Ie(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ie(r,n,wg(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ie(r,n,rD(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ie(r,n,St+vw()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ie(r,n,FA(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ie(r,n,AA(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ts(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Sd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qe(Va(e))}function nD(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Or(An(e))}function aD(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ua(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function _g(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function sD(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function iD(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function wl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ve(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function gt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function We(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=wl(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=wl(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Wt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Ve(n*8+a.type)),a.type==2&&t.push(Ve(a.data.length)),t.push(a.data))})}),Ua(t)}function xp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Gr(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=wl(e,n),s=We(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:gt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=We(o.data),u=gt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=gt(s[3][0].data)>>>0>0),r.push(i)}return r}function Vs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ve(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ve(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Ve(i.data.length)}],n[2].push({data:Wt(i.meta),type:2})});var s=Wt(n);t.push(Ve(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),Ua(t)}function oD(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=wl(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ua(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var f=Ua(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Kr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(oD(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ua(t)}function Gs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Ve(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Ua(t)}function lD(e,t,r,n){var a=Ts(e),s=a.getUint32(4,!0),i=(n>1?12:8)+_g(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=_g(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function cD(e,t,r){var n=Ts(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(l=sD(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function tf(e,t){var r=new Uint8Array(32),n=Ts(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,iD(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function rf(e,t){var r=new Uint8Array(32),n=Ts(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function uD(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return lD(e,t,r,e[0]);case 5:return cD(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Zt(e){var t=We(e);return wl(t[1][0].data)}function kg(e,t){var r=We(t.data),n=gt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=We(i.data),l=gt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Sd(o[3][0].data);break;case 8:{var u=e[Zt(o[9][0].data)][0],f=We(u.data),d=e[Zt(f[1][0].data)][0],h=gt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=We(d.data);s[l]=x[3].map(function(g){return Sd(g.data)}).join("")}break}}),s}function fD(e,t){var r,n,a,s,i,o,l,u,f,d,h,x,g,m,p=We(e),y=gt(p[1][0].data)>>>0,w=gt(p[2][0].data)>>>0,v=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&gt(p[8][0].data)>0||!1,_,k;if((s=(a=p[7])==null?void 0:a[0])!=null&&s.data&&t!=0)_=(o=(i=p[7])==null?void 0:i[0])==null?void 0:o.data,k=(u=(l=p[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(f=p[4])==null?void 0:f[0])!=null&&d.data&&t!=1)_=(x=(h=p[4])==null?void 0:h[0])==null?void 0:x.data,k=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=v?4:1,S=Ts(_),C=[],A=0;A<_.length/2;++A){var U=S.getUint16(A*2,!0);U<65535&&C.push([A,U])}if(C.length!=w)throw"Expected ".concat(w," cells, found ").concat(C.length);var H=[];for(A=0;A<C.length-1;++A)H[C[A][0]]=k.subarray(C[A][1]*E,C[A+1][1]*E);return C.length>=1&&(H[C[C.length-1][0]]=k.subarray(C[C.length-1][1]*E)),{R:y,cells:H}}function dD(e,t){var r,n=We(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?gt(n[7][0].data)>>>0>0?1:0:-1,s=xp(n[5],function(i){return fD(i,a)});return{nrows:gt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function hD(e,t,r){var n,a=We(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(gt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(gt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Pe(s);var i=We(a[4][0].data),o=kg(e,e[Zt(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?kg(e,e[Zt(i[17][0].data)][0]):[],u=We(i[3][0].data),f=0;u[1].forEach(function(d){var h=We(d.data),x=e[Zt(h[2][0].data)][0],g=gt(x.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=dD(e,x);m.data.forEach(function(p,y){p.forEach(function(w,v){var _=Ce({r:f+y,c:v}),k=uD(w,o,l);k&&(r[_]=k)})}),f+=m.nrows})}function pD(e,t){var r=We(t.data),n={"!ref":"A1"},a=e[Zt(r[2][0].data)],s=gt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return hD(e,a[0],n),n}function mD(e,t){var r,n=We(t.data),a={name:(r=n[1])!=null&&r[0]?Sd(n[1][0].data):"",sheets:[]},s=xp(n[2],Zt);return s.forEach(function(i){e[i].forEach(function(o){var l=gt(o.meta[1][0].data);l==6e3&&a.sheets.push(pD(e,o))})}),a}function xD(e,t){var r=_p(),n=We(t.data),a=xp(n[1],Zt);if(a.forEach(function(s){e[s].forEach(function(i){var o=gt(i.meta[1][0].data);if(o==2){var l=mD(e,i);l.sheets.forEach(function(u,f){kp(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function nf(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Kr(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=Gr(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&gt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(u){var f=gt(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return xD(s,o)}function gD(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&gt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Ts(e[7][0].data),f=0,d=[],h=Ts(e[4][0].data),x=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),h.setUint16(m*2,x,!0);var p,y;switch(typeof t[m]){case"string":p=tf({t:"s",v:t[m]},r),y=rf({t:"s",v:t[m]},r);break;case"number":p=tf({t:"n",v:t[m]},r),y=rf({t:"n",v:t[m]},r);break;case"boolean":p=tf({t:"b",v:t[m]},r),y=rf({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),f+=p.length,g.push(y),x+=y.length,++l}for(e[2][0].data=Ve(l);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Ua(d),e[3][0].data=Ua(g),l}function vD(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Er(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Pe(n)));var s=bu(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(O){typeof O=="string"&&i.push(O)})});var o={},l=[],u=Ee.read(t.numbers,{type:"base64"});u.FileIndex.map(function(z,O){return[z,u.FullPaths[O]]}).forEach(function(z){var O=z[0],P=z[1];if(O.type==2&&O.name.match(/\.iwa/)){var K=O.content,re=Kr(K),oe=Gr(re);oe.forEach(function(le){l.push(le.id),o[le.id]={deps:[],location:P,type:gt(le.messages[0].meta[1][0].data)}})}}),l.sort(function(z,O){return z-O});var f=l.filter(function(z){return z>1}).map(function(z){return[z,Ve(z)]});u.FileIndex.map(function(z,O){return[z,u.FullPaths[O]]}).forEach(function(z){var O=z[0];if(z[1],!!O.name.match(/\.iwa/)){var P=Gr(Kr(O.content));P.forEach(function(K){K.messages.forEach(function(re){f.forEach(function(oe){K.messages.some(function(le){return gt(le.meta[1][0].data)!=11006&&aD(le.data,oe[1])})&&o[oe[0]].deps.push(K.id)})})})}});for(var d=Ee.find(u,o[1].location),h=Gr(Kr(d.content)),x,g=0;g<h.length;++g){var m=h[g];m.id==1&&(x=m)}var p=Zt(We(x.messages[0].data)[1][0].data);for(d=Ee.find(u,o[p].location),h=Gr(Kr(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(x=m);for(p=Zt(We(x.messages[0].data)[2][0].data),d=Ee.find(u,o[p].location),h=Gr(Kr(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(x=m);for(p=Zt(We(x.messages[0].data)[2][0].data),d=Ee.find(u,o[p].location),h=Gr(Kr(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(x=m);var y=We(x.messages[0].data);{y[6][0].data=Ve(n.e.r+1),y[7][0].data=Ve(n.e.c+1);var w=Zt(y[46][0].data),v=Ee.find(u,o[w].location),_=Gr(Kr(v.content));{for(var k=0;k<_.length&&_[k].id!=w;++k);if(_[k].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=We(_[k].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var S=0;S<=n.e.c;++S){var C=[];C[1]=C[2]=[{type:0,data:Ve(S+420690)}],E[1].push({type:2,data:Wt(C)}),E[2].push({type:0,data:Ve(S)}),E[3].push({type:0,data:Ve(S)})}E[4]=[],E[5]=[],E[6]=[];for(var A=0;A<=n.e.r;++A)C=[],C[1]=C[2]=[{type:0,data:Ve(A+726270)}],E[4].push({type:2,data:Wt(C)}),E[5].push({type:0,data:Ve(A)}),E[6].push({type:0,data:Ve(A)});_[k].messages[0].data=Wt(E)}v.content=Gs(Vs(_)),v.size=v.content.length,delete y[46];var U=We(y[4][0].data);{U[7][0].data=Ve(n.e.r+1);var H=We(U[1][0].data),b=Zt(H[2][0].data);v=Ee.find(u,o[b].location),_=Gr(Kr(v.content));{if(_[0].id!=b)throw"Bad HeaderStorageBucket";var V=We(_[0].messages[0].data);for(A=0;A<s.length;++A){var J=We(V[2][0].data);J[1][0].data=Ve(A),J[4][0].data=Ve(s[A].length),V[2][A]={type:V[2][0].type,data:Wt(J)}}_[0].messages[0].data=Wt(V)}v.content=Gs(Vs(_)),v.size=v.content.length;var W=Zt(U[2][0].data);v=Ee.find(u,o[W].location),_=Gr(Kr(v.content));{if(_[0].id!=W)throw"Bad HeaderStorageBucket";for(V=We(_[0].messages[0].data),S=0;S<=n.e.c;++S)J=We(V[2][0].data),J[1][0].data=Ve(S),J[4][0].data=Ve(n.e.r+1),V[2][S]={type:V[2][0].type,data:Wt(J)};_[0].messages[0].data=Wt(V)}v.content=Gs(Vs(_)),v.size=v.content.length;var Z=Zt(U[4][0].data);(function(){for(var z=Ee.find(u,o[Z].location),O=Gr(Kr(z.content)),P,K=0;K<O.length;++K){var re=O[K];re.id==Z&&(P=re)}var oe=We(P.messages[0].data);{oe[3]=[];var le=[];i.forEach(function(I,je){le[1]=[{type:0,data:Ve(je)}],le[2]=[{type:0,data:Ve(1)}],le[3]=[{type:2,data:nD(I)}],oe[3].push({type:2,data:Wt(le)})})}P.messages[0].data=Wt(oe);var ie=Vs(O),ce=Gs(ie);z.content=ce,z.size=z.content.length})();var ee=We(U[3][0].data);{var G=ee[1][0];delete ee[2];var B=We(G.data);{var ae=Zt(B[2][0].data);(function(){for(var z=Ee.find(u,o[ae].location),O=Gr(Kr(z.content)),P,K=0;K<O.length;++K){var re=O[K];re.id==ae&&(P=re)}var oe=We(P.messages[0].data);{delete oe[6],delete ee[7];var le=new Uint8Array(oe[5][0].data);oe[5]=[];for(var ie=0,ce=0;ce<=n.e.r;++ce){var I=We(le);ie+=gD(I,s[ce],i),I[1][0].data=Ve(ce),oe[5].push({data:Wt(I),type:2})}oe[1]=[{type:0,data:Ve(n.e.c+1)}],oe[2]=[{type:0,data:Ve(n.e.r+1)}],oe[3]=[{type:0,data:Ve(ie)}],oe[4]=[{type:0,data:Ve(n.e.r+1)}]}P.messages[0].data=Wt(oe);var je=Vs(O),Re=Gs(je);z.content=Re,z.size=z.content.length})()}G.data=Wt(B)}U[3][0].data=Wt(ee)}y[4][0].data=Wt(U)}x.messages[0].data=Wt(y);var de=Vs(h),R=Gs(de);return d.content=R,d.size=d.content.length,u}function F2(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function gp(e){F2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function vp(e){F2([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function yD(e){return Me.WS.indexOf(e)>-1?"sheet":e==Me.CS?"chart":e==Me.DS?"dialog":e==Me.MS?"macro":e&&e.length?e:"sheet"}function wD(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,yD(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function _D(e,t,r,n,a,s,i,o,l,u,f,d){try{s[n]=Ro(Pr(e,r,!0),t);var h=bt(e,t),x;switch(o){case"sheet":x=WP(h,t,a,l,s[n],u,f,d);break;case"chart":if(x=HP(h,t,a,l,s[n],u,f,d),!x||!x["!drawel"])break;var g=go(x["!drawel"].Target,t),m=pl(g),p=jF(Pr(e,g,!0),Ro(Pr(e,m,!0),g)),y=go(p,g),w=pl(y);x=gP(Pr(e,y,!0),y,l,Ro(Pr(e,w,!0),y),u,x);break;case"macro":x=VP(h,t,a,l,s[n],u,f,d);break;case"dialog":x=GP(h,t,a,l,s[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=x;var v=[];s&&s[n]&&vt(s[n]).forEach(function(_){var k="";if(s[n][_].Type==Me.CMNT){k=go(s[n][_].Target,t);var E=YP(bt(e,k,!0),k,l);if(!E||!E.length)return;og(x,E,!1)}s[n][_].Type==Me.TCMNT&&(k=go(s[n][_].Target,t),v=v.concat(RF(bt(e,k,!0),l)))}),v&&v.length&&og(x,v,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function Hr(e){return e.charAt(0)=="/"?e.slice(1):e}function kD(e,t){if(zi(),t=t||{},gp(t),Xr(e,"META-INF/manifest.xml")||Xr(e,"objectdata.xml"))return vg(e,t);if(Xr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nf<"u"){if(e.FileIndex)return nf(e);var r=Ee.utils.cfb_new();return Cx(e).forEach(function(J){Ie(r,J,OC(e,J))}),nf(r)}throw new Error("Unsupported NUMBERS file")}if(!Xr(e,"[Content_Types].xml"))throw Xr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Cx(e),a=TA(Pr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",bt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!bt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Oo=[],a.sst)try{Oo=qP(bt(e,Hr(a.sst)),a.sst,t)}catch(J){if(t.WTF)throw J}t.cellStyles&&a.themes.length&&(l=XP(Pr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=KP(bt(e,Hr(a.style)),a.style,l,t))}a.links.map(function(J){try{var W=Ro(Pr(e,pl(Hr(J))),J);return QP(bt(e,Hr(J)),W,J,t)}catch{}});var f=zP(bt(e,Hr(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=bt(e,Hr(a.coreprops[0]),!0),h&&(d=yw(h)),a.extprops.length!==0&&(h=bt(e,Hr(a.extprops[0]),!0),h&&OA(h,d,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Pr(e,Hr(a.custprops[0]),!0),h&&(x=IA(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(W){return W.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=x),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var m={};t.bookDeps&&a.calcchain&&(m=JP(bt(e,Hr(a.calcchain)),a.calcchain));var p=0,y={},w,v;{var _=f.Sheets;d.Worksheets=_.length,d.SheetNames=[];for(var k=0;k!=_.length;++k)d.SheetNames[k]=_[k].name}var E=s?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Xr(e,C)||(C="xl/_rels/workbook."+E+".rels");var A=Ro(Pr(e,C,!0),C.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=ZP(bt(e,Hr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=PF(bt(e,Hr(a.people[0])),t)),A&&(A=wD(A,f.Sheets));var U=bt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=d.Worksheets;++p){var H="sheet";if(A&&A[p]?(w="xl/"+A[p][1].replace(/[\/]?xl\//,""),Xr(e,w)||(w=A[p][1]),Xr(e,w)||(w=C.replace(/_rels\/.*$/,"")+A[p][1]),H=A[p][2]):(w="xl/worksheets/sheet"+(p+1-U)+"."+E,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(p!=t.sheets)continue e;break;case"string":if(d.SheetNames[p].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==p&&(b=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==d.SheetNames[p].toLowerCase()&&(b=1);if(!b)continue e}}_D(e,w,v,d.SheetNames[p],p,y,i,H,t,f,l,u)}return g={Directory:a,Workbook:f,Props:d,Custprops:x,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:Oo,Styles:u,Themes:l,SSF:rt(be)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(J,W){J=J.replace(/^Root Entry[\/]/,""),g.keys.push(J),g.files[J]=e.FileIndex[W]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=bt(e,Hr(a.vba[0]),!0):a.defaults&&a.defaults.bin===zF&&(g.vbaraw=bt(e,"xl/vbaProject.bin",!0))),g}function SD(e,t){var r=t||{},n="Workbook",a=Ee.find(e,n);try{if(n="/!DataSpaces/Version",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Z6(a.content),n="/!DataSpaces/DataSpaceMap",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=t5(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=r5(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);a5(a.content)}catch{}if(n="/EncryptionInfo",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=s5(a.content);if(n="/EncryptedPackage",a=Ee.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function ED(e,t){return t.bookType=="ods"?j2(e,t):t.bookType=="numbers"?vD(e,t):t.bookType=="xlsb"?bD(e,t):TD(e,t)}function bD(e,t){ui=1024,e&&!e.SSF&&(e.SSF=rt(be)),e&&e.SSF&&(zi(),Rl(e.SSF),t.revssf=Zu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Po?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=a2.indexOf(t.bookType)>-1,a=np();vp(t=t||{});var s=Wh(),i="",o=0;if(t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ie(s,i,ww(e.Props,t)),a.coreprops.push(i),Ge(t.rels,2,i,Me.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,i,Sw(e.Props)),a.extprops.push(i),Ge(t.rels,3,i,Me.EXT_PROPS),e.Custprops!==e.Props&&vt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ie(s,i,Ew(e.Custprops)),a.custprops.push(i),Ge(t.rels,4,i,Me.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ie(s,i,tI(o-1,i,t,e,f)),a.sheets.push(i),Ge(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Me.WS[0])}if(d){var x=d["!comments"],g=!1,m="";x&&x.length>0&&(m="xl/comments"+o+"."+r,Ie(s,m,aI(x,m)),a.comments.push(m),Ge(f,-1,"../comments"+o+"."+r,Me.CMNT),g=!0),d["!legacy"]&&g&&Ie(s,"xl/drawings/vmlDrawing"+o+".vml",r2(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ie(s,pl(i),yi(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ie(s,i,nI(t.Strings,i,t)),a.strs.push(i),Ge(t.wbrels,-1,"sharedStrings."+r,Me.SST)),i="xl/workbook."+r,Ie(s,i,eI(e,i)),a.workbooks.push(i),Ge(t.rels,1,i,Me.WB),i="xl/theme/theme1.xml",Ie(s,i,cp(e.Themes,t)),a.themes.push(i),Ge(t.wbrels,-1,"theme/theme1.xml",Me.THEME),i="xl/styles."+r,Ie(s,i,rI(e,i,t)),a.styles.push(i),Ge(t.wbrels,-1,"styles."+r,Me.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ie(s,i,e.vbaraw),a.vba.push(i),Ge(t.wbrels,-1,"vbaProject.bin",Me.VBA)),i="xl/metadata."+r,Ie(s,i,sI(i)),a.metadata.push(i),Ge(t.wbrels,-1,"metadata."+r,Me.XLMETA),Ie(s,"[Content_Types].xml",gw(a,t)),Ie(s,"_rels/.rels",yi(t.rels)),Ie(s,"xl/_rels/workbook."+r+".rels",yi(t.wbrels)),delete t.revssf,delete t.ssf,s}function TD(e,t){ui=1024,e&&!e.SSF&&(e.SSF=rt(be)),e&&e.SSF&&(zi(),Rl(e.SSF),t.revssf=Zu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Po?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=a2.indexOf(t.bookType)>-1,a=np();vp(t=t||{});var s=Wh(),i="",o=0;if(t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ie(s,i,ww(e.Props,t)),a.coreprops.push(i),Ge(t.rels,2,i,Me.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,i,Sw(e.Props)),a.extprops.push(i),Ge(t.rels,3,i,Me.EXT_PROPS),e.Custprops!==e.Props&&vt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ie(s,i,Ew(e.Custprops)),a.custprops.push(i),Ge(t.rels,4,i,Me.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],x=(h||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ie(s,i,m2(o-1,t,e,d)),a.sheets.push(i),Ge(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Me.WS[0])}if(h){var g=h["!comments"],m=!1,p="";if(g&&g.length>0){var y=!1;g.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(p="xl/threadedComments/threadedComment"+o+"."+r,Ie(s,p,OF(g,f,t)),a.threadedcomments.push(p),Ge(d,-1,"../threadedComments/threadedComment"+o+"."+r,Me.TCMNT)),p="xl/comments"+o+"."+r,Ie(s,p,n2(g)),a.comments.push(p),Ge(d,-1,"../comments"+o+"."+r,Me.CMNT),m=!0}h["!legacy"]&&m&&Ie(s,"xl/drawings/vmlDrawing"+o+".vml",r2(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ie(s,pl(i),yi(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ie(s,i,Hw(t.Strings,t)),a.strs.push(i),Ge(t.wbrels,-1,"sharedStrings."+r,Me.SST)),i="xl/workbook."+r,Ie(s,i,w2(e)),a.workbooks.push(i),Ge(t.rels,1,i,Me.WB),i="xl/theme/theme1.xml",Ie(s,i,cp(e.Themes,t)),a.themes.push(i),Ge(t.wbrels,-1,"theme/theme1.xml",Me.THEME),i="xl/styles."+r,Ie(s,i,Qw(e,t)),a.styles.push(i),Ge(t.wbrels,-1,"styles."+r,Me.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ie(s,i,e.vbaraw),a.vba.push(i),Ge(t.wbrels,-1,"vbaProject.bin",Me.VBA)),i="xl/metadata."+r,Ie(s,i,t2()),a.metadata.push(i),Ge(t.wbrels,-1,"metadata."+r,Me.XLMETA),f.length>1&&(i="xl/persons/person.xml",Ie(s,i,IF(f)),a.people.push(i),Ge(t.wbrels,-1,"persons/person.xml",Me.PEOPLE)),Ie(s,"[Content_Types].xml",gw(a,t)),Ie(s,"_rels/.rels",yi(t.rels)),Ie(s,"xl/_rels/workbook."+r+".rels",yi(t.wbrels)),delete t.revssf,delete t.ssf,s}function yp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Mr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ND(e,t){return Ee.find(e,"EncryptedPackage")?SD(e,t):E2(e,t)}function CD(e,t){var r,n=e,a=t||{};return a.type||(a.type=De&&Buffer.isBuffer(e)?"buffer":"base64"),r=Gy(n,a),kD(r,a)}function R2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _d(e.slice(r),t);default:break e}return Ri.to_workbook(e,t)}function AD(e,t){var r="",n=yp(e,t);switch(t.type){case"base64":r=Mr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ks(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=qe(r)),t.type="binary",R2(r,t)}function jD(e,t){var r=e;return t.type=="base64"&&(r=Mr(r)),r=ll.utils.decode(1200,r.slice(2),"str"),t.type="binary",R2(r,t)}function FD(e){return e.match(/[^\x00-\x7F]/)?An(e):e}function af(e,t,r,n){return n?(r.type="string",Ri.to_workbook(e,r)):Ri.to_workbook(t,r)}function Ed(e,t){Mh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ed(new Uint8Array(e),(r=rt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_i={},r.dateNF&&(_i.dateNF=r.dateNF),r.type||(r.type=De&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=De?"buffer":"binary",n=bC(e),typeof Uint8Array<"u"&&!De&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=FD(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=rt(r),r.type="array",Ed(Bh(n),r)}switch((a=yp(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return ND(Ee.read(n,r),r);break;case 9:if(a[1]<=8)return E2(n,r);break;case 60:return _d(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return D6(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return zw.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?CD(n,r):af(e,n,r,s);case 239:return a[3]===60?_d(n,r):af(e,n,r,s);case 255:if(a[1]===254)return jD(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ps.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ps.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return wd.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return qw.to_workbook(n,r);break;case 10:case 13:case 32:return AD(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return I6.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?wd.to_workbook(n,r):af(e,n,r,s)}function O2(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ol(t.file,Ee.write(e,{type:De?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ee.write(e,t)}function RD(e,t){var r=rt(t||{}),n=ED(e,r);return OD(n,r)}function OD(e,t){var r={},n=De?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ee.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Ju(a))}return t.password&&typeof encrypt_agile<"u"?O2(encrypt_agile(a,t.password),t):t.type==="file"?Ol(t.file,a):t.type=="string"?qe(a):a}function PD(e,t){var r=t||{},n=FI(e,r);return O2(n,r)}function Tn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return cl(An(n));case"binary":return An(n);case"string":return e;case"file":return Ol(t.file,n,"utf8");case"buffer":return De?la(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Tn(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ID(e,t){switch(t.type){case"base64":return cl(e);case"binary":return e;case"string":return e;case"file":return Ol(t.file,e,"binary");case"buffer":return De?la(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function kc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?cl(r):t.type=="string"?qe(r):r;case"file":return Ol(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function P2(e,t){Mh(),NP(e);var r=rt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=P2(e,r);return r.type="array",Ju(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Tn(EI(e,r),r);case"slk":case"sylk":return Tn($w.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Tn(T2(e.Sheets[e.SheetNames[a]],r),r);case"txt":return ID(D2(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Tn(wp(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Tn(zw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return kc(wd.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Tn(Ri.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Tn(qw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Tn(Ww.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Tn(j2(e,r),r);case"wk1":return kc(ps.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return kc(ps.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),kc(b2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),PD(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RD(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function DD(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function I2(e,t,r){var n={};return n.type="file",n.file=t,DD(n),P2(e,n)}function LD(e,t,r,n,a,s,i,o){var l=kt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var x=t.s.c;x<=t.e.c;++x){var g=i?e[r][x]:e[n[x]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[x]!=null&&(h[s[x]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[x]!=null){if(m==null)if(g.t=="e"&&m===null)h[s[x]]=null;else if(u!==void 0)h[s[x]]=u;else if(f&&m===null)h[s[x]]=null;else continue;else h[s[x]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:aa(g,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function bu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=ze(f);break;case"number":l=ze(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=kt(l.s.r),h=[],x=[],g=0,m=0,p=Array.isArray(e),y=l.s.r,w=0,v={};p&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(_[w]||{}).hidden)switch(h[w]=ut(w),r=p?e[y][w]:e[h[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=aa(r,null,u),m=v[i]||0,!m)v[i]=1;else{do o=i+"_"+m++;while(v[o]);v[i]=m,v[o]=1}s[w]=o}for(y=l.s.r+a;y<=l.e.r;++y)if(!(k[y]||{}).hidden){var E=LD(e,l,y,h,n,s,p,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[g++]=E.row)}return x.length=g,x}var Sg=/"/g;function MD(e,t,r,n,a,s,i,o){for(var l=!0,u=[],f="",d=kt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var x=o.dense?(e[r]||[])[h]:e[n[h]+d];if(x==null)f="";else if(x.v!=null){l=!1,f=""+(o.rawNumbers&&x.t=="n"?x.v:aa(x,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(Sg,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(l=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(Sg,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function wp(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ze(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(h[g]||{}).hidden||(d[g]=ut(g));for(var m=0,p=a.s.r;p<=a.e.r;++p)(x[p]||{}).hidden||(f=MD(e,a,p,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function D2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wp(e,t);return r}function BD(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ze(e["!ref"]),s="",i=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=ut(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=kt(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function L2(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=ze(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],x=0;t.forEach(function(m,p){vt(m).forEach(function(y){(x=h.indexOf(y))==-1&&(h[x=h.length]=y);var w=m[y],v="z",_="",k=Ce({c:o+x,r:i+p+a});u=_l(s,k),w&&typeof w=="object"&&!(w instanceof Date)?s[k]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=Pt(w)),_=n.dateNF||be[14]):w===null&&n.nullError&&(v="e",w=0),u?(u.t=v,u.v=w,delete u.w,delete u.R,_&&(u.z=_)):s[k]=u={t:v,v:w},_&&(u.z=_))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var g=kt(i);if(a)for(x=0;x<h.length;++x)s[ut(x+o)+g]={t:"s",v:h[x]};return s["!ref"]=Pe(f),s}function UD(e,t){return L2(null,e,t)}function _l(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ft(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_l(e,Ce(t)):_l(e,Ce({r:t,c:r||0}))}function $D(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _p(){return{SheetNames:[],Sheets:{}}}function kp(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(y2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=$D(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function WD(e,t){return e.z=t,e}function M2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function HD(e,t,r){return M2(e,"#"+t,r)}function VD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GD(e,t,r,n){for(var a=typeof t!="string"?t:ze(t),s=typeof t=="string"?t:Pe(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=_l(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var cs={encode_col:ut,encode_row:kt,encode_cell:Ce,encode_range:Pe,decode_col:Jh,decode_row:Yh,split_cell:nA,decode_cell:ft,decode_range:Er,format_cell:aa,sheet_add_aoa:uw,sheet_add_json:L2,sheet_add_dom:N2,aoa_to_sheet:Wi,json_to_sheet:UD,table_to_sheet:C2,table_to_book:ZI,sheet_to_csv:wp,sheet_to_txt:D2,sheet_to_json:bu,sheet_to_html:T2,sheet_to_formulae:BD,sheet_to_row_object_array:bu,sheet_get_cell:_l,book_new:_p,book_append_sheet:kp,book_set_sheet_visibility:zD,cell_set_number_format:WD,cell_set_hyperlink:M2,cell_set_internal_link:HD,cell_add_comment:VD,sheet_set_array_formula:GD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function KD({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=N.useState(null),[s,i]=N.useState([]),[o,l]=N.useState(!1),[u,f]=N.useState(null),[d,h]=N.useState(!1),x=N.useRef(null);if(!e)return null;const g=v=>{const _=v.target.files[0];if(_){const k=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],S=[".xlsx",".xls",".csv"].some(C=>_.name.toLowerCase().endsWith(C));if(!k.includes(_.type)&&!S){f("Por favor, sube un archivo Excel (.xlsx, .xls) o CSV vlido.");return}a(_),f(null),p(_)}},m=v=>{if(!v)return null;try{if(v instanceof Date)return v.toISOString();if(typeof v=="string"){const _=v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(_){const[,C,A,U]=_;return new Date(`${U}-${String(A).padStart(2,"0")}-${String(C).padStart(2,"0")}T00:00:00Z`).toISOString()}const k=v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(k){const[,C,A,U]=k;return parseInt(C)>12?new Date(`${U}-${String(A).padStart(2,"0")}-${String(C).padStart(2,"0")}T00:00:00Z`).toISOString():new Date(`${U}-${String(C).padStart(2,"0")}-${String(A).padStart(2,"0")}T00:00:00Z`).toISOString()}const E=v.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(E){const[,C,A,U]=E;return new Date(`${C}-${String(A).padStart(2,"0")}-${String(U).padStart(2,"0")}T00:00:00Z`).toISOString()}const S=new Date(v);if(!isNaN(S.getTime()))return S.toISOString()}if(typeof v=="number"){const _=Uy.parse_date_code(v);return new Date(`${_.y}-${String(_.m).padStart(2,"0")}-${String(_.d).padStart(2,"0")}T00:00:00Z`).toISOString()}return null}catch(_){return console.error("Error parsing timestamp:",v,_),null}},p=v=>{const _=new FileReader;_.onload=k=>{try{const E=new Uint8Array(k.target.result),S=Ed(E,{type:"array",cellDates:!0}),C=S.SheetNames[0],A=S.Sheets[C],U=cs.sheet_to_json(A,{raw:!1,dateNF:"yyyy-mm-dd"});if(U.length===0){f("El archivo est vaco o no tiene datos vlidos.");return}const H=U.map(b=>{const V=b.Nombres||"",J=b.Apellidos||"",W=`${V} ${J}`.trim();let Z=null;const ee=b["Da del nacimiento"],G=b["Mes del nacimiento"],B=b["Ao de nacimiento."];if(ee&&G&&B)try{Z=`${B}-${String(G).padStart(2,"0")}-${String(ee).padStart(2,"0")}`}catch(z){console.warn("Error building birth date:",z)}let ae=null;const de=b["Gnero. 1 = Femenino, 2 = Masculino"];de===1||de==="1"?ae="Femenino":(de===2||de==="2")&&(ae="Masculino");const R=m(b["Fecha de creacin."])||new Date().toISOString();return{full_name:W||b.Email||"Sin nombre",email:b.Email||null,phone:b.Telfono||null,secondary_phone:b["Telfono secundario del cliente"]||null,dni:b["DNI o RFC"]||null,client_number:b["Nmero de cliente"]||null,address:b.Direccin||null,comuna:b.comuna||null,city:b.Ciudad||null,age:b.Edad||null,gender:ae,birth_date:Z,status:"new",source:"import",created_at:R}}).filter(b=>b.full_name||b.email||b.phone);i(H)}catch(E){console.error("Error parsing file:",E),f("Error al leer el archivo. Asegrate de que sea un archivo Excel o CSV vlido.")}},_.readAsArrayBuffer(v)},y=async()=>{if(s.length===0){f("No hay datos vlidos para importar.");return}try{l(!0),f(null);const v=50;for(let _=0;_<s.length;_+=v){const k=s.slice(_,_+v),{error:E}=await xe.from("leads").insert(k);if(E)throw E}h(!0),setTimeout(()=>{r(),t(),a(null),i([]),h(!1)},2e3)}catch(v){console.error("Error importing leads:",v),f("Error al importar los datos: "+v.message)}finally{l(!1)}},w=()=>{const v=[{Email:"ejemplo@email.com",Nombres:"Juan",Apellidos:"Prez","DNI o RFC":"12345678","Nmero de cliente":"001",Telfono:"+5491123456789","Telfono secundario del cliente":"+5491198765432",Direccin:"Calle Ejemplo 123",comuna:"Comuna 1",Ciudad:"Buenos Aires",Edad:30,"Gnero. 1 = Femenino, 2 = Masculino":2,"Da del nacimiento":15,"Mes del nacimiento":6,"Ao de nacimiento.":1993,"Fecha de creacin.":"2024-01-01"}],_=cs.json_to_sheet(v),k=cs.book_new();cs.book_append_sheet(k,_,"Leads"),I2(k,"plantilla_importacion_leads.xlsx")};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[c.jsx(As,{className:"w-6 h-6 text-teal-600"}),"Importar Leads desde Excel"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:c.jsx(Ut,{size:24})})]}),c.jsx("div",{className:"p-6 space-y-6",children:n?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Hm,{className:"w-8 h-8 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:n.name}),c.jsxs("p",{className:"text-xs text-gray-500",children:[(n.size/1024).toFixed(2)," KB"]})]})]}),c.jsx("button",{onClick:()=>{a(null),i([])},className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"Cambiar archivo"})]}),s.length>0&&c.jsxs("div",{children:[c.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["Vista previa (",s.length," registros)"]}),c.jsxs("div",{className:"border rounded-lg overflow-hidden overflow-x-auto",children:[c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-gray-50 text-gray-500",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2",children:"Nombre"}),c.jsx("th",{className:"px-4 py-2",children:"Email"}),c.jsx("th",{className:"px-4 py-2",children:"Telfono"}),c.jsx("th",{className:"px-4 py-2",children:"Ciudad"}),c.jsx("th",{className:"px-4 py-2",children:"Edad"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:s.slice(0,5).map((v,_)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2",children:v.full_name||"-"}),c.jsx("td",{className:"px-4 py-2",children:v.email||"-"}),c.jsx("td",{className:"px-4 py-2",children:v.phone||"-"}),c.jsx("td",{className:"px-4 py-2",children:v.city||"-"}),c.jsx("td",{className:"px-4 py-2",children:v.age||"-"})]},_))})]}),s.length>5&&c.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-xs text-gray-500 text-center border-t",children:["... y ",s.length-5," ms"]})]})]}),u&&c.jsxs("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm flex items-center gap-2",children:[c.jsx(Da,{size:16}),u]}),d&&c.jsxs("div",{className:"bg-green-50 text-green-600 p-3 rounded-lg text-sm flex items-center gap-2",children:[c.jsx(Nh,{size:16}),"Importacin completada con xito!"]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{onClick:()=>{var v;return(v=x.current)==null?void 0:v.click()},className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-teal-500 hover:bg-teal-50 transition-colors cursor-pointer",children:[c.jsx(Hm,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Haz clic para subir tu archivo Excel o CSV"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"o arrastra y suelta el archivo aqu"}),c.jsx("input",{type:"file",ref:x,onChange:g,accept:".xlsx,.xls,.csv",className:"hidden"})]}),c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg flex items-start gap-3",children:[c.jsx(Da,{className:"w-5 h-5 text-blue-600 mt-0.5"}),c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("p",{className:"font-medium mb-1",children:"Instrucciones:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsxs("li",{children:["El archivo debe estar en formato ",c.jsx("strong",{children:".xlsx"}),", ",c.jsx("strong",{children:".xls"})," o ",c.jsx("strong",{children:".csv"})]}),c.jsx("li",{children:"Columnas esperadas: Email, Nombres, Apellidos, DNI o RFC, Telfono, Ciudad, Edad, Gnero, etc."}),c.jsx("li",{children:"Descarga la plantilla para ver el formato exacto"})]}),c.jsxs("button",{onClick:w,className:"mt-3 flex items-center gap-1 text-blue-700 font-medium hover:underline",children:[c.jsx(ts,{size:14})," Descargar plantilla de ejemplo"]})]})]})]})}),c.jsxs("div",{className:"p-6 border-t border-gray-100 flex justify-end gap-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",disabled:o,children:"Cancelar"}),n&&c.jsx("button",{onClick:y,disabled:o||d,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Importando...":d?"Completado":"Importar Datos"})]})]})})}function XD(){const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,s]=N.useState(""),[i,o]=N.useState("all"),[l,u]=N.useState(!1),[f,d]=N.useState(1),h=10;N.useEffect(()=>{x()},[]),N.useEffect(()=>{d(1)},[a,i]);async function x(){try{n(!0);const{data:E,error:S}=await xe.from("leads").select("*").order("created_at",{ascending:!1});if(S)throw S;t(E||[])}catch(E){console.error("Error fetching leads:",E)}finally{n(!1)}}const g=e.filter(E=>{var A,U,H;const S=(((A=E.name)==null?void 0:A.toLowerCase())||"").includes(a.toLowerCase())||(((U=E.email)==null?void 0:U.toLowerCase())||"").includes(a.toLowerCase())||(((H=E.phone)==null?void 0:H.toLowerCase())||"").includes(a.toLowerCase()),C=i==="all"||E.status===i;return S&&C}),m=g.reduce((E,S)=>E+(Number(S.value)||0),0),p=Math.ceil(g.length/h),y=(f-1)*h,w=g.slice(y,y+h),v=E=>({new:"bg-blue-100 text-blue-800",contacted:"bg-yellow-100 text-yellow-800",scheduled:"bg-purple-100 text-purple-800",paid:"bg-green-100 text-green-800",lost:"bg-red-100 text-red-800",general_base:"bg-gray-100 text-gray-800",partners:"bg-teal-100 text-teal-800"})[E]||"bg-gray-100 text-gray-800",_=E=>({new:"Nuevo",contacted:"Contactado",scheduled:"Agendado",paid:"Pagado",lost:"Perdido",general_base:"Base General",partners:"Aliados/Proveedores"})[E]||E,k=()=>{try{const E=g.map(H=>{const b=(H.full_name||H.name||"").split(" "),V=b[0]||"",J=b.slice(1).join(" ")||"";let W="",Z="",ee="";if(H.birth_date){const B=new Date(H.birth_date);W=B.getDate(),Z=B.getMonth()+1,ee=B.getFullYear()}let G="";return H.gender==="Femenino"?G=1:H.gender==="Masculino"&&(G=2),{Email:H.email||"",Nombres:V,Apellidos:J,"DNI o RFC":H.dni||"","Nmero de cliente":H.client_number||"",Telfono:H.phone||"","Telfono secundario del cliente":H.secondary_phone||"",Direccin:H.address||"",comuna:H.comuna||"",Ciudad:H.city||"",Edad:H.age||"","Gnero. 1 = Femenino, 2 = Masculino":G,"Da del nacimiento":W,"Mes del nacimiento":Z,"Ao de nacimiento.":ee,"Fecha de creacin.":H.created_at?new Date(H.created_at).toISOString().split("T")[0]:""}}),S=cs.json_to_sheet(E),C=cs.book_new();cs.book_append_sheet(C,S,"Leads");const U=`leads_export_${new Date().toISOString().split("T")[0]}.xlsx`;I2(C,U)}catch(E){console.error("Error exporting leads:",E),alert("Error al exportar los datos. Por favor, intenta de nuevo.")}};return c.jsxs("div",{className:"p-6 max-w-7xl mx-auto overflow-y-auto max-h-[calc(100vh-100px)]",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[c.jsx(iy,{className:"w-8 h-8 text-teal-600"}),"Base de Datos"]}),c.jsx("p",{className:"text-gray-500 mt-1",children:"Gestin completa de todos los contactos y leads"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[c.jsx(As,{size:20}),"Importar Excel"]}),c.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-white border rounded-lg text-gray-600 hover:bg-gray-50 transition-colors",children:[c.jsx(ts,{size:20}),"Exportar Excel"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Registros"}),c.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:g.length})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Estimado Total"}),c.jsxs("p",{className:"text-3xl font-bold text-teal-600 mt-2",children:["$",m.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Nuevos Leads"}),c.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:g.filter(E=>E.status==="new").length})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Mostrando ",y+1," a ",Math.min(y+h,g.length)," de ",g.length," registros"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>d(E=>Math.max(1,E-1)),disabled:f===1,className:"px-3 py-1 border rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Anterior"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Pgina ",f," de ",p||1]}),c.jsx("button",{onClick:()=>d(E=>Math.min(p,E+1)),disabled:f===p||p===0,className:"px-3 py-1 border rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Siguiente"})]})]}),c.jsxs("div",{className:"p-4 border-b border-gray-200 flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Vu,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),c.jsx("input",{type:"text",placeholder:"Buscar por nombre, email o telfono...",value:a,onChange:E=>s(E.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Gb,{className:"text-gray-400 w-5 h-5"}),c.jsxs("select",{value:i,onChange:E=>o(E.target.value),className:"border rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"Todos los estados"}),c.jsx("option",{value:"new",children:"Nuevo"}),c.jsx("option",{value:"contacted",children:"Contactado"}),c.jsx("option",{value:"scheduled",children:"Agendado"}),c.jsx("option",{value:"paid",children:"Pagado"}),c.jsx("option",{value:"lost",children:"Perdido"}),c.jsx("option",{value:"general_base",children:"Base General"}),c.jsx("option",{value:"partners",children:"Aliados/Proveedores"})]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left",children:[c.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Nombre"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Contacto"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Servicio"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Origen"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Valor"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Estado"}),c.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Fecha"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:r?c.jsx("tr",{children:c.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"Cargando datos..."})}):g.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron registros"})}):w.map(E=>c.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"font-medium text-gray-900",children:E.full_name||E.name})}),c.jsxs("td",{className:"px-6 py-4",children:[c.jsx("div",{className:"text-sm text-gray-900",children:E.email}),c.jsx("div",{className:"text-sm text-gray-500",children:E.phone})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"text-sm text-gray-900",children:E.service||E.service_interest||"-"})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"text-sm text-gray-500",children:E.source||"-"})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",(Number(E.value)||0).toLocaleString("es-MX")]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v(E.status)}`,children:_(E.status)})}),c.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(E.created_at).toLocaleDateString()})]},E.id))})]})})]}),c.jsx(KD,{isOpen:l,onClose:()=>u(!1),onSuccess:x})]})}const Eg=[{key:"monday",label:"Lunes"},{key:"tuesday",label:"Martes"},{key:"wednesday",label:"Mircoles"},{key:"thursday",label:"Jueves"},{key:"friday",label:"Viernes"},{key:"saturday",label:"Sbado"},{key:"sunday",label:"Domingo"}],qD=["Sesin individual presencial","Sesin individual en lnea","Sesin pareja presencial","Sesin pareja en lnea","Sesin familiar presencial","Sesin familiar en lnea","Sesin a domicilio","Taller","Conferencia","Curso"],bg=Array.from({length:29},(e,t)=>{const r=Math.floor(t/2)+7,n=t%2===0?"00":"30";return`${r.toString().padStart(2,"0")}:${n}`});function YD({isOpen:e,onClose:t,therapist:r,onSave:n,onDelete:a}){const[s,i]=N.useState("general"),[o,l]=N.useState({name:"",email:"",phone:"",specialty:"",role:"therapist",photo_url:"",schedule:{},services:[],commissions:{}}),[u,f]=N.useState(!1);N.useEffect(()=>{if(r)l({name:r.name||"",email:r.email||"",phone:r.phone||"",specialty:r.specialty||"",role:r.role||"therapist",photo_url:r.photo_url||"",schedule:r.schedule||{},services:Array.isArray(r.services)?r.services:[],commissions:r.commissions||{}});else{const p={};Eg.forEach(y=>{p[y.key]={active:!0,start:"09:00",end:"18:00"}}),l({name:"",email:"",phone:"",role:"therapist",photo_url:"",schedule:p,services:[],commissions:{}})}},[r,e]);const d=async p=>{try{f(!0);const y=p.target.files[0];if(!y)return;const w=y.name.split(".").pop(),_=`${`${Math.random()}.${w}`}`,{error:k}=await xe.storage.from("therapist-photos").upload(_,y);if(k)throw k;const{data:E}=xe.storage.from("therapist-photos").getPublicUrl(_);l({...o,photo_url:E.publicUrl})}catch(y){console.error("Error uploading photo:",y),alert("Error al subir la foto")}finally{f(!1)}},h=(p,y,w)=>{l(v=>({...v,schedule:{...v.schedule,[p]:{...v.schedule[p],[y]:w}}}))},x=p=>{l(y=>{const w=y.services.includes(p)?y.services.filter(v=>v!==p):[...y.services,p];return{...y,services:w}})},g=(p,y)=>{l(w=>({...w,commissions:{...w.commissions,[p]:y}}))},m=p=>{p.preventDefault(),n(o)};return e?c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-800",children:r?"Editar Terapeuta":"Nuevo Terapeuta"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})})]}),c.jsxs("div",{className:"flex border-b bg-gray-50",children:[c.jsx("button",{onClick:()=>i("general"),className:`flex-1 py-3 px-4 text-sm font-medium ${s==="general"?"border-b-2 border-teal-500 text-teal-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx(na,{size:16})," Datos Bsicos"]})}),c.jsx("button",{onClick:()=>i("schedule"),className:`flex-1 py-3 px-4 text-sm font-medium ${s==="schedule"?"border-b-2 border-teal-500 text-teal-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx(tl,{size:16})," Horarios"]})}),c.jsx("button",{onClick:()=>i("services"),className:`flex-1 py-3 px-4 text-sm font-medium ${s==="services"?"border-b-2 border-teal-500 text-teal-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx(Gu,{size:16})," Servicios"]})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s==="general"&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex justify-center",children:c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-gray-100 border-4 border-white shadow-lg",children:o.photo_url?c.jsx("img",{src:o.photo_url,alt:"Profile",className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:c.jsx(na,{size:48})})}),c.jsxs("label",{className:"absolute bottom-0 right-0 bg-teal-500 text-white p-2 rounded-full cursor-pointer shadow-lg hover:bg-teal-600 transition-colors",children:[c.jsx(As,{size:16}),c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:d,disabled:u})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo"}),c.jsx("input",{type:"text",value:o.name,onChange:p=>l({...o,name:p.target.value}),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),c.jsx("input",{type:"email",value:o.email,onChange:p=>l({...o,email:p.target.value}),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),c.jsx("input",{type:"tel",value:o.phone,onChange:p=>l({...o,phone:p.target.value}),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puesto (ej. Tanatlogo/a)"}),c.jsx("input",{type:"text",value:o.specialty,onChange:p=>l({...o,specialty:p.target.value}),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol de Acceso"}),c.jsxs("select",{value:o.role,onChange:p=>l({...o,role:p.target.value}),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-teal-500 outline-none",children:[c.jsx("option",{value:"admin",children:"Administrador (Acceso Total)"}),c.jsx("option",{value:"reception",children:"Recepcin (Sin Reportes/Gastos)"}),c.jsx("option",{value:"therapist",children:"Terapeuta (Solo Agenda)"})]})]})]})]}),s==="schedule"&&c.jsx("div",{className:"space-y-4",children:Eg.map(p=>{var y,w,v,_;return c.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"w-32 flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:((y=o.schedule[p.key])==null?void 0:y.active)||!1,onChange:k=>h(p.key,"active",k.target.checked),className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500"}),c.jsx("span",{className:"font-medium text-gray-700",children:p.label})]}),((w=o.schedule[p.key])==null?void 0:w.active)&&c.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[c.jsx("select",{value:((v=o.schedule[p.key])==null?void 0:v.start)||"09:00",onChange:k=>h(p.key,"start",k.target.value),className:"p-2 border rounded-md text-sm",children:bg.map(k=>c.jsx("option",{value:k,children:k},k))}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("select",{value:((_=o.schedule[p.key])==null?void 0:_.end)||"18:00",onChange:k=>h(p.key,"end",k.target.value),className:"p-2 border rounded-md text-sm",children:bg.map(k=>c.jsx("option",{value:k,children:k},k))})]})]},p.key)})}),s==="services"&&c.jsx("div",{className:"space-y-3",children:qD.map(p=>c.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer flex-1",children:[c.jsx("input",{type:"checkbox",checked:o.services.includes(p),onChange:()=>x(p),className:"w-5 h-5 text-teal-600 rounded focus:ring-teal-500"}),c.jsx("span",{className:"text-gray-700",children:p})]}),o.services.includes(p)&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Comisin: $"}),c.jsx("input",{type:"number",value:o.commissions[p]||"",onChange:y=>g(p,y.target.value),placeholder:"0.00",className:"w-24 p-1 border rounded text-right focus:ring-2 focus:ring-teal-500 outline-none"})]})]},p))})]}),c.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between items-center",children:[r&&a?c.jsxs("button",{onClick:()=>{window.confirm("Ests seguro de eliminar este terapeuta?")&&a(r.id)},className:"flex items-center gap-2 text-red-600 hover:text-red-700 px-4 py-2 rounded-lg hover:bg-red-50 transition-colors",children:[c.jsx($i,{size:18})," Eliminar"]}):c.jsx("div",{}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancelar"}),c.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-6 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors shadow-sm",children:[c.jsx(Ui,{size:18})," Guardar"]})]})]})]})}):null}function JD(){const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState(null);N.useEffect(()=>{l()},[]);const l=async()=>{n(!0);const{data:x}=await xe.from("therapists").select("*").order("name");x&&t(x),n(!1)},u=()=>{o(null),s(!0)},f=x=>{o(x),s(!0)},d=async x=>{try{if(i){const{error:g}=await xe.from("therapists").update(x).eq("id",i.id);if(g)throw g}else{const{error:g}=await xe.from("therapists").insert([x]);if(g)throw g}l(),s(!1)}catch(g){console.error("Error saving therapist:",g),alert("Error al guardar el terapeuta")}},h=async x=>{try{const{error:g}=await xe.from("therapists").delete().eq("id",x);if(g)throw g;l(),s(!1)}catch(g){console.error("Error deleting therapist:",g),alert("Error al eliminar el terapeuta")}};return c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Equipo de Terapeutas"}),c.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-teal-500 text-white px-4 py-2 rounded-lg hover:bg-teal-600 transition-colors shadow-sm",children:[c.jsx(In,{size:20})," Nuevo Terapeuta"]})]}),c.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-200px)] pr-4",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(x=>c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden hover:shadow-md transition-shadow group",children:[c.jsxs("div",{className:"h-24 bg-teal-500 relative",children:[c.jsx("div",{className:"absolute -bottom-10 left-6",children:c.jsx("div",{className:"w-20 h-20 rounded-full bg-white p-1 shadow-md",children:c.jsx("div",{className:"w-full h-full rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:x.photo_url?c.jsx("img",{src:x.photo_url,alt:x.name,className:"w-full h-full object-cover"}):c.jsx(na,{size:32,className:"text-gray-400"})})})}),c.jsx("button",{onClick:()=>f(x),className:"absolute top-4 right-4 bg-white/20 hover:bg-white/30 text-white p-2 rounded-full backdrop-blur-sm transition-colors opacity-0 group-hover:opacity-100",children:c.jsx(jh,{size:16})})]}),c.jsxs("div",{className:"pt-12 px-6 pb-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900",children:x.name}),c.jsx("p",{className:"text-teal-600 text-sm font-medium",children:x.specialty||"Terapeuta"})]}),c.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-100",children:[c.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[c.jsx(Ai,{size:16,className:"text-gray-400"}),x.phone||"Sin telfono"]}),c.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[c.jsx(jl,{size:16,className:"text-gray-400"}),x.email||"Sin email"]})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-2 text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-gray-500 mb-1",children:[c.jsx(On,{size:12})," Horarios"]}),c.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[Object.values(x.schedule||{}).filter(g=>g.active).length," das"]})]}),c.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-2 text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-gray-500 mb-1",children:[c.jsx(Gu,{size:12})," Servicios"]}),c.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[(x.services||[]).length," activos"]})]})]})]})]},x.id))})}),c.jsx(YD,{isOpen:a,onClose:()=>s(!1),therapist:i,onSave:d,onDelete:h})]})}function QD({workshop:e,onClose:t,onSave:r,onDelete:n}){const[a,s]=N.useState({title:"",description:"",date:"",duration_minutes:60,max_attendees:10,price:0,image_url:"",type:"Taller",modality:"Presencial"}),[i,o]=N.useState(!1),[l,u]=N.useState(null);N.useEffect(()=>{e&&s({title:e.title||"",description:e.description||"",date:e.date?new Date(e.date).toISOString().slice(0,16):"",duration_minutes:e.duration_minutes||60,max_attendees:e.max_attendees||10,price:e.price||0,image_url:e.image_url||"",type:e.type||"Taller",modality:e.modality||"Presencial"})},[e]);const f=x=>{const{name:g,value:m}=x.target;s(p=>({...p,[g]:m}))},d=async()=>{if(o(!0),u(null),!a.date){u("Por favor selecciona una fecha y hora."),o(!1);return}try{const x={...a,date:new Date(a.date).toISOString(),price:a.price?parseFloat(a.price):0,duration_minutes:a.duration_minutes?parseInt(a.duration_minutes):60,max_attendees:a.max_attendees?parseInt(a.max_attendees):10};if(e&&e.id){const{error:g}=await xe.from("workshops").update(x).eq("id",e.id);if(g)throw g}else{const{error:g}=await xe.from("workshops").insert(x);if(g)throw g}r(),t()}catch(x){console.error("Error saving workshop:",x),u("Error al guardar el taller: "+x.message)}finally{o(!1)}},h=async()=>{if(!(!e||!e.id)&&window.confirm("Ests seguro de que quieres eliminar este taller?")){o(!0),u(null);try{await xe.from("workshops").delete().eq("id",e.id),n(),t()}catch(x){console.error("Error deleting workshop:",x),u("Error al eliminar el taller. Intntalo de nuevo.")}finally{o(!1)}}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 relative",children:[c.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:24})}),c.jsx("h2",{className:"text-2xl font-bold text-teal-600 mb-6",children:e?"Editar Taller":"Nuevo Taller"}),l&&c.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4 text-sm",children:l}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Ttulo"}),c.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700",children:"Fecha y Hora"}),c.jsx("input",{type:"datetime-local",id:"date",name:"date",value:a.date,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"duration_minutes",className:"block text-sm font-medium text-gray-700",children:"Duracin (minutos)"}),c.jsx("input",{type:"number",id:"duration_minutes",name:"duration_minutes",value:a.duration_minutes,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"max_attendees",className:"block text-sm font-medium text-gray-700",children:"Mx. Asistentes"}),c.jsx("input",{type:"number",id:"max_attendees",name:"max_attendees",value:a.max_attendees,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Precio"}),c.jsx("input",{type:"number",id:"price",name:"price",value:a.price,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"image_url",className:"block text-sm font-medium text-gray-700",children:"URL Imagen"}),c.jsx("input",{type:"text",id:"image_url",name:"image_url",value:a.image_url,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Tipo"}),c.jsxs("select",{id:"type",name:"type",value:a.type,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[c.jsx("option",{value:"Taller",children:"Taller"}),c.jsx("option",{value:"Conferencia",children:"Conferencia"}),c.jsx("option",{value:"Curso",children:"Curso"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"modality",className:"block text-sm font-medium text-gray-700",children:"Modalidad"}),c.jsxs("select",{id:"modality",name:"modality",value:a.modality,onChange:f,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[c.jsx("option",{value:"Presencial",children:"Presencial"}),c.jsx("option",{value:"En lnea",children:"En lnea"})]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Descripcin"}),c.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:f,rows:"3",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[e&&e.id&&c.jsxs("button",{onClick:h,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:[c.jsx($i,{size:20})," Eliminar"]}),c.jsxs("button",{onClick:d,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50 ml-auto",children:[c.jsx(Ui,{size:20})," ",i?"Guardando...":"Guardar"]})]})]})})}function ZD(){const[e,t]=N.useState([]),[r,n]=N.useState([]),[a,s]=N.useState(!0),[i,o]=N.useState(!1),[l,u]=N.useState(null),[f,d]=N.useState(!1),[h,x]=N.useState(null),[g,m]=N.useState({});N.useEffect(()=>{p(),y(),w()},[]);const p=async()=>{try{const{data:b,error:V}=await xe.from("workshops").select("*, therapists(name)").order("date",{ascending:!0});if(V)throw V;b&&t(b)}catch(b){console.error("Error fetching workshops:",b)}finally{s(!1)}},y=async()=>{try{const{data:b,error:V}=await xe.from("leads").select("*").eq("status","paid");if(V)throw V;b&&n(b)}catch(b){console.error("Error fetching paid leads:",b)}},w=async()=>{try{const{data:b,error:V}=await xe.from("workshop_registrations").select("*, leads!inner(id, name, full_name, email, phone)");if(V)throw V;console.log("Registrations data:",b);const J={};b==null||b.forEach(W=>{var ee,G,B,ae;J[W.workshop_id]||(J[W.workshop_id]=[]);const Z=((ee=W.leads)==null?void 0:ee.full_name)||((G=W.leads)==null?void 0:G.name)||"Sin nombre";console.log("Processing registration:",W,"Lead name:",Z),J[W.workshop_id].push({lead_id:W.lead_id,name:Z,full_name:Z,email:(B=W.leads)==null?void 0:B.email,phone:(ae=W.leads)==null?void 0:ae.phone})}),console.log("Organized registrations:",J),m(J)}catch(b){console.error("Error fetching registrations:",b)}},v=b=>{u(b),o(!0)},_=()=>{u(null),o(!0)},k=()=>{o(!1),u(null)},E=()=>{p()},S=()=>{p()},C=(b,V)=>{V.stopPropagation(),x(b),d(!0)},A=()=>{d(!1),x(null)},U=async(b,V)=>{try{const{error:J}=await xe.from("workshop_registrations").insert({workshop_id:b,lead_id:V.id,status:"registered",payment_status:"paid",payment_amount:(h==null?void 0:h.price)||0});if(J)if(J.code==="23505")alert(` ${V.full_name||V.name||"Este lead"} ya est inscrito en este taller`);else throw J;else alert(` ${V.full_name||V.name||"Lead"} inscrito correctamente`),p(),w(),y()}catch(J){console.error("Error registering lead:",J),alert(" Error al inscribir el lead. Por favor intenta de nuevo.")}},H=async(b,V,J)=>{if(confirm(`Deseas eliminar a ${J} de este taller?`))try{const{error:W}=await xe.from("workshop_registrations").delete().eq("workshop_id",b).eq("lead_id",V);if(W)throw W;alert(` ${J} eliminado del taller`),p(),w()}catch(W){console.error("Error unregistering lead:",W),alert(" Error al eliminar el lead. Por favor intenta de nuevo.")}};return c.jsxs("div",{className:"flex h-full",children:[c.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[c.jsx("div",{className:"flex justify-between items-center mb-6",children:c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Talleres y Eventos"})}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a?c.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"Cargando talleres..."}):e.length===0?c.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:["No hay talleres disponibles. ",c.jsx("button",{onClick:_,className:"text-teal-600 hover:underline",children:"Crea uno nuevo"}),"."]}):e.map(b=>{const V=g[b.id]||[];return c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"cursor-pointer",onClick:()=>v(b),children:[c.jsxs("div",{className:"h-32 bg-teal-100 relative",children:[b.image_url?c.jsx("img",{src:b.image_url,alt:b.title,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-teal-300",children:c.jsx(On,{size:48})}),c.jsxs("div",{className:"absolute top-4 right-4 bg-white px-3 py-1 rounded-full text-xs font-bold text-teal-600 shadow-sm",children:["$",b.price]})]}),c.jsxs("div",{className:"p-6",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:b.title}),c.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:b.description}),c.jsxs("div",{className:"space-y-2 mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(On,{size:16,className:"text-teal-500"}),new Date(b.date).toLocaleDateString()]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(tl,{size:16,className:"text-teal-500"}),new Date(b.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," (",b.duration_minutes," min)"]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(ji,{size:16,className:"text-teal-500"}),b.current_attendees||0," / ",b.max_attendees," inscritos"]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[c.jsx("span",{className:"px-3 py-1 bg-teal-100 text-teal-800 text-xs font-medium rounded-full",children:b.type}),c.jsx("span",{className:"px-3 py-1 bg-teal-100 text-teal-800 text-xs font-medium rounded-full",children:b.modality})]})]})]}),V.length>0&&c.jsxs("div",{className:"px-6 pb-4 border-t pt-4",children:[c.jsxs("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-2",children:["Inscritos (",V.length,")"]}),c.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:V.map(J=>c.jsxs("div",{className:"flex items-center justify-between bg-green-50 px-3 py-2 rounded text-xs",children:[c.jsx("span",{className:"font-medium text-green-900",children:J.name||J.full_name||"Sin nombre"}),c.jsx("button",{onClick:W=>{W.stopPropagation(),H(b.id,J.lead_id,J.name||J.full_name||"Sin nombre")},className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar inscripcin",children:c.jsx(Ut,{size:14})})]},J.lead_id))})]}),c.jsx("div",{className:"px-6 pb-6",children:c.jsxs("button",{onClick:J=>C(b,J),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[c.jsx(z4,{size:18}),"Inscribir Lead Pagado"]})})]},b.id)})}),c.jsx("div",{className:"mt-8 text-center",children:c.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 mx-auto",children:[c.jsx(In,{size:20})," Nuevo Taller"]})}),i&&c.jsx(QD,{workshop:l,onClose:k,onSave:E,onDelete:S}),f&&h&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[c.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Inscribir Lead Pagado"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.title})]}),c.jsx("button",{onClick:A,className:"text-gray-400 hover:text-gray-600",children:c.jsx(Ut,{size:24})})]}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-140px)]",children:r.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(lu,{size:48,className:"mx-auto text-gray-300 mb-4"}),c.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No hay leads pagados disponibles"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:'Los leads deben tener el estado "Pagado" para poder inscribirse en talleres.'})]}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(b=>{var J;const V=(J=g[h.id])==null?void 0:J.some(W=>W.lead_id===b.id);return c.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${V?"border-gray-200 bg-gray-50 opacity-60":"border-green-200 bg-green-50 hover:border-green-400 hover:shadow-md cursor-pointer"}`,onClick:()=>!V&&U(h.id,b),children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-bold text-gray-900",children:b.full_name||b.name||"Sin nombre"}),b.email&&c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:b.email}),b.phone&&c.jsx("p",{className:"text-xs text-gray-600",children:b.phone})]}),V&&c.jsx("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded-full",children:"Ya inscrito"})]}),!V&&c.jsxs("button",{onClick:W=>{W.stopPropagation(),U(h.id,b)},className:"w-full mt-3 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[c.jsx(In,{size:16}),"Inscribir"]})]},b.id)})})}),c.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:c.jsx("button",{onClick:A,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cerrar"})})]})})]}),c.jsxs("div",{className:"w-80 bg-gray-50 border-l p-6 overflow-y-auto hidden xl:block",children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[c.jsx(lu,{size:20,className:"text-green-600"}),"Leads Pagados"]}),c.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Estos prospectos ya han pagado y estn listos para ser asignados a un taller."}),c.jsxs("div",{className:"space-y-3",children:[r.map(b=>c.jsxs("div",{className:"bg-white p-3 rounded border shadow-sm",children:[c.jsx("div",{className:"font-medium text-gray-900",children:b.name||b.full_name}),b.email&&c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:b.email}),b.phone&&c.jsx("div",{className:"text-xs text-gray-500",children:b.phone}),c.jsx("div",{className:"mt-2 flex justify-end",children:c.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded-full",children:"Listo para asignar"})})]},b.id)),r.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No hay leads pendientes"})]})]})]})}function eL({onPaymentChanged:e}){const[t,r]=N.useState([]),[n,a]=N.useState(!0),[s,i]=N.useState(""),[o,l]=N.useState(null),[u,f]=N.useState("all"),[d,h]=N.useState(null);N.useEffect(()=>{x()},[]);const x=async()=>{a(!0);try{const{data:p,error:y}=await xe.from("appointments").select("*, therapists(name)").order("date",{ascending:!1}).limit(200);if(y)throw y;r(p||[])}catch(p){console.error("Error fetching appointments:",p)}finally{a(!1)}},g=async(p,y)=>{const w=p.target.files[0];if(w){if(!w.type.startsWith("image/")){alert("Por favor sube un archivo de imagen (JPG, PNG).");return}l(y);try{const v=w.name.split(".").pop(),k=`${`${y}_${Math.random().toString(36).substr(2,9)}.${v}`}`,{error:E}=await xe.storage.from("payment-proofs").upload(k,w);if(E)throw E;const{data:{publicUrl:S}}=xe.storage.from("payment-proofs").getPublicUrl(k),{error:C}=await xe.from("appointments").update({payment_proof_url:S,payment_status:"paid",payment_date:new Date().toISOString()}).eq("id",y);if(C)throw C;r(A=>A.map(U=>U.id===y?{...U,payment_proof_url:S,payment_status:"paid",payment_date:new Date().toISOString()}:U)),e&&e()}catch(v){console.error("Error uploading proof:",v),alert("Error al subir el comprobante.")}finally{l(null)}}},m=t.filter(p=>{var v;const y=(v=p.patient_name)==null?void 0:v.toLowerCase().includes(s.toLowerCase()),w=u==="all"?!0:u==="pending"?p.payment_status!=="paid"&&p.payment_status!=="pagado":p.payment_status==="paid"||p.payment_status==="pagado";return y&&w});return c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[c.jsxs("div",{className:"p-6 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[c.jsx(Al,{className:"text-teal-600"}),"Control de Comprobantes de Pago"]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Sube y verifica los comprobantes de pago de las sesiones."})]}),c.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex flex-col sm:flex-row gap-4 justify-between items-center",children:[c.jsxs("div",{className:"relative w-full sm:w-96",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Vu,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"text",placeholder:"Buscar por nombre del paciente...",value:s,onChange:p=>i(p.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>f("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${u==="all"?"bg-gray-800 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Todos"}),c.jsx("button",{onClick:()=>f("pending"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${u==="pending"?"bg-red-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Pendientes"}),c.jsx("button",{onClick:()=>f("paid"),className:`px-3 py-1.5 text-sm font-medium rounded-md ${u==="paid"?"bg-teal-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Pagados"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paciente"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Servicio / Terapeuta"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprobante"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n?c.jsx("tr",{children:c.jsxs("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:[c.jsx(Pn,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Cargando citas..."]})}):m.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:"No se encontraron citas con los filtros actuales."})}):m.map(p=>{var y;return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[new Date(p.date).toLocaleDateString(),c.jsx("div",{className:"text-xs text-gray-400",children:p.time})]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.patient_name}),c.jsx("div",{className:"text-xs text-gray-500",children:p.patient_phone})]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"text-sm text-gray-900",children:p.service}),c.jsx("div",{className:"text-xs text-gray-500",children:(y=p.therapists)==null?void 0:y.name})]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",p.price||0]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.payment_status==="paid"||p.payment_status==="pagado"?c.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-teal-100 text-teal-800",children:"Pagado"}):c.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"Pendiente"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.jsxs("div",{className:"flex items-center gap-2",children:[p.payment_proof_url?c.jsxs("button",{onClick:()=>h(p.payment_proof_url),className:"text-teal-600 hover:text-teal-900 flex items-center gap-1",children:[c.jsx(Ch,{size:16}),"Ver"]}):c.jsx("span",{className:"text-gray-400 text-xs italic",children:"Sin archivo"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"file",id:`file-${p.id}`,className:"hidden",accept:"image/*",onChange:w=>g(w,p.id),disabled:o===p.id}),c.jsxs("label",{htmlFor:`file-${p.id}`,className:`cursor-pointer inline-flex items-center px-2 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none ${o===p.id?"opacity-50 cursor-not-allowed":""}`,children:[o===p.id?c.jsx(Pn,{size:14,className:"animate-spin mr-1"}):c.jsx(As,{size:14,className:"mr-1"}),p.payment_proof_url?"Cambiar":"Subir"]})]})]})})]},p.id)})})]})}),d&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>h(null),children:c.jsxs("div",{className:"relative max-w-3xl max-h-full bg-white rounded-lg overflow-hidden",children:[c.jsx("button",{onClick:()=>h(null),className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white rounded-full p-1 hover:bg-opacity-70",children:c.jsx(Ut,{size:24})}),c.jsx("img",{src:d,alt:"Comprobante de pago",className:"max-w-full max-h-[80vh] object-contain"})]})})]})}function tL({reportsRefreshKey:e}){const[t,r]=N.useState("financial"),[n,a]=N.useState({income:0,expenses:0,profit:0,sessions:0,pendingPayment:0}),[s,i]=N.useState([]),[o,l]=N.useState([]),[u,f]=N.useState([]),[d,h]=N.useState(!0),[x,g]=N.useState("month");N.useEffect(()=>{m()},[x,e,t]);const m=async()=>{h(!0);try{const w=new Date;let v=new Date,_=new Date;x==="month"?(v=new Date(w.getFullYear(),w.getMonth(),1),_=new Date(w.getFullYear(),w.getMonth()+1,0)):w.getDate()<=15?(v=new Date(w.getFullYear(),w.getMonth(),1),_=new Date(w.getFullYear(),w.getMonth(),15)):(v=new Date(w.getFullYear(),w.getMonth(),16),_=new Date(w.getFullYear(),w.getMonth()+1,0));const k=v.toISOString().split("T")[0],E=_.toISOString().split("T")[0],{data:S}=await xe.from("appointments").select("*, therapists(name, commission_percentage, commissions)").gte("date",k).lte("date",E),{data:C}=await xe.from("workshops").select("*").gte("date",k).lte("date",E);let A=0,U=0,H=0;const b={},V={},J=[];(S||[]).forEach(G=>{var O,P,K,re,oe;const B=parseFloat(G.price||0),ae=["completed","confirmed","asiste","confirmada"].includes(G.status);ae&&(U++,["pagado","paid"].includes(G.payment_status)?(A+=B,G.payment_proof_url||J.push({type:"Falta Comprobante",description:`${G.service} - ${G.patient_name}`,amount:B,date:G.date,responsible:((O=G.therapists)==null?void 0:O.name)||"Sin asignar"})):(H+=B,J.push({type:"Pendiente Pago",description:`${G.service} - ${G.patient_name}`,amount:B,date:G.date,responsible:((P=G.therapists)==null?void 0:P.name)||"Sin asignar"})));const de=((K=G.therapists)==null?void 0:K.name)||"Sin Asignar",R=((re=G.therapists)==null?void 0:re.commissions)||{};if(b[de]||(b[de]={name:de,sessions:0,income:0,commissionToPay:0}),ae&&(b[de].sessions++,["pagado","paid"].includes(G.payment_status))){b[de].income+=B;let ie=0;R[G.service]?ie=parseFloat(R[G.service]):(oe=G.therapists)!=null&&oe.commission_percentage&&(ie=B*(G.therapists.commission_percentage/100)),b[de].commissionToPay+=ie}const z=G.service||"Otro";if(V[z]||(V[z]={name:z,count:0,income:0}),ae){V[z].count++;const le=["pagado","paid"].includes(G.payment_status);V[z].income+=le?B:0}}),(C||[]).forEach(G=>{const B=(parseFloat(G.price)||0)*(parseInt(G.attendees)||0);A+=B;const ae=`Taller: ${G.title}`;V[ae]||(V[ae]={name:ae,count:1,income:0}),V[ae].income+=B});const W=A,Z=Object.values(b).map(G=>({...G,percentage:W>0?(G.income/W*100).toFixed(1):0})),ee=Object.values(V).map(G=>({...G,percentage:W>0?(G.income/W*100).toFixed(1):0}));a({income:A,expenses:A*.3,profit:A*.7,sessions:U,pendingPayment:H}),i(Z),l(ee),f(J)}catch(w){console.error("Error fetching reports:",w)}finally{h(!1)}},p=()=>{window.print()},y=({title:w,value:v,icon:_,color:k="teal"})=>c.jsxs("div",{className:`bg-white p-6 rounded-lg shadow-sm border border-${k}-100 relative group hover:shadow-md transition-shadow`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:`p-3 rounded-full bg-${k}-50 text-${k}-600`,children:c.jsx(_,{className:"w-6 h-6"})}),c.jsx("button",{onClick:p,className:`p-2 text-gray-400 hover:text-${k}-600 hover:bg-${k}-50 rounded-full transition-colors`,title:"Descargar PDF",children:c.jsx(ts,{size:18})})]}),c.jsx("h3",{className:"text-gray-500 text-sm font-medium uppercase tracking-wider",children:w}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:v})]});return c.jsxs("div",{className:"p-6 space-y-8 print:p-0",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 print:hidden",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Reportes y Pagos"}),c.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[c.jsx("button",{onClick:()=>r("financial"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${t==="financial"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Reportes Financieros"}),c.jsx("button",{onClick:()=>r("payments"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${t==="payments"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Control de Pagos"})]})]}),t==="payments"?c.jsx(eL,{onPaymentChanged:m},e):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-end gap-3 print:hidden",children:[c.jsx("span",{className:"text-sm text-gray-600 flex items-center",children:"Periodo:"}),c.jsxs("select",{value:x,onChange:w=>g(w.target.value),className:"border-gray-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm p-2 border outline-none",children:[c.jsx("option",{value:"month",children:"Mensual"}),c.jsx("option",{value:"fortnight",children:"Quincenal"})]}),c.jsxs("button",{onClick:p,className:"flex items-center gap-2 bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 transition-colors text-sm",children:[c.jsx(ts,{size:16}),"Descargar Todo"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[c.jsx(y,{title:"Ingresos Totales",value:`${n.income.toLocaleString()}`,icon:Ha}),c.jsx(y,{title:"Sesiones",value:n.sessions,icon:On}),c.jsx(y,{title:"Utilidad Estimada",value:`${n.profit.toLocaleString()}`,icon:cu}),c.jsx(y,{title:"Por Cobrar",value:`${n.pendingPayment.toLocaleString()}`,icon:Da,color:"red"})]}),u.length>0&&c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-red-100 overflow-hidden",children:[c.jsxs("div",{className:"p-4 bg-red-50 border-b border-red-100 flex justify-between items-center",children:[c.jsxs("h3",{className:"font-bold text-red-800 flex items-center gap-2",children:[c.jsx(Da,{size:20}),"Reporte de Nmeros Rojos (Pendientes de Pago)"]}),c.jsx("button",{onClick:p,className:"text-red-600 hover:text-red-800",children:c.jsx(ts,{size:18})})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-red-50 text-red-900 font-medium",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3",children:"Fecha"}),c.jsx("th",{className:"p-3",children:"Tipo"}),c.jsx("th",{className:"p-3",children:"Descripcin"}),c.jsx("th",{className:"p-3",children:"Responsable"}),c.jsx("th",{className:"p-3 text-right",children:"Monto"})]})}),c.jsx("tbody",{className:"divide-y divide-red-100",children:u.map((w,v)=>c.jsxs("tr",{className:"hover:bg-red-50/50",children:[c.jsx("td",{className:"p-3",children:w.date}),c.jsx("td",{className:"p-3",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${w.type==="Falta Comprobante"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:w.type})}),c.jsx("td",{className:"p-3",children:w.description}),c.jsx("td",{className:"p-3",children:w.responsible}),c.jsxs("td",{className:"p-3 text-right font-bold text-red-600",children:["$",w.amount.toLocaleString()]})]},v))})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-teal-100 overflow-hidden",children:[c.jsxs("div",{className:"p-4 bg-teal-50 border-b border-teal-100 flex justify-between items-center",children:[c.jsxs("h3",{className:"font-bold text-teal-800 flex items-center gap-2",children:[c.jsx(ji,{size:20}),"Rendimiento y Comisiones"]}),c.jsx("button",{onClick:p,className:"text-teal-600 hover:text-teal-800",children:c.jsx(ts,{size:18})})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-teal-50 text-teal-900 font-medium",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3",children:"Terapeuta"}),c.jsx("th",{className:"p-3 text-center",children:"Sesiones"}),c.jsx("th",{className:"p-3 text-right",children:"Ingresos"}),c.jsx("th",{className:"p-3 text-right",children:"A Pagar"})]})}),c.jsxs("tbody",{className:"divide-y divide-teal-100",children:[s.map((w,v)=>c.jsxs("tr",{className:"hover:bg-teal-50/50",children:[c.jsx("td",{className:"p-3 font-medium text-gray-900",children:w.name}),c.jsx("td",{className:"p-3 text-center",children:w.sessions}),c.jsxs("td",{className:"p-3 text-right",children:["$",w.income.toLocaleString()]}),c.jsxs("td",{className:"p-3 text-right font-bold text-teal-600",children:["$",w.commissionToPay.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},v)),s.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:"4",className:"p-4 text-center text-gray-500",children:"No hay datos en este periodo"})})]})]})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-teal-100 overflow-hidden",children:[c.jsxs("div",{className:"p-4 bg-teal-50 border-b border-teal-100 flex justify-between items-center",children:[c.jsxs("h3",{className:"font-bold text-teal-800 flex items-center gap-2",children:[c.jsx(Sb,{size:20}),"Ingresos por Servicio"]}),c.jsx("button",{onClick:p,className:"text-teal-600 hover:text-teal-800",children:c.jsx(ts,{size:18})})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-teal-50 text-teal-900 font-medium",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3",children:"Servicio"}),c.jsx("th",{className:"p-3 text-center",children:"Cantidad"}),c.jsx("th",{className:"p-3 text-right",children:"Ingresos"}),c.jsx("th",{className:"p-3 text-right",children:"% Total"})]})}),c.jsxs("tbody",{className:"divide-y divide-teal-100",children:[o.map((w,v)=>c.jsxs("tr",{className:"hover:bg-teal-50/50",children:[c.jsx("td",{className:"p-3 font-medium text-gray-900",children:w.name}),c.jsx("td",{className:"p-3 text-center",children:w.count}),c.jsxs("td",{className:"p-3 text-right",children:["$",w.income.toLocaleString()]}),c.jsx("td",{className:"p-3 text-right",children:c.jsxs("span",{className:"inline-block px-2 py-1 rounded-full bg-teal-100 text-teal-800 text-xs font-bold",children:[w.percentage,"%"]})})]},v)),o.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:"4",className:"p-4 text-center text-gray-500",children:"No hay datos en este periodo"})})]})]})})]})]})]})]})}function rL({isOpen:e,onClose:t,onSave:r,expense:n=null}){const[a,s]=N.useState(!1),[i,o]=N.useState({description:"",amount:"",type:"fixed",category:"",due_date:new Date().toISOString().split("T")[0],status:"paid"});if(N.useEffect(()=>{o(n?{description:n.description,amount:n.amount,type:n.type,category:n.category||"",due_date:n.due_date||new Date().toISOString().split("T")[0],status:n.status||"paid"}:{description:"",amount:"",type:"fixed",category:"",due_date:new Date().toISOString().split("T")[0],status:"paid"})},[n,e]),!e)return null;const l=async u=>{u.preventDefault(),s(!0);try{const f={description:i.description,amount:parseFloat(i.amount),type:i.type,category:i.category,due_date:i.due_date,status:i.status};let d;if(n!=null&&n.id){const{error:h}=await xe.from("expenses").update(f).eq("id",n.id);d=h}else{const{error:h}=await xe.from("expenses").insert([f]);d=h}if(d)throw d;r(),t()}catch(f){console.error("Error saving expense:",f),alert("Error al guardar el gasto")}finally{s(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[c.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center bg-gray-50",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n?"Editar Gasto":"Nuevo Gasto"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Ut,{size:20})})]}),c.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),c.jsxs("div",{className:"relative",children:[c.jsx(Al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{type:"text",required:!0,value:i.description,onChange:u=>o({...i,description:u.target.value}),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:"Ej: Renta, Luz, Papelera..."})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{type:"number",step:"0.01",required:!0,value:i.amount,onChange:u=>o({...i,amount:u.target.value}),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:"0.00"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha"}),c.jsxs("div",{className:"relative",children:[c.jsx(On,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{type:"date",required:!0,value:i.due_date,onChange:u=>o({...i,due_date:u.target.value}),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Gasto"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx("button",{type:"button",onClick:()=>o({...i,type:"fixed"}),className:`py-2 px-4 rounded-lg border text-sm font-medium transition-colors ${i.type==="fixed"?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"Gasto Fijo"}),c.jsx("button",{type:"button",onClick:()=>o({...i,type:"variable"}),className:`py-2 px-4 rounded-lg border text-sm font-medium transition-colors ${i.type==="variable"?"bg-purple-50 border-purple-200 text-purple-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"Gasto Variable"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categora (Opcional)"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ku,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{type:"text",value:i.category,onChange:u=>o({...i,category:u.target.value}),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:"Ej: Servicios, Marketing, Nmina..."})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium",children:"Cancelar"}),c.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-medium flex items-center gap-2",children:a?"Guardando...":c.jsxs(c.Fragment,{children:[c.jsx(Ui,{size:18}),"Guardar Gasto"]})})]})]})]})})}function nL(){const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,s]=N.useState(""),[i,o]=N.useState("all"),[l,u]=N.useState(!1),[f,d]=N.useState(null),[h,x]=N.useState({total:0,fixed:0,variable:0});N.useEffect(()=>{g()},[]),N.useEffect(()=>{m()},[e]);async function g(){try{n(!0);const{data:k,error:E}=await xe.from("expenses").select("*").order("due_date",{ascending:!1});if(E)throw E;t(k||[])}catch(k){console.error("Error fetching expenses:",k)}finally{n(!1)}}function m(){const k=e.reduce((C,A)=>C+Number(A.amount),0),E=e.filter(C=>C.type==="fixed").reduce((C,A)=>C+Number(A.amount),0),S=e.filter(C=>C.type==="variable").reduce((C,A)=>C+Number(A.amount),0);x({total:k,fixed:E,variable:S})}const p=async k=>{if(window.confirm("Ests seguro de eliminar este gasto?"))try{const{error:E}=await xe.from("expenses").delete().eq("id",k);if(E)throw E;g()}catch(E){console.error("Error deleting expense:",E)}},y=k=>{d(k),u(!0)},w=()=>{d(null),u(!0)},v=e.filter(k=>{const E=k.description.toLowerCase().includes(a.toLowerCase())||k.category&&k.category.toLowerCase().includes(a.toLowerCase()),S=i==="all"||k.type===i;return E&&S}),_=k=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(k);return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b px-8 py-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Control de Gastos"}),c.jsx("p",{className:"text-gray-500",children:"Gestiona tus gastos fijos y variables"})]}),c.jsxs("button",{onClick:w,className:"bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 flex items-center gap-2 font-medium transition-colors",children:[c.jsx(In,{size:20}),"Nuevo Gasto"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-gray-500 text-sm font-medium",children:"Total Gastos"}),c.jsx("div",{className:"p-2 bg-gray-100 rounded-lg text-gray-600",children:c.jsx(Ha,{size:20})})]}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_(h.total)})]}),c.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm border-l-4 border-l-blue-500",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-blue-600 text-sm font-medium",children:"Gastos Fijos"}),c.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600",children:c.jsx(cu,{size:20})})]}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_(h.fixed)}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[h.total>0?Math.round(h.fixed/h.total*100):0,"% del total"]})]}),c.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm border-l-4 border-l-purple-500",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-purple-600 text-sm font-medium",children:"Gastos Variables"}),c.jsx("div",{className:"p-2 bg-purple-50 rounded-lg text-purple-600",children:c.jsx(P4,{size:20})})]}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_(h.variable)}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[h.total>0?Math.round(h.variable/h.total*100):0,"% del total"]})]})]})]}),c.jsxs("div",{className:"flex-1 p-8 overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(Vu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",placeholder:"Buscar gastos...",value:a,onChange:k=>s(k.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]}),c.jsxs("div",{className:"flex bg-white rounded-lg border p-1",children:[c.jsx("button",{onClick:()=>o("all"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${i==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:text-gray-900"}`,children:"Todos"}),c.jsx("button",{onClick:()=>o("fixed"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${i==="fixed"?"bg-blue-50 text-blue-700":"text-gray-500 hover:text-gray-900"}`,children:"Fijos"}),c.jsx("button",{onClick:()=>o("variable"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${i==="variable"?"bg-purple-50 text-purple-700":"text-gray-500 hover:text-gray-900"}`,children:"Variables"})]})]}),c.jsx("div",{className:"bg-white rounded-xl border shadow-sm flex-1 overflow-hidden flex flex-col",children:c.jsx("div",{className:"overflow-y-auto flex-1",children:c.jsxs("table",{className:"w-full text-left",children:[c.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descripcin"}),c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categora"}),c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Monto"}),c.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Acciones"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:r?c.jsx("tr",{children:c.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"Cargando gastos..."})}):v.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"No se encontraron gastos"})}):v.map(k=>c.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"font-medium text-gray-900",children:k.description})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k.category?c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:k.category}):c.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${k.type==="fixed"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:k.type==="fixed"?"Fijo":"Variable"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{size:14}),new Date(k.due_date).toLocaleDateString("es-MX")]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right font-medium text-gray-900",children:_(k.amount)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>y(k),className:"text-teal-600 hover:text-teal-900 p-1 hover:bg-teal-50 rounded",children:c.jsx(jh,{size:16})}),c.jsx("button",{onClick:()=>p(k.id),className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",children:c.jsx($i,{size:16})})]})})]},k.id))})]})})})]}),c.jsx(rL,{isOpen:l,onClose:()=>u(!1),onSave:g,expense:f})]})}function aL(){const[e,t]=N.useState(!1),[r,n]=N.useState(""),[a,s]=N.useState(""),[i,o]=N.useState(!1),[l,u]=N.useState(!1),[f,d]=N.useState(null),[h,x]=N.useState(null),g=async m=>{m.preventDefault(),t(!0),d(null),x(null);try{if(i)x("Contacta al administrador para restablecer tu contrasea.");else{const{data:p,error:y}=await xe.from("users").select("*").eq("email",r).eq("password",a).eq("active",!0).single();if(y||!p)throw new Error("Email o contrasea incorrectos");localStorage.setItem("user_session",JSON.stringify({id:p.id,email:p.email,full_name:p.full_name,role:p.role,therapist_id:p.therapist_id,timestamp:Date.now()})),window.location.href="/"}}catch(p){d(p.message||"Error al iniciar sesin")}finally{t(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:i?"Recuperar contrasea":"Iniciar sesin"}),c.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:i?"Ingresa tu correo para recibir un enlace de recuperacin":"Ingresa tus credenciales para acceder al sistema"})]}),c.jsxs("form",{className:"mt-8 space-y-6",onSubmit:g,children:[c.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(jl,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"email",required:!0,className:"appearance-none rounded-lg relative block w-full pl-10 px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Correo electrnico",value:r,onChange:m=>n(m.target.value)})]}),!i&&c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Ah,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:l?"text":"password",required:!0,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Contrasea",value:a,onChange:m=>s(m.target.value)}),c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!l),children:l?c.jsx(oy,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):c.jsx(Ch,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),f&&c.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:[c.jsx(Da,{className:"h-5 w-5"}),c.jsx("span",{children:f})]}),h&&c.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm bg-green-50 p-3 rounded-lg",children:[c.jsx(Da,{className:"h-5 w-5"}),c.jsx("span",{children:h})]}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:e,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:e?c.jsx(Pn,{className:"h-5 w-5 animate-spin"}):i?"Enviar enlace de recuperacin":"Entrar"})}),c.jsxs("div",{className:"flex flex-col gap-2 text-center",children:[i?c.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900",onClick:()=>{o(!1),x(null),d(null)},children:[c.jsx(fb,{className:"h-4 w-4"}),"Volver al inicio de sesin"]}):c.jsx("button",{type:"button",className:"text-sm text-indigo-600 hover:text-indigo-500",onClick:()=>{o(!0),x(null),d(null)},children:"Olvidaste tu contrasea?"}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Los usuarios son creados por el administrador"})]})]})]})})}function sL(){const e=Wu();return N.useEffect(()=>{(async()=>{const{data:r,error:n}=await xe.auth.getSession();n?(console.error("Error during auth callback:",n),e("/login",{state:{error:"No se pudo iniciar sesin. Por favor, intntalo de nuevo."}})):r!=null&&r.session?e("/"):e("/login",{state:{error:"No se pudo completar la autenticacin. Por favor, inicia sesin."}})})()},[e]),c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})}function iL(){const[e,t]=N.useState(null),[r,n]=N.useState(null),[a,s]=N.useState(null),[i,o]=N.useState(null),[l,u]=N.useState(!0),[f,d]=N.useState(0);N.useEffect(()=>{h()},[]);function h(){try{const m=localStorage.getItem("user_session");if(m){const p=JSON.parse(m),y=Date.now()-p.timestamp,w=24*60*60*1e3;y>w?(localStorage.removeItem("user_session"),t(null),n(null),s(null)):(t(p),n(p.role),s(p.email),o(p.therapist_id||null))}}catch(m){console.error("Error checking session:",m),localStorage.removeItem("user_session")}finally{u(!1)}}const x=()=>{d(m=>m+1)},g=({children:m,allowedRoles:p=[]})=>l?c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):e?p.length>0&&!p.includes(r)?c.jsx(ao,{to:"/agenda",replace:!0}):m:c.jsx(ao,{to:"/login",replace:!0});return l?c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):c.jsx(KE,{children:c.jsxs($m,{children:[c.jsx(Tr,{path:"/login",element:e?c.jsx(ao,{to:"/",replace:!0}):c.jsx(aL,{})}),c.jsx(Tr,{path:"/auth/supabase-auth-callback",element:c.jsx(sL,{})}),c.jsx(Tr,{path:"/*",element:c.jsx(g,{children:c.jsx(F3,{userRole:r,userEmail:a,children:c.jsxs($m,{children:[c.jsx(Tr,{path:"/",element:r==="admin"?c.jsx(O3,{reportsRefreshKey:f}):c.jsx(ao,{to:"/agenda",replace:!0})}),c.jsx(Tr,{path:"/agenda",element:c.jsx(U3,{onReportsRefresh:x,userRole:r,userEmail:a,therapistId:i})}),c.jsx(Tr,{path:"/leads",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(G3,{})})}),c.jsx(Tr,{path:"/database",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(XD,{})})}),c.jsx(Tr,{path:"/expenses",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(nL,{})})}),c.jsx(Tr,{path:"/therapists",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(JD,{})})}),c.jsx(Tr,{path:"/workshops",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(ZD,{})})}),c.jsx(Tr,{path:"/reports",element:c.jsx(g,{allowedRoles:["admin"],children:c.jsx(tL,{reportsRefreshKey:f})})}),c.jsx(Tr,{path:"*",element:c.jsx(ao,{to:"/",replace:!0})})]})})})})]})})}sf.createRoot(document.getElementById("root")).render(c.jsx(x_.StrictMode,{children:c.jsx(iL,{})}));
